


<!DOCTYPE html>

<html lang="es">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>9.1.3.7. Cadenas de bloques &#8212; documentación de Linuxnomicón - rolling</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/classic.css" />
    <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
    
    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/translations.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    
    <link rel="index" title="Índice" href="../../../genindex.html" />
    <link rel="search" title="Búsqueda" href="../../../search.html" />
    <link rel="next" title="9.2. Virtualización" href="../../05.virtual/index.html" />
    <link rel="prev" title="9.1.3.6. Cifrado de discos" href="06.discos.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navegación</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="Índice General"
             accesskey="I">índice</a></li>
        <li class="right" >
          <a href="../../05.virtual/index.html" title="9.2. Virtualización"
             accesskey="N">siguiente</a> |</li>
        <li class="right" >
          <a href="06.discos.html" title="9.1.3.6. Cifrado de discos"
             accesskey="P">anterior</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">documentación de Linuxnomicón - rolling</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" ><span class="section-number">9. </span>Apéndices</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../index.html" ><span class="section-number">9.1. </span>Criptografía</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../03.aplicaciones.html" accesskey="U"><span class="section-number">9.1.3. </span>Aplicaciones de la criptografía</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><span class="section-number">9.1.3.7. </span>Cadenas de bloques</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="cadenas-de-bloques">
<span id="blockchain"></span><h1><span class="section-number">9.1.3.7. </span>Cadenas de bloques<a class="headerlink" href="#cadenas-de-bloques" title="Enlazar permanentemente con este título">¶</a></h1>
<p>Una de las aplicaciones de la criptografía que más impulso ha tomado en los
últimos años es la tecnología de <strong>blockchain</strong> (o de <em>cadena de bloques</em>, si
usamos su traducción literal). Conceptualmente fue desarrollada en los años 80
y 90, pero su florecimiento definitivo se produjo a partir de 2009 a raíz de la
creación del <a class="reference external" href="https://es.wikipedia.org/wiki/Bitcoin">Bitcoin</a>. El 1 de noviembre de 2008, una persona (o un grupo de
personas), bajo el seudónimo de <a class="reference external" href="https://es.wikipedia.org/wiki/Satoshi_Nakamoto">Natoshi Nakamoto</a>, anunció en un grupo de
noticias sobre cifrado (<em>gmane.comp.encryption.general</em>) la redacción de <a class="reference external" href="https://bitcoin.org/bitcoin.pdf">un
artículo</a> en que propugnaba la creación
de una divisa de dinero electrónico: el <em>Bitcoin</em>. Para ello había registrado
previamente el dominio <a class="reference external" href="https://bitcoin.org">bitcoin.org</a>, creó el <em>software</em> para implementarlo y
el 3 de enero de 2009 lanzó la red basada en el protocolo propuesto. Desde
entonces, <em>Bitcoin</em> y muchas otras criptomonedas nacidas después han
experimentado un desarrollo espectacular, y ya han excedido el ámbito puramente
informático. Aunque su efecto económico (y especulativo) es enormemente
interesante, el epígrafe se centra en los aspectos técnicos de la tecnología.</p>
<section id="proposito">
<span id="blockchain-propo"></span><h2><span class="section-number">9.1.3.7.1. </span>Propósito<a class="headerlink" href="#proposito" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Cuando dos o más personas formalizan un acuerdo, requieren de la existencia de
un tercero intermediario que lo avale. Por ejemplo:</p>
<ul class="simple">
<li><p>En una compra con tarjeta, hay un empresa (<em>Visa</em>, <em>Mastercard</em>) que avala
ante el vendedor ese medio de pago.</p></li>
<li><p>En una compraventa de vivienda un notario avala la firma del contrato de
compraventa.</p></li>
<li><p>etc.</p></li>
</ul>
<p>La <em class="dfn">blockchain</em> es una tecnología que permite la realización de
transacciones (acuerdos) entre particulares, <strong>evitando</strong> la necesidad de un
<strong>intermediario</strong> confiable que tutele dichos acuerdos. Lo que se pretende con
una <em>blockchain</em>, por tanto, es evitar que exista una autoridad central capaz de
decidir qué es válido y qué no. Como no se quiere depender de ninguna figura
central, la tecnología requiere una red descentralizada y, por tanto, es una
tecnología <abbr title="Peer-to-Peer">P2P</abbr>. Los acuerdos no tienen por qué limitarse a transacciones
monetarias (trataremos más adelante el concepto de <a class="reference internal" href="#smart-contract"><span class="std std-ref">contrato inteligente</span></a>).</p>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>Téngase presente, la descentralización es consustancial a la
<em>blockchain</em>, porque es la razón de su existencia. La tecnología se idea para
lograrla y cualquier <em>blockchain</em> que no la asegure, es una tecnología
fallida, puesto que existen otras tecnologías directamente centralizadas
muchísimo más eficientes.</p>
</div>
<p>El párrafo que acabamos de redactar, más que una definición, es la declaración
de su finalidad; y exige el registro de todas esas transacciones:</p>
<img alt="../../../_images/red-desc.png" src="../../../_images/red-desc.png" />
<p>El esquema nos ayudará a entender el funcionamiento:</p>
<ul>
<li><p>Por un lado, hay una serie de <strong>clientes</strong> o usuarios interesados en realizar
transacciones entre ellos de manera segura y confiable: son el señor <strong>A</strong>, el
señor <strong>B</strong> y el señor <strong>C</strong>.</p></li>
<li><p>Por otro, se encuentran aquellos nodos que gestionan el libro de contabilidad
distribuido en el que se registran las transacciones. Téngase presente que,
como se quiere evitar la dependencia de cualquier agente particular, entonces
la base de datos debe ser distribuida y el acceso a formar parte de ella,
libre. Los nodos que gestionan la red distribuida se denominan
<strong>mineros</strong>, ya veremos por qué razón y contienen una copia completa de todas
las transacciones.</p></li>
<li><p>Por último, existe otro agente: el <strong>código</strong> que implementa el protocolo y que
define las reglas de intercambio, por lo cual, en un esquema tradicional
cumpliría la función del <em>regulador</em>. Como el código es escrito por los
<strong>desarrolladores</strong> puede parecer que la red funciona a su capricho, pero no
es tal: los desarrollos suelen ser de <a class="reference internal" href="../../../guias/01.som/01.si/02.software.html#free-software"><span class="std std-ref">software libre</span></a> y
que sus cambios realmente se implemeten depende de que los adopten los
mineros. En consecuencia, el que las reglas cambien acaba siendo una decisión
consensuada.</p>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>Si ante un cambio no existe un consenso absoluto, entonces se
produce lo que se llama un <em class="dfn">hard fork</em> y una parte de la red de
mineros implementará un protocolo y, otra parte, el otro. Para las
implicaciones de esto, échele un vistazo al <a class="reference external" href="https://www.youtube.com/channel/UC_TmOIPWu-hCVuE2fA3M8Tg">vídeo sobre hard fork de
Crypto Español</a>. Conviene
antes, no obstante, leer <a class="reference internal" href="#blockchain-desc"><span class="std std-ref">el siguiente epígrafe</span></a>
donde se expone formalmente lo que es una <em>cadena de bloques</em>.</p>
</div>
</li>
</ul>
<p>Por tanto, se siguen las reglas definidas en el <em>software</em> de gestión y los
interesados en hacer transacciones acceden a la red de mineros pare que estas se
registren. Los mineros, por su parte, se comunican entre sí para que sea posible
por parte de todos conocer todas las transacciones producidas. Este, pues, es el
esquema de funcionamiento, pero hacer que esta idea general funcione, no es en
absoluto trivial. Aún debe exponerse cómo lograr que este sistema:</p>
<ol class="loweralpha simple" id="blockchain-prob">
<li><p>Distinga cada cliente de los restantes.</p></li>
<li><p>Dado que en un libro de contabilidad los registros tiene un orden secuencial,
consiga secuencialidad.</p></li>
<li><p>Evite la manipulación interesada de transacción (inserción de trasacciones
fraudulentas, rectificación de transacciones, etc.)</p></li>
<li><p>Evite registros simultáneos que provoquen inconsistencia, o sea, colisiones.
Por ejemplo, imaginemos que, teniendo el señor <strong>A</strong> 5₿, uno
de los nodos registra que cede al señor <strong>B</strong> 4₿ y otro nodo
diferente, que aún no está enterado de ello, registra que cede al señor <strong>C</strong>,
3₿.</p></li>
<li><p>Incentive el trabajo de los mineros.</p></li>
</ol>
<p>Todo ello se resuelve mediante la <strong>cadena de bloques</strong>, que es lo que
describiremos a continuación.</p>
</section>
<section id="descripcion">
<span id="blockchain-desc"></span><h2><span class="section-number">9.1.3.7.2. </span>Descripción<a class="headerlink" href="#descripcion" title="Enlazar permanentemente con este título">¶</a></h2>
<div class="admonition seealso">
<p class="admonition-title">Ver también</p>
<p>Es recomendabilísimo el vídeo <a class="reference external" href="https://www.youtube.com/watch?v=hEoYL5j0wYU">Cómo funciona blockchain</a> del canal <a class="reference external" href="https://www.youtube.com/channel/UC_TmOIPWu-hCVuE2fA3M8Tg">Crypto Español</a>. Gran parte de
las explicaciones contenidas bajo este epígrafe se han tomado de él.</p>
</div>
<p>Para implementar esta base de datos distribuida, las transacciones aún
pendientes de registrar se agrupan en bloques y la base de datos distribuida
toma la forma de una <strong>cadena de bloques</strong>, o sea, una secuencia ordenada de
bloques en el que uno va detrás del anterior. Un bloque, de forma muy, muy
resumida, tiene el siguiente aspecto:</p>
<img alt="../../../_images/bloque.png" src="../../../_images/bloque.png" />
<p>esto es:</p>
<ol class="arabic">
<li><p>Una cabecera con metadatos, entre los cuales hemos querido mencionar dos: el
<a class="reference internal" href="../02.algo.html#hash"><span class="std std-ref">hash</span></a> del bloque que le precede en la cadena, y el <abbr title="Number Only Used Once">nonce</abbr>, que
definiremos más adelante.</p></li>
<li><p>La lista de transacciones contenidas en el bloque. Pero ¿por qué se agrupan
múltiples transacciones en un bloque? La razón se halla en el problema de
sincronización del tiempo. En un libro de contabilidad, el orden en que se
llevan a cabo las transacciones es fundamental. El problema es que al ser un
sistema distribuido, necesitaríamos que todos los nodos tuvieran
sincronizados sus relojes y esto es un problema. Una solución que evita
sincronizar es dividr el tiempo en intervalos (p.e. 10 minutos) y agrupar
todas las transacciones que se han producido dentro de ese intervalo. De este
modo, ya no es necesario que todos los nodos tengan exactamente la misma
hora; y no sabremos en qué orden se hicieron las transacciones incluidas en
un mismo bloque, pero sí podremos estar seguros de que se hicieron después de
las transacciones del bloque anterior y antes de las del posterior.</p>
<p>Por supuesto, obrar así implica definir ciertas restricciones sobre las
transacciones de un mismo bloque como, por ejemplo, que no se incluyan dos
o más transacciones que implican la transferencia de las mismas monedas.</p>
</li>
</ol>
<p id="blockchain-img">La cadena de bloques, supuesto que ya tenga cuatro, se verá así:</p>
<img alt="../../../_images/cadena.png" src="../../../_images/cadena.png" />
<p>Por simplicidad, se ha supuesto que cada bloque sólo contiene una transacción y
que sólo existen los tres clientes (señores <strong>A</strong>, <strong>B</strong> y <strong>C</strong>) que
introdujimos bajo el epígrafe anterior. Como es necesario que alguno de los tres
posea algo inicialmente, en el primer bloque cargamos con 5 monedas al señor
<strong>A</strong>. Obsérvese, además, que la cadena de bloques es un mero libro de
contabilidad donde se van registrando transacciones y, en consecuencia, cada
cliente posee las monedas que la lectura de todas las transacciones arroja.
En el ejemplo, <strong>A</strong> tiene <span class="math notranslate nohighlight">\(5-3+1=3\)</span> <em>bitcoins</em>; <strong>B</strong>, <span class="math notranslate nohighlight">\(3-2=1\)</span>
<em>bitcoins</em>; y <strong>C</strong>, <span class="math notranslate nohighlight">\(2-1=1\)</span> <em>bitcoin</em>.</p>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>En estas transacciones se pueden expresar hasta ocho decimales para
los <em>bitcoins</em>. A cada cien millonésima parte de un bitcoin (<span class="math notranslate nohighlight">\(1*10^{-8}\)</span>)
se la denomina <em class="dfn">satoshi</em>. Por ejemplo, 0,00000321 <em>bitcoins</em> son 321
<em>satoshis</em>.</p>
</div>
<p>Aunque podríamos pasar de puntillas sobre las transacciones, si nuestra
intención sólo es dar una idea aproximada, profundizaremos un poco. Al realizar
transacciones, se generan las denominadas <abbr title="Unspent Transaction Output">UTXO</abbr> (o <em>transacción de salida no
gastada</em>). Una <em class="dfn">UTXO</em> es una cantidad <em>indivisible</em> de criptomoneda que
resulta de su envío a una dirección de cliente a fin de que éste pueda gastarla
en el futuro. Por ejemplo, el <em>Bloque</em> <strong>1</strong> crea una <abbr title="Unspent Transaction Output">UTXO</abbr> de 5₿ para el
señor <strong>A</strong>. ¿Qué significa que es indivisible?  Significa que en el <em>Bloque</em>
<strong>2</strong>, en que se transfieren 3₿ del total de cinco, no se toma como
entrada una parte de esta <abbr title="Unspent Transaction Output">UTXO</abbr> (<strong>3</strong>) y el resto queda sin gastar (<strong>2</strong>). Es
necesario gastarla por completo y, como consecuencia, la transacción que hemos
reflejado en el <em>Bloque</em> <strong>2</strong> no es tan simple, sino que en realidad supone:</p>
<ul class="simple">
<li><p>El gasto total de la <abbr title="Unspent Transaction Output">UTXO</abbr> de 5₿ que se creó en el <em>Bloque</em> <strong>1</strong>.</p></li>
<li><p>La creación de una <abbr title="Unspent Transaction Output">UTXO</abbr> de 3₿ para el señor <strong>B</strong>.</p></li>
<li><p>La creación de una <abbr title="Unspent Transaction Output">UTXO</abbr> de 2₿ para el propio señor <strong>A</strong>.</p></li>
</ul>
<p>Algo parecido ocurre con las transacciones de dinero físico. Si quieres pagar 3€
a alguien y lo haces con un billete de 5€, entregas tal billete y recibes una
moneda de 2€<a class="footnote-reference brackets" href="#id13" id="id1">1</a>.</p>
<p>Por supuesto, se puede crear una <abbr title="Unspent Transaction Output">UTXO</abbr> a partir de varias <abbr title="Unspent Transaction Output">UTXO</abbr> distintas,
incluso de distinto propietario. Por ejemplo, si en el próximo <em>Bloque</em> <strong>5</strong> el
señor <strong>A</strong> quiere transferir sus tres <em>bitcoins</em> al señor <strong>B</strong> entonces
generará una <abbr title="Unspent Transaction Output">UTXO</abbr> de salida a partir de dos <abbr title="Unspent Transaction Output">UTXO</abbr> de entrada: la que se
generó en el <em>Bloque</em> <strong>2</strong> como resultado del cambio y la que se generó en el
<em>Bloque</em> <strong>4</strong>. Es muy interesante la lectura del artículo <a class="reference external" href="https://sheinix.medium.com/transacciones-en-bitcoin-841a087ff439">Transacciones en
Bitcoin</a>.</p>
<p>Con este punto de partida, analicemos más detalladamente qué ocurre y cómo la
<strong>cadena de bloques</strong> soluciona los <a class="reference internal" href="#blockchain-prob"><span class="std std-ref">problemas expuestos al final del
apartado anterior</span></a>.</p>
<dl>
<dt><strong>Distinción de clientes</strong></dt><dd><p>Dado que todo este esquema nos sirve para realizar transacciones entre
clientes, es fundamental que cada cliente esté individualizado y que, por
ejemplo, el hecho de que la transacción del segundo bloque que transfiere dos
monedas del señor <strong>A</strong> al señor <strong>B</strong>, suponga que fue <strong>A</strong> el que
la hizo y que sólo <strong>B</strong> sea a partir de ese momento capaz de transferir esas
dos unidades.</p>
<p>Esto se logra generando cada cliente <a class="reference internal" href="../02.algo.html#asimetrico"><span class="std std-ref">un par de claves ECDSA</span></a><a class="footnote-reference brackets" href="#id14" id="id2">2</a>, por lo que cada cual tendrá una clave privada y una
clave pública. Por lo general, no interesa en absoluto saber quién es
realmente el cliente (¿quién es en realidad el señor <strong>A</strong>?<a class="footnote-reference brackets" href="#id15" id="id3">3</a>), muy al
contrario, se toma como uno de los objetivos preservar el anonimato.  Por ese
motivo, no hay certificados, sino simplemente parejas de claves que son
suficientes para individualizar a cada uno de los clientes.</p>
<p>De este modo, una <abbr title="Unspent Transaction Output">UTXO</abbr> se caracteriza por incluir un pequeño problema
criptográfico que debe ser resuelto al gastarla y requiere la <strong>clave
privada</strong> del destinatario. Esta es la manera de asegurarse de que una <abbr title="Unspent Transaction Output">UTXO</abbr>
sólo será gastada por aquel al que fue dirigida. Así, por ejemplo, la
transacción del Bloque <strong>1</strong> originó una <abbr title="Unspent Transaction Output">UTXO</abbr> con un problema que sólo
puede resolverse con la clave privada de <strong>A</strong>. La trasacción del Bloque
<strong>2</strong> supone el gasto por parte del señor <strong>A</strong> de dicha <abbr title="Unspent Transaction Output">UTXO</abbr> (gracias a
que dispone de su clave privada) y la creación de otra <abbr title="Unspent Transaction Output">UTXO</abbr> cuyo gasto
exige la clave privada del señor <strong>B</strong>.</p>
<p>Por otro lado, la <strong>clave pública</strong> sirve para identificar al cliente. Y,
así, cuando se transfiere criptomoneda al señor <strong>B</strong>, se transfiere a su
dirección pública, que deriva de <a class="reference internal" href="#prac-claves"><span class="std std-ref">aplicar algoritmos de hash a su clave
pública</span></a>.</p>
<p>En realidad, en el mundo de las criptomonedas se maneja el concepto de
<em class="dfn">wallet</em> (o <em class="dfn">monedero</em> o <em class="dfn">billetera</em>). Cada cliente está
representado por su <em>wallet</em>, de manera que cuando se hacen transacciones a
alguien se hacen transferencias a la dirección de su <em>wallet</em>. Sin embargo, a
diferencia de lo que podría parecer por su nombre y la analogía con el mundo
físico, los <em>wallets</em> no contienen monedas, sino la clave privada asociada al
cliente, a partir de la cual se obtiene la clave pública correspondiente.
Usando está clave pública y aplicando algoritmos de resumen (véase
<a class="reference internal" href="#prac-claves"><span class="std std-ref">claves de bitcoin</span></a>) se calcula la dirección del <em>wallet</em>.
que es el dato que debemos proporcionar a aquel que queremos que nos
transfiera criptomoneda. El <em>wallet</em> es personal e intransferible y, mientras
no nos lo roben, podemos estar seguros de que dispondremos de las monedas que
la cadena de bloques determina que son nuestras. Más adelante,
<a class="reference internal" href="#wallets"><span class="std std-ref">profundizaremos en el conocimiento de estas billeteras</span></a>.</p>
</dd>
<dt><strong>Secuencialidad</strong></dt><dd><p>El orden de los bloques esta definido por el hecho de que cada bloque incluye
un <em>hash</em> (<abbr title="Sechure Hash Algorithm">SHA</abbr>-256) del bloque anterior. Nótese, además, que manipular un
bloque (pongamos que se intenta alterar a posteriori la transacción incluida
en el bloque 2) supone que habrá que cambiar todos los bloques subsiguientes,
porque dejarán de ser válidos los <em>hashes</em> contenidos en ellos.</p>
</dd>
<dt><strong>Manipulación</strong></dt><dd><p>Las transacciones incluidas dentro de los bloques que componen la cadena deben
ser legítimas e inmutables:</p>
<ul class="simple">
<li><p>No deberían poder incluirse trasacciones fraudulentas. Por ejemplo, el
<em>Bloque</em> <strong>3</strong> no debería incluir una transacción en la que el señor <strong>A</strong>
transfiriera los tres mismo <em>bitcoins</em> que ya transfirió al señor <strong>B</strong>.
Obviamente, existen una reglas prestablecidas que evitan esta
circunstancia, pero ¿cómo evitar que uno o varios mineros malintencionados
empiecen a incluirlas? Recordamos que estamos ante un sistema
descentralizado en el que se pretende evitar que la figura de un regulador
centralizado.</p></li>
<li><p>Nadie debería tener la potestad de decidir caprichosamente qué
transacciones son <em>aceptables</em> y cuáles no. Obsérvese que no usamos el
adjetivo <em>válido</em> sino <em>aceptable</em>. Las transacciones deben ser válidas,
porque de lo contrario serían fraudulentas. Pero <em>aceptable</em> es otra cosa.
Nos referimos a que se decida que no se van a aceptar transacciones que
incluyan la dirección del señor <strong>A</strong>. ¿Por qué? Porque se ha decidido que
no.</p></li>
<li><p>Tampoco es admisible que se quiera revertir la cadena desechando bloques
que ya fueron aceptados. O dicho de otro modo, que la cadena ya
constituida no sea inmutable. Imaginemos, por ejemplo, que alguien
malintencionado pretende robar las tres monedas que obtiene el señor <strong>B</strong>
gracias a la transacción del bloque <strong>2</strong> rescribiendo esa transacción
para que las monedas se destinen al <em>wallet</em> de <strong>C</strong>. Tendría que hacer
ese cambio y luego, rescribir los bloques siguientes para alterar los
<em>hashes</em>: si lograra hacer prevalecer esta cadena alternativa en los
nodos, se habría consumado el fraude.</p></li>
</ul>
<p>En definitiva, los mineros tienen que consensuar una cadena de bloques, pero
no hay ninguna entidad que supervise y valide su comportamiento, porque esto
supondría depender de algo o alguien y eso es precisamente lo que se
pretende evitar con esta tecnología.  <em>Bitcoin</em> proporcionó la primera
solución práctica al problema<a class="footnote-reference brackets" href="#id16" id="id4">4</a> de alcanzar un objetivo común cuando no
se puede estar seguro de la fiabilidad de todos los agentes implicados. Y la
solución es, criptográfica. En realidad, en estas cadenas de bloques no se
admite que el <em>hash</em> de cada bloque sea un número cualquiera de 256 <em>bits</em>
(recordemos que se usa <abbr title="Sechure Hash Algorithm">SHA</abbr>-256), sino que debe cumplir un requisito (por
ejemplo, que las 30 primeras cifras sean 0). Pero un resumen criptográfico
está determinado por el contenido que se resume, así que ¿cómo se le pueden
poner exigencias al <em>hash</em>? Saldrá el que tenga que salir. Aquí es donde
entra en juego el <abbr title="Number Only Used Once">nonce</abbr>. El <em class="dfn">nonce</em> es un número de 4 <em>bytes</em> cuya
función es exclusivamente alterar el valor del resumen. En consecuencia,
para que un bloque sea válido, un minero tiene que ir alterando el valor del
<abbr title="Number Only Used Once">nonce</abbr> hasta dar con uno para el que el <em>hash</em> resultante cumpla las
condiciones impuestas. Obtenido, remitirá el bloque al resto de mineros para
que lo validen por mayoría (al menos el 51%), y, si es así, lo añadan al
final de la cadena. No hay fórmula para obtener un <abbr title="Number Only Used Once">nonce</abbr> apropiado:
simplemente hay que ir probando una y otra vez hasta dar con uno.  Cuando
más estrictas son estas condiciones, mayor <em class="dfn">dificultad</em> para obtenerlo.
Este proceso de obtención del bloque (del <abbr title="Number Only Used Once">nonce</abbr>, en realidad) es lo que se
conoce como <em class="dfn">prueba de trabajo</em> y es la razón por la que a los nodos de
esta red se les conoce como «mineros»: deben encontrar por trabajo bruto un
bloque adecuado antes de poder añadirlo a la cadena, del mismo modo que un
minero tiene que cavar en una mina para obtener el mineral. En conclusión:</p>
<ul class="simple">
<li><p>La aceptación se logra cuando la mayoría está de acuerdo, por lo que
introducir transacciones fraudulentas, censurar transacciones o alterar
las transacciones ya registradas sólo es posible si se controla a más
de la mitad de los mineros.</p></li>
<li><p>Para disuadir la acción de mineros malintencionados, se exige la <em>prueba
de trabajo</em>: crear bloques con transacciones fraudulentas exige gastar
recursos.</p></li>
</ul>
<p>En el caso particular del <em>bitcoin</em>, la dificultad es dinámica y se recalcula
cada 2016 bloques (unas dos semanas) para que aproximadamente se mine un
bloque cada 10 minutos.</p>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>El <em class="dfn">algoritmo de consenso</em>, esto es, el mecanismo que permite
decidir la validez de los bloques es la base del funcionamiento de la
cadena de bloques, ya que la utilidad que aporta una <em>blockchain</em> sobre una
solución centralizada es que nadie puede controlarla. Perdida la descentralización,
la <em>blockchain</em> es absurda, porque una solución centralizada
siempre es más eficiente desde un punto de vista técnico. <em>Bitcoin</em> usa
como <em>algoritmo de consenso</em>, la <strong>prueba de trabajo</strong> (<abbr title="Proof Of Work">PoW</abbr> por sus
sigas en inglés), la cual se suele criticar por el enorme consumo energético
que supone. Por este motivo, se han ideado otros <em>algoritmos de consenso</em>.
El más usado es la <strong>prueba de participación</strong> (<abbr title="Proof Of Stake">PoS</abbr> por sus siglas en
inglés). La <em class="dfn">prueba de participación</em> escoge qué minero<a class="footnote-reference brackets" href="#id17" id="id5">5</a> añadirá
el nuevo bloque a la cadena, basándose en su riqueza, no en su potencia de
cálculo.  Todo aquellos que pretenden forjar el siguiente bloque deben
reservar (congelar) una cantidad de criptomoneda, que recibe el nombre de
<em>participación</em>, de modo que su probabilidad de ser escogido es
proporcional a tal dedicación monetaria.  Además, a aquel que intente
añadir un bloque inválido o a aquel que vote como válido un bloque que no
lo sea, se le retirará como penalización su participación de criptomoneda.
Como esta estrategia no se basa en la potencia de cálculo, no consume
grandes cantidades de energía. Sus detractores alegan, sin embargo, que
tiende a concentrar (centralizar) la cadena, ya que aquellos más ricos
tenderán a hacerse más ricos aún y, además, es prácticamente imposible
arrebatarles su posición predominante. <a class="reference external" href="https://ethereum.org">Ethereum</a> a mediados de septiembre
de 2022 cambió su estrategia de <abbr title="Proof Of Work">PoW</abbr> a <abbr title="Proof Of Stake">PoS</abbr><a class="footnote-reference brackets" href="#id18" id="id6">6</a>.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">Ver también</p>
<p>En <a class="reference external" href="https://101blockchains.com">101blochains.com</a> hay algunos buenos artículos sobre
algoritmos de consenso: el completo <a class="reference external" href="https://101blockchains.com/consensus-algorithms-blockchain/">Consensus Algorithms: The Root Of
Blockchain Technology</a>, que puede
complementarse con el breve <a class="reference external" href="https://101blockchains.com/what-is-consensus-algorithm/">Beginner’s Guide: What Is Consensus
Algorithm?</a>; o
otro que compara <abbr title="Proof Of Work">PoW</abbr> con <abbr title="Proof Of Stake">PoS</abbr>: <a class="reference external" href="https://101blockchains.com/pow-vs-pos-a-comparison/">PoW Vs. PoS: A Comparison Between Two
Blockchain Consensus Algorithms</a>.</p>
</div>
</dd>
<dt><strong>Colisiones</strong></dt><dd><p>Por colisión entendemos que dos o más nodos quieran de manera más o menos
simultánea introducir el siguiente bloque en la cadena. En nuestro ejemplo,
añadir el bloque <strong>5</strong>. Gracias a la <em>prueba de trabajo</em>, esta coincidencia se
producirá solamente si dos nodos han logrado minar simultáneamenta el bloque,
lo cual reduce mucho la competencia. Si se produce esta última circunstancia,
entonces ambos nodos difundirán su bloque en la red y nos encontraremos con
nodos que tienen como bloque <strong>5</strong> el de uno y bloques que tienen como bloque
<strong>5</strong> el otro. Como esto es inaceptable, ya que la cadena debe ser única, el
sistema se esperará para tomar una decisión a la generación del siguiente
bloque (el <strong>6</strong>): la variante que prevalecerá será aquella que logre generar
antes el bloque <strong>6</strong>; y al producirse este hecho, todos los nodos adoptarán
esta variante y desecharán la otra. Si se hubiera vuelto a producir la
simultaneidad, se resolverá cuál es la cadena prevalente en el bloque <strong>7</strong> y
así sucesivamente, porque, en general, se considera como cadena prevalente la
cadena más larga.</p>
</dd>
<dt><strong>Incentivos</strong></dt><dd><p>La labor de los mineros implica grandes costes en equipos y electricidad, por
lo que sin la existencia de incentivos, nadie minaría. Para asegurar su
existencia, pueden obtener como compensación criptomoneda por dos conceptos:</p>
<ul class="simple">
<li><p>Por <strong>bloque minado</strong>. Las nuevas monedas se crean al minar bloques y dar esa
recompensa al minero que ha logrado añadirlo. En el caso del
<em>bitcoin</em> como su creador decidió que su cantidad total estuviera limitada
a 21 millones, la recompensa decrece con el tiempo. Empezó siendo de 50₿
y cada 210.000 bloques (unos 4 años aproximadamente) se divide a la
mitad. A este hecho de dividir a la mitad la recompensa se lo conoce como
<em class="dfn">halving</em>.</p></li>
<li><p><strong>Comisión</strong> a las transacciones. En el caso particular de <em>bitcoin</em>, esta la
forma de financiar la red cuando se llegue a la cantidad máxima.</p></li>
</ul>
</dd>
</dl>
</section>
<section id="smart-contracts">
<span id="smart-contract"></span><h2><span class="section-number">9.1.3.7.3. </span><em>Smart contracts</em><a class="headerlink" href="#smart-contracts" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Hasta ahora nos hemos limitado a presentar el contenido de los bloques como un
conjunto de apuntes en los que se registra la transferencia de una criptomoneda
(<strong>A</strong> ⟶ <strong>B</strong> la cantidad de 5₿). O sea, la criptomoneda que sustenta
la <em>blockchain</em> (p.e. <em>Bitcoin</em>) se comporta como moneda de valor tal y como lo
hace el <a class="reference external" href="https://es.wikipedia.org/wiki/Dinero_fiduciario">dinero fiat</a> (euro,
dólar, etc.). Sin embargo, el texto que una <em>blockchain</em> certifica como válido e
inalterable puede ser cualquiera, así que ¿por qué limitarse a ello?</p>
<p>Un <em class="dfn">contrato inteligente</em> (<em class="dfn">smart contract</em>) es un acuerdo entre
partes (o sea, un contrato) que en vez de estar redactado en una lengua natural
adquiere la forma de un código informático a fin de que sus cláusulas puedan
ejecutarse automáticamente cuando se cumplen las condiciones estipuladas en él.
Esto supone que la cadena de bloques (o sea, la red de mineros) no sólo registra
los términos del contrato, sino que se encarga de ejecutar el código.</p>
<p>Por ejemplo, imaginemos que una nueva empresa tecnológica (lo que últimamente
viene a llamarse <a class="reference external" href="https://www.camara.es/blog/creacion-de-empresas/que-es-una-startup">startup</a>) requiere
de financiación para empezar sus proyectos. Para ello puede recurrir a las
fuentes de financiación habituales (préstamos bancarios, campaña de
<em>crowdfunding</em>, etc.), pero también puede articular la financiación a través de
un <em>contrato inteligente</em> que comprenda:</p>
<ul class="simple">
<li><p>La generación de unas participaciones.</p></li>
<li><p>La compra de estas participaciones por parte de los inversores interesados.</p></li>
<li><p>Tal compra financia la actividad comercial de la empresa.</p></li>
<li><p>Si la actividad comercial prospera los inversores pueden recibir retribuciones
extra (algo así como unos dividendos en el mundo de la bolsa tradicional).</p></li>
</ul>
<p>Dicho de este modo tan vago, la descripción no se diferencia en nada de un
método tradicional de financiación, así que afinaremos lo que hace la
empresa:</p>
<ul>
<li><p>Elige una <em>blockchain</em> que permita la formalización de contratos
inteligentes. La mayor de este tipo es <a class="reference external" href="https://ethereum.org">Ethereum</a>.</p>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>Hay, no obstante, otra solución: usar una plataforma que sea capaz
de añadir datos extra (p.e. <em>contratos inteligentes</em>) a una <em>blockchain</em>
como la de <em>Bitcoin</em>. Es el caso de <a class="reference external" href="https://www.omnilayer.org">OmniLayer</a>, de la que podemos leer una
pequeña introducción en <a class="reference external" href="https://www.criptonoticias.com/tutoriales-guias/omni-plataforma-tokens-blockchain/">este tutorial de criptonoticias.com</a>
o el protocolo <abbr title="Really Good For Bitcoin">RGB</abbr> del que tenemos algunas explicaciones en <a class="reference external" href="https://es.cointelegraph.com/explained/rgb-bitcoin-smart-contracts-and-lightning-network">un artículo
de cointelegraph.com</a>
o <a class="reference external" href="https://bitcoinmagazine.com/guides/a-brief-introduction-to-rgb-protocols">este otro de Bitcoin Magazine</a>.</p>
</div>
</li>
</ul>
<ul class="simple" id="crypto-token">
<li><p>Escribe el código de un <em>contrato inteligente</em> que supone la creación de un
<em>token</em>. Un <em class="dfn">token</em> es la representación de un determinado valor
dentro del ámbito definido para ese contrado por una entidad particular.
Conceptualmente, son exactamente lo mismo que las fichas dentro de un casino:
no tienen valor alguno fuera de él, pero dentro representan un valor que
podremos canjear en cualquier momento. Así pues, la idea es generar una
cantidad determinada de <em>tokens</em> (por ejemplo, un millón) y que esta
represente el total de la empresa, de este modo la participación de cada
inversor viene determinada por el número de <em>tokens</em> que adquiera.</p></li>
<li><p>Lanza los <em>tokens</em> con la esperanza de que los inversores los
adquieran y de esta forma consiga la financiación necesaria. Como el contrato
es inteligente, si en un plazo prestablecido no se llega al mínimo necesario,
el código puede restituir lo invertido en <em>token</em> a los inversores; y, si se
alcanza, puede entregar el dinero recaudado con esos <em>token</em> a la empresa. Todo
de forma automática. Por supuesto, los <em>token</em> pueden transferirse entre
usuarios con lo que puede crearse un mercado de intercambio de <em>token</em> análogo
al que se crea de intercambio de criptomonedas, los cuales valdrán más o menos
dependiendo de la marcha de la empresa (o de las expectativas que logre
crear).</p></li>
<li><p>Puede gratificar a los poseedores de los <em>token</em>, si así lo estipula el
contrato con más <em>token</em> o dinero.</p></li>
</ul>
<p>La pregunta que puede asaltarnos ahora es: en estas cadenas pensadas para la
suscripción y ejecución de <em>contratos inteligentes</em>, ¿qué papel pintan las
criptomonedas? La respuesta es que todo <em>blockchain</em> tiene asociada su propia
criptomoneda (<em>ETH</em> en el caso de <a class="reference external" href="https://ethereum.org">Ethereum</a>), porque es la criptomoneda la que
hace atractiva la <em>blockchain</em> a los mineros. La criptomoneda sigue sirviendo
para gratificar la generación de nuevos bloques, sigue sirviendo para permitir
el registro de transacciones y, en el caso de <em>blockchains</em> destinadas a
<em>contratos inteligentes</em>, sirven también para pagar la ejecución del código. En
consecuencia, tiene utilidad y, por tanto, resultan valiosas (y, sí, <a class="reference external" href="https://es.investing.com/crypto/ethereum">se
intercambian por moneda fiat igual que el bitcoin</a>).</p>
<div class="admonition warning">
<p class="admonition-title">Advertencia</p>
<p>Tanto para los <strong>token</strong> como para las <strong>criptomonedas</strong> hay mercado de
compraventa, por lo que se pueden adquirir o vender cambiándolos por <em>moneda
fiat</em> y, en consecuencia, podremos consultar cuál es su cotización. Por esta
razón es muy común ver aplicado el término de criptomoneda indistintamente a
ambos. Pero <strong>no son lo mismo</strong>, antes bien son muy diferentes: sobre una
criptomoneda no hay control centralizado, puesto que nadie controla su
<em>blockchain</em><a class="footnote-reference brackets" href="#id19" id="id7">7</a>. Un <em>token</em>, en cambio, no tiene una <em>blockchain</em> propia y,
además, es emitido por una entidad particular, por lo que su valor
estará supeditado al comportamiento del agente.</p>
</div>
<p>Si echamos un vistazo a <a class="reference external" href="https://coinmarketcap.com">coinmarketcap.com</a> para consultar las cotizaciones de
las principales &quot;criptomonedas&quot; a comienzos de agosto de 2022, veremos que
<em>token</em> y <em>criptomonedas</em> se hallan confundidos en una misma lista:</p>
<table class="crypto-list docutils align-default">
<colgroup>
<col style="width: 6%" />
<col style="width: 43%" />
<col style="width: 51%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>No</p></th>
<th class="head"><p>Nombre</p></th>
<th class="head"><p>Naturaleza</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p><a class="reference external" href="https://coinmarketcap.com/es/currencies/bitcoin">Bitcoin</a></p></td>
<td><p>criptomoneda</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p><a class="reference external" href="https://coinmarketcap.com/es/currencies/ethereum">Ethereum</a></p></td>
<td><p>criptomoneda</p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p><a class="reference external" href="https://coinmarketcap.com/es/currencies/tether">Theter</a></p></td>
<td><p>token (omnilayer, ethereum et alia)</p></td>
</tr>
<tr class="row-odd"><td><p>4</p></td>
<td><p><a class="reference external" href="https://coinmarketcap.com/es/currencies/usd-coin">USD Coin</a></p></td>
<td><p>token (ethereum et alia)</p></td>
</tr>
<tr class="row-even"><td><p>5</p></td>
<td><p><a class="reference external" href="https://coinmarketcap.com/es/currencies/bnb">BNB</a></p></td>
<td><p>criptomoneda</p></td>
</tr>
</tbody>
</table>
<p>Un ejemplo de <em>token</em> con una finalidad totalmente distinta a la anterior es
<a class="reference external" href="https://coinmarketcap.com/es/currencies/basic-attention-token">BAT</a>, creado para que el navegador <a class="reference external" href="https://www.brave.com">Brave</a>
gratifique la publicidad que reciben sus usuarios. La idea tras el <em>token</em> es
que el usuario, una vez que ha instalado el navegador, habilite el sistema de
<a class="reference external" href="https://brave.com/es/brave-rewards/">recompensas del navegador</a> que a cambio
de mostrarle publicidad a través del sistema de notificación de su sistema
operativo gratifica cada anuncio con una determinada cantidad del <em>token</em> <abbr title="Basic Attention Token">BAT</abbr>.
El <em>token</em> se acomula y puede cederse a los sitios web preferidos del usuario o,
simplemente, canjearse por otra criptomoneda en algunos <a class="reference internal" href="#crypto-exchanges"><span class="std std-ref">exchanges</span></a>, dependiendo de cuál sea su cotización.</p>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>Hay dos términos más con los que se suelen referir criptomonedas y
<em>tokens</em>:</p>
<dl class="simple">
<dt><em class="dfn">altcoin</em></dt><dd><p>Cualquier criptomoneda o <em>token</em> que no sea <em>Bitcoin</em>, por ser ella
la primera que se creó.</p>
</dd>
<dt><em class="dfn">shitcoin</em></dt><dd><p>Cualquier criptomoneda o <em>token</em> creada con el mero fin de especular o
estafar a sus compradores. Obviamente, para llegar a esta conclusión es
necesaria una valoración de la confianza que despiertan sus creadores, su
utilidad y cuáles novedades aporta, por lo que la aplicación del término
es muy subjetiva.</p>
</dd>
</dl>
</div>
<p class="rubric">Tipos de <em>token</em></p>
<p>Hay, fundamentalmente, dos tipos:</p>
<dl>
<dt><em class="dfn">Utility token</em> (<em class="dfn">token de utilidad</em>)</dt><dd><p>que son aquellos que se adquieren a la entidad particular a cambio de la promesa
de recibir en el futuro un servicio o una ventaja. En ningún caso suponen
propiedad. Por ejemplo, una <em>startup</em> que tenga intención de crear una
plataforma de video por <em>streaming</em> puede ofertar <em>token</em> que den derecho a
descuentos en la cuota mensual; u otra de almacenamiento en la nube un
<em>token</em> que de derecho a <abbr title="Megabyte">MB</abbr> de almacenaje. El citado <a class="reference external" href="https://coinmarketcap.com/es/currencies/basic-attention-token">BAT</a> es un <em>token</em> de utilidad.</p>
<p>Este tipo de <em>token</em> no están sujetos al marco regulatorio legal. Sus ofertas
iniciales reciben el nombre de <abbr title="Initial Coin Offering">ICO</abbr> (oferta inicial de criptomonedas).</p>
</dd>
<dt><em class="dfn">Security token</em> (<em class="dfn">token de seguridad</em>)</dt><dd><p>que son aquellos que representan la propiedad de un activo por lo que,
consecuentemente, se consideran instrumentos de inversión y su emisión está
sujeta al marco regulatorio<a class="footnote-reference brackets" href="#id20" id="id8">8</a>. Sus ofertas iniciales reciben el nombre de
<abbr title="Security Token Offering">STO</abbr> (<em>oferta de token de seguridad</em>).</p>
<p>Dependiendo de cuál sea el activo que respalden, toman distinto nombre:</p>
<ul class="simple">
<li><p><em class="dfn">Equity token</em> (<em>token de acciones</em>), que representa la participación
en la propiedad de una empresa y pueden asimilarse, por tanto, al concepto
tradicional de <em>acción</em>. Puede suponer como ésta el derecho a dividendo o a
voto.</p></li>
<li><p><em class="dfn">Debt token</em> (<em>token de deuda</em>) que representan un préstamo y que, en
consecuencia, suponen la restitución futura del dinero más un interés.</p></li>
<li><p><em class="dfn">Asset-backend token</em> (<em>token de activos</em>), que representan la
adquisición de parte un activo físico y están respaldados por éste. El
activo puede ser de muy diversa naturaleza: propiedades inmobiliarias,
materias primas, etc.</p></li>
</ul>
</dd>
</dl>
</section>
<section id="casas-de-cambio-exchanges">
<span id="crypto-exchanges"></span><h2><span class="section-number">9.1.3.7.4. </span>Casas de cambio (exchanges)<a class="headerlink" href="#casas-de-cambio-exchanges" title="Enlazar permanentemente con este título">¶</a></h2>
<p>En principio, para realizar una transacción de la criptomoneda sólo es necesario
conectarse con un cliente a la red que sustenta la <em>blockchain</em> y conocer la
dirección del destinatario. Esto puede ser suficiente si se usa la criptomoneda
para el pago de un servicio o un producto (lo cual no es aún muy frecuente).
Pero ¿cómo hacemos cuando nuestra intención es intercambiar criptomoneda por
moneda <em>fiat</em> o por otra criptomoneda?</p>
<p>Un <em class="dfn">exchange</em> es una plataforma a la que acuden usuarios para cambiar una
criptomoneda por dinero fiat u otra criptomoneda. Por tanto, son el equivalente
digital a la tradicionales <a class="reference external" href="https://es.wikipedia.org/wiki/Casa_de_cambio">casas de cambio</a>. Son los valores de intercambio
en estas plataformas, basados en la oferta y la demanda. los que definen el
valor de la criptomoneda. Por supuesto, el valor no es el mismo en todas las
plataformas, pero no puede ser muy dispar, porque tiende a equilibrarse ya que
valores bajos atraen a compradores (lo cual aumenta la demanda) y valores altos
atraen a vendedores (lo cual aumenta la oferta). Por ejemplo, <a class="reference external" href="https://cryptoradar.com/es/comprar-bitcoin">estos son los
valores actuales para Bitcoin en distintos exchanges</a>.</p>
<p>Desde el punto de vista de su funcionamiento, hay dos tipos de <em>exchanges</em>:</p>
<dl>
<dt><strong>Centralizado</strong> (<abbr title="Centralized EXchange">CEX</abbr>)</dt><dd><p>Es aquel en que una entidad actúa como intermediario confiable por lo que
debe transferírsele de antemano a la entidad el dinero <em>fiat</em> o la
criptomoneda que se desea vender. Esto último significa que deberemos
transferir nuestra criptomoneda a una billetera creada y gestionada por el
propio <em>exchange</em> para nosotros. Lo habitual es que se desconozca la clave
privada de la billetera y que sea el propio <em>exchange</em> el que la utilice
cuando sea preciso en una transacción. Esto supone, de facto, que perdemos el
control sobre ella y que nuestras criptomonedas estén expuestas a ataques al
<em>exchange</em> o la quiebra de la entidad. En este tipo de casas de cambio pueden
intercambiarse criptomonedas por dinero <em>fiat</em> o criptomonedas entre sí.</p>
<p>Las operaciones de intercambio se lleva a cabo cuando comprador y vendedor se
ponen de acuerdo en un precio de venta tal y como ocurre cuando se compran y
venden acciones en el mercado tradicional. Por lo tanto, habrá clientes que
ofrezcan la compra o venta de una criptomoneda a un determinado precio
(<em class="dfn">makers</em>) y clientes que directamente compran o venden al precio
ofrecido por algún <em>maker</em> (<em class="dfn">takers</em>). Los primeros crean oferta y los
segunda eliminan oferta y suelen pagar unas comisiones al <em>exchange</em> más
elevadas.</p>
<p>Dado que estas entidades son empresas sujetas a la regulación de los estados,
exigirán conocer la identidad real y el domicilio de la persona que opera con
ellos (el llamado <abbr title="Know your customer">KYC</abbr>, «<a class="reference external" href="https://es.wikipedia.org/wiki/Conozca_a_su_cliente">conozca a su cliente</a>»).</p>
<p><a class="reference external" href="https://coinmarketcap.com">coinmarketcap.com</a> nos ofrece una <a class="reference external" href="https://coinmarketcap.com/es/rankings/exchanges/">lista de exchanges centralizados</a>.</p>
</dd>
<dt><strong>Descentralizado</strong> (<abbr title="Decentralized EXchange">DEX</abbr>)</dt><dd><p>Es aquel en que no hay entidad intermediaria, sino que la transacción se
lleva a cabo a través de un <a class="reference internal" href="#smart-contract"><span class="std std-ref">contrato inteligente</span></a>. Lo
habitual es que estén limitadas al intercambio de criptomonedas propias de la
<em>blockchain</em> en la que se formaliza el contrato inteligente.</p>
<div class="admonition warning">
<p class="admonition-title">Advertencia</p>
<p>¿Distintas criptomonedas todas propias de una misma
<em>blockchain</em>? ¿Es eso posible? Evidentemente no, según lo explicado ahora.
En realidad, los intercambios se realizan entre la criptomoneda y los
<em>tokens</em> asociados a la misma <em>blockchain</em>.</p>
</div>
<p>Un <abbr title="Decentralized EXchange">DEX</abbr> muy utilizado es <a class="reference external" href="https://app.uniswap.org/">uniswap.org</a>, que
permite intercambios de criptomoneda y <em>tokens</em> en la <em>blockchain</em> de
<em>Ethereum</em>. El sitio web y una billetera de aplicación (véase <a class="reference internal" href="#wallets"><span class="std std-ref">wallets</span></a>) adecuada, bastan para efectuar el intercambio.</p>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>En principio, implementar un <abbr title="Decentralized EXchange">DEX</abbr> que sea capaz de intercambiar
criptomonedas de distinta <em>blockchain</em> puede llevarse a cabo a través de
los <a class="reference external" href="https://academy.binance.com/es/articles/atomic-swaps-explained">atomic swaps</a>.</p>
</div>
<p><a class="reference external" href="https://coinmarketcap.com">coinmarketcap.com</a> nos ofrece una <a class="reference external" href="https://coinmarketcap.com/es/rankings/exchanges/dex/">lista de exchanges decentralizados</a>.</p>
</dd>
</dl>
</section>
<section id="billeteras">
<span id="wallets"></span><h2><span class="section-number">9.1.3.7.5. </span>Billeteras<a class="headerlink" href="#billeteras" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Ya se ha expuesto que el dinero en posesión de cada cliente está determinado por
el saldo que resulta de leer las transacciones registradas en la <em>blockchain</em>
(recordemos que <a class="reference internal" href="#blockchain-img"><span class="std std-ref">el señor A posee 3 bitcoins</span></a>, porque
<span class="math notranslate nohighlight">\(5-3+1=3\)</span>).  No hay, pues, ningún lugar físico o digital en el que tenga
almacenadas sus criptomenedas. Entonces, ¿qué es una <strong>billetera</strong> o un
<strong>monedero</strong> o un <strong>wallet</strong>?  Desde luego no es lo equivalente a su homónimo
físico (el monedero que llevamos en el bolsillo), porque no almacena dinero.</p>
<p>Un <em class="dfn">wallet</em> (o <em class="dfn">billetera digital</em>) es el mecanismo que permite al
cliente de una <em>blockchain</em> almacenar y gestionar las claves criptográficas que
lo individualizan. Obsérvese que preferimos usar el término individualizar en
vez de identificar, porque las claves criptográficas no certifican nuestra
identidad física real en absoluto (eso lo haría un <a class="reference internal" href="01.certdig.html#cert-digital"><span class="std std-ref">certificado digital</span></a>), pero sí nos diferencian de los demás, porque cada cual tiene
un par distinto de claves.</p>
<p>El <em>wallet</em> del señor <strong>A</strong> almacena sus claves, así que, si cualquier otro
cliente realiza una <abbr title="Unspent Transaction Output">UTXO</abbr> a su dirección, sólo el señor <strong>A</strong>, que es el único
que tiene acceso a su <em>wallet</em>, podrá consumir esa <abbr title="Unspent Transaction Output">UTXO</abbr> y, en consecuencia,
posee esas criptomonedas. Todo es anónimo y, en principio, seguro… siempre
que un tercero malintencionado no tenga acceso al <em>wallet</em> y se haga con las
claves, en cuyo caso podría gastar todas las <abbr title="Unspent Transaction Output">UTXO</abbr> dirigidas a ese <em>wallet</em>
enviándolas a un <em>wallet</em> distinto del que él sea propietario.</p>
<p>Hay varios tipos de billeteras que podemos clasificar en dos grupos:</p>
<dl>
<dt><em class="dfn">Billeteras calientes</em> (<em>hot wallets</em>)</dt><dd><p>Son aquellas que almacenan las claves en lugares con conexión continua a
internet.</p>
<ol class="arabic">
<li><p><em class="dfn">Billeteras online</em> (o <em class="dfn">billeteras web</em>):</p>
<p>Billeteras proporcionadas por plataformas online (<a class="reference internal" href="#crypto-exchanges"><span class="std std-ref">exchanges</span></a>) en las que generalmente es el propio servicio el que
gestiona las claves y el usuario sólo dispone de credenciales de
identificación a la propia plataforma. Su uso es muy sencillo, pero se
pierde por completo el control sobre la criptomoneda propia que es,
precisamente, uno de los pilares en los que se fundamente el dinero
digital: cualquier ataque a la entidad gestora o su quiebra, provocará la
pérdida irremediable de los fondos.</p>
</li>
<li><p><em class="dfn">Billeteras de aplicación</em>:</p>
<p>Billeteras almacenadas localmente y gestionadas desde una aplicación
cliente de escritorio o móvil (<a class="reference external" href="https://electrum.org">Electrum</a>, <a class="reference external" href="https://trustwallet.com">Trust wallet</a>). Estas
aplicaciones permiten interactuar directamente con la <em>blockchain</em> sin
necesidad de descargarla totalmente. Lo habitual (y deseable) es que
permitan exportar e importar las claves.</p>
<p>En este caso, las claves no salen del dispositivo en que se instala la
aplicación y suelen encontrarse cifradas con alguna contraseña que impida
su uso por terceros con acceso.</p>
</li>
</ol>
</dd>
<dt><em class="dfn">Billeteras frías</em> (<em>cold wallets</em>)</dt><dd><p>Son aquellas que almacenan las claves en un dispositivo ajeno a internet.</p>
<ol class="arabic" start="3">
<li><p><em class="dfn">Billeteras hardware</em></p>
<p>Son dispositivos físicos especialmente diseñados para almacenar las claves
y que éstas nunca salgan de él. Para operar con las claves que contiene, se
conectan por <abbr title="Universal Serial Bus">USB</abbr>, pero sin posibilidad de extraer las claves. También
disponen de mecanismos para evitar su manipulación física por lo que son
altamente seguros. Las más utilizadas son <a class="reference external" href="https://trezor.io">Trezor</a> y <a class="reference external" href="https://www.ledger.com">Ledger</a>.</p>
</li>
<li><p><em class="dfn">Billeteras en papel</em></p>
<p>Son literalmente un papel donde se encuentran escritas las claves. Como
escribirlas y leerlas manualmente se presta a errores de
transcripción, suele recurrirse a un generador de claves que genere el
papel con los códigos transcritos y una versión en formato <abbr title="Quick Response">QR</abbr>, que
facilite su posterior lectura. Por otro lado, cuando se quiera hacer uso
de los fondos, no sólo habrá que leer la clave, sino introducirla en una
billetera de aplicación con lo que se perderá la ventaja de seguridad de
haber usado una <em>billetera fría</em> y sería recomendable utilizar una nueva
billetera de papel para los fondos sobrantes.</p>
<p>Para generar la billetera en papel con formato <abbr title="Quick Response">QR</abbr> podemos recurrir a
aplicaciones online con <a class="reference external" href="https://www.bitaddress.org">bitaddress.org</a>, que genera las claves en el
lado del cliente mediante <em>Javascript</em>.</p>
<div class="admonition seealso">
<p class="admonition-title">Ver también</p>
<p>Para una discusión sobre estas billeteras es interesante el
artículo <a class="reference external" href="https://blog.trezor.io/paper-wallets-a-relic-of-the-past-1f711ba82b8c">Paper Wallets — A Relic of the Past</a>
(aunque, claro, está escrito en un blog de un fabricante de billeteras
<em>hardware</em>).</p>
</div>
</li>
</ol>
</dd>
</dl>
<p>Es importante tener presente que aquello que individualiza no es el <em>wallet</em> en
sí, sino la clave privada<a class="footnote-reference brackets" href="#id21" id="id9">9</a> que éste almacena. En consecuencia, si
exportamos las claves de una billetera de aplicación y creamos una billetera en
papel, ambas billeteras, en realidad, son la misma billetera y, de hecho, nos
podría servir como copia de seguridad por si olvidamos las claves de la
aplicación que descifran la clave o perdemos el sistema en el que corría dicha
aplicación. Hay, además de la copia, otra estrategia para recuperar una
billetera tras su pérdida: generar la clave privada a partir de una semilla que
podamos recordar, en vez de hacerlo de forma aleatoria. De este modo, ante la
pérdida bastará con facilitar (recordar) la semilla, para regenerar la clave.
Antes de entenderlo por completo, sin  embargo, nos conviene profundizar en las
claves.</p>
</section>
<section id="apendice-practico">
<h2><span class="section-number">9.1.3.7.6. </span>Apéndice práctico<a class="headerlink" href="#apendice-practico" title="Enlazar permanentemente con este título">¶</a></h2>
<section id="obtencion-de-claves">
<span id="prac-claves"></span><h3><span class="section-number">9.1.3.7.6.1. </span>Obtención de claves<a class="headerlink" href="#obtencion-de-claves" title="Enlazar permanentemente con este título">¶</a></h3>
<p>El propósito de este apartado es echarle un vistazo a cómo son las claves
criptográficas y, a efectos puramente ilustrativos ver cómo se generan partiendo
de una herramienta que ya conocermos: <a class="reference internal" href="../02.algo.html#openssl"><span class="std std-ref">openssl</span></a>. Las claves de
otras criptomonedas pueden diferir en los detalles, pero conceptualmente son
iguales.</p>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>El apartado tiene un interés práctico muy reducido, por cuanto las
aplicaciones cliente para <em>Bitcoin</em> como <a class="reference external" href="https://electrum.org">Electrum</a> permiten generar claves
(incluso claves a partir de una semilla). Sin embargo, es probable que
obtenerlas a mano, nos ayude a conocerlas mejor.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>También podemos generar muchos de los formatos aquí expuestos, usando
la web <a class="reference external" href="https://www.bitaddress.org">bitaddress.org</a>. Haremos referencia a ella a lo largo del texto.</p>
</div>
<p>Antes de empezar, haremos dos definiciones que usaremos mucho:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">alias</span> <span class="nv">bin2hex</span><span class="o">=</span><span class="s2">&quot;xxd -p -c 65&quot;</span>
<span class="nb">alias</span> <span class="nv">hex2bin</span><span class="o">=</span><span class="s2">&quot;xxd -p -r&quot;</span>
<span class="nb">alias</span> <span class="nv">sha256</span><span class="o">=</span><span class="s2">&quot;openssl dgst -sha256 | awk -v ORS= &#39;{print \$2}&#39;&quot;</span>
<span class="nb">alias</span> <span class="nv">rmd160</span><span class="o">=</span><span class="s2">&quot;openssl dgst -rmd160 -provider legacy | awk -v ORS= &#39;{print \$2}&#39;&quot;</span>
</pre></div>
</div>
<p>La primera definición permite trascribir bytes en su codificación hexadecimal
(según la <a class="reference internal" href="../../../guias/01.som/01.si/04.datos/01.repr.html#ascii"><span class="std std-ref">tabla ASCII extendida</span></a>) y la segunda justamente realiza
el proceso contrario. Las otras dos definiciones permiten calcular resúmenes
criptográficos: la primera un <abbr title="Sechure Hash Algorithm">SHA</abbr>256 y la segunda un <abbr title="RACE Integrity Primitives Evaluation Message Digest">RIPEMD</abbr>-160.</p>
<p>Una clave privada de bitcoin es una clave de 256 <em>bits</em> generada con la curva
eclíptica «secp256k1», así que para generar a mano una basta con:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>openssl ecparam -genkey -name secp256k1 -noout &gt; key.pem
<span class="gp">$ </span>cat key.pem
<span class="go">-----BEGIN EC PRIVATE KEY-----</span>
<span class="go">MHQCAQEEIOHXAYuXWlfjGiHVcyb17cjGgRDwPo1MX2CdmVIj1YiVoAcGBSuBBAAK</span>
<span class="go">oUQDQgAE4AIVQf2ZIYd1RLFPrD2yM1+z1SYV44WsiSVzVCvwu6A2x3E1oOvHNsEG</span>
<span class="go">jaMp4R/94/6lpo6tP14MOCMLOmazdQ==</span>
<span class="go">-----END EC PRIVATE KEY-----</span>
</pre></div>
</div>
<p>Este archivo <code class="file docutils literal notranslate"><span class="pre">key.pem</span></code> contiene la clave de 265 <em>bits</em>, pero también
información adicional para poder interpretarla como cuál es la curva elíptica
con la que se generó. Sin embargo, si todas las claves para <em>Bitcoin</em> se generan
del mismo modo, ¿por qué no prescindir de la información adicional y expresar
estrictamente los 256 bytes de la clave? Así pues, expresamos la clave en su
formato binario <abbr title="Abrtract Syntax Notation One">ASN.1</abbr> y recortamos los bytes que anteceden y suceden a la
clave:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>openssl ec -in key.pem -outform DER <span class="p">|</span> tail -c+8 <span class="p">|</span> head -c32 <span class="p">|</span> bin2hex
<span class="go">51920d4b6f072f3396e308687e05b98150e7beae84585cb61f125aeadff2b570</span>
</pre></div>
</div>
<p>Esos 64 dígitos hexadecimales representan exactamente los 32 <em>bytes</em> (256
<em>bits</em>) que componen la clave privada y esta es una de las representaciones (la
hexadecimal) en la que podemos ver escrita la clave privada, aunque no es la más
frecuente. Y es aquí donde debemos hacer un inciso antes de continuar la
exposición. Justamente 256 <em>bits</em> son la longitud de un <a class="reference internal" href="../02.algo.html#hash"><span class="std std-ref">resumen
critográfico</span></a> hecho con <abbr title="Sechure Hash Algorithm">SHA</abbr>-256, así que una alternativa a generar
aleatoriamente la clave con <strong class="command">openssl</strong> es escoger una relación de
palabras lo suficientemente larga (<strong>semilla</strong>), generar su resumen <abbr title="Sechure Hash Algorithm">SHA</abbr>-256
y tomar la secuencia de 32 <em>bytes</em> resultantes como la clave:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span><span class="nv">key</span><span class="o">=</span><span class="k">$(</span><span class="nb">printf</span> <span class="s2">&quot;Pablito clavó un clavito&quot;</span> <span class="p">|</span> sha256<span class="k">)</span>
<span class="gp">$ </span><span class="nb">echo</span> <span class="s2">&quot;</span><span class="nv">$key</span><span class="s2">&quot;</span>
<span class="go">146bf21792fbf84d6bd9f703459b3f505bb38cf071ba1ce3ceacff91286e5eb9</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>Alternativamente, en la sección «Brain Wallet» de <a class="reference external" href="https://www.bitaddress.org">bitaddress.org</a>,
podemos generar la clave a partir de la semilla. Nos mostrará el formato
<abbr title="Wallet Information Format">WIF</abbr>, pero trasladándolo a la sección «Wallet Details» podremos obtener
otros. Esta sección es algo árida, pero sirve para ilustrar cómo las claves
criptográficas hasta ahora vistas (y que hemos ido generando con
<a class="reference internal" href="../02.algo.html#openssl"><span class="std std-ref">openssl</span></a>) son las que sustentan también la <em>blockchain</em>,
aunque la forma de mostrarlos difiera del formato <abbr title="Private Enhaced Mail">PEM</abbr>.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>En realidad, esta sencilla estrategia para obtener una clave a partir
de una semilla, no es la que se usa. El método estándar (que soportan muchas
billeteras <em>hardware</em>)  es más complejo (el <abbr title="Bitcoin Improvement Proposal">BIP</abbr>-39) y se basa en escoger
como semilla un número de palabras contenidas en un diccionario. La
explicación de este método puede hallarse en el artículo <a class="reference external" href="https://privacypros.io/wallets/mnemonic-phrase">Understanding BIP39
and Your Mnemonic Phrase</a>.</p>
</div>
<p>Ahora bien, tenemos estrictamente los 32 <em>bytes</em> y para obtener la clave pública
más adelante, necesitaremos obtener el archivo completo con la clave. Esto no es difícil,
porque al generarse siempre con el mismo algoritmo las claves pàra <em>Bitcoin</em>,
los <em>bytes</em> que codifican la metainformación son siempre los mismos. Por ello,
la clave puede obtenerse así:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span><span class="nb">printf</span> <span class="s2">&quot;%s%s%s&quot;</span> <span class="s2">&quot;302e0201010420&quot;</span> <span class="s2">&quot;</span><span class="nv">$key</span><span class="s2">&quot;</span> <span class="s2">&quot;a00706052b8104000a&quot;</span> <span class="p">|</span> hex2bin <span class="p">|</span> openssl ec -inform DER <span class="p">|</span> tee key.pem
<span class="go">read EC key</span>
<span class="go">writing EC key</span>
<span class="go">-----BEGIN EC PRIVATE KEY-----</span>
<span class="go">MHQCAQEEIBRr8heS+/hNa9n3A0WbP1Bbs4zwcboc486s/5Eobl65oAcGBSuBBAAK</span>
<span class="go">oUQDQgAEBhH21ypZ1+kxclZ+VCKNCa+jrwyj5oXg1poHlbNhSld/lIhzM5sPGAD5</span>
<span class="go">NrCYJjNXvwGcFzrkwsl/nQ2cqVOGrw==</span>
<span class="go">-----END EC PRIVATE KEY-----</span>
</pre></div>
</div>
<p>Con lo que tendremos en <code class="file docutils literal notranslate"><span class="pre">key.pem</span></code> la clave privada originada por la
<strong>semilla</strong> «<em>Pablito clavó un clavito</em>»<a class="footnote-reference brackets" href="#id22" id="id10">10</a>. Si la perdiéramos, nos sería muy
fácil regenerarla con sólo recordarla y seguir los pasos. Tomemos esta clave, en
vez de la anterior y prosigamos porque aún no hemos acabado, ya que las claves
criptográficos suelen facilitarse del siguiente modo:</p>
<ul class="simple">
<li><p>La <strong>clave privada</strong> en formato <abbr title="Wallet Information Format">WIF</abbr>, esto es, en una codificación
<a class="reference external" href="https://crypto.bi/base58/">Base58</a>, que es semejante a <a class="reference external" href="https://es.wikipedia.org/wiki/Base64">Base64</a>, pero elimina caracteres no
alfanuméricos (p.e. el signo «+») y caracteres que pueden confundirse entre sí
(p.e. el cero y la o mayúscula, o la «i» y la «l» minúsculas).</p></li>
<li><p>Más que la <strong>clave pública</strong> (que aún no hemos calculado siquiera), lo que se
facilita es una <strong>dirección pública</strong> basada en ésta.</p></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Advertencia</p>
<p>Necesitará codificar en Base58. <em>Debian</em> tiene un paquete para ello
(<a class="reference external" href="https://packages.debian.org/stable/base58">base58</a>).</p>
</div>
<p>El formato <abbr title="Wallet Information Format">WIF</abbr> para la clave privada se forma añadiendo a la clave privada
parte de un <em>hash</em> calculado a partir de ella, lo cual añade redundacia a la
expresión y permite detectar errores de transcripción. Se añade también un
prefijo que permite distinguir las claves de un cliente de las claves de un
nodo:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span><span class="nv">prefijo</span><span class="o">=</span><span class="s2">&quot;80&quot;</span>  <span class="c1"># Para la mainnet, &quot;EF&quot; para la testnet</span>
<span class="gp">$ </span><span class="nv">hash</span><span class="o">=</span><span class="s2">&quot;</span><span class="k">$(</span><span class="nb">printf</span> <span class="s2">&quot;</span><span class="nv">$prefijo$key</span><span class="s2">&quot;</span> <span class="p">|</span> hex2bin <span class="p">|</span> sha256 <span class="p">|</span> hex2bin <span class="p">|</span> sha256<span class="k">)</span><span class="s2">&quot;</span>
<span class="gp">$ </span><span class="nb">echo</span> <span class="nv">$hash</span>
<span class="go">4e364fcbb321fdec011ba6332a6080fa9d4d86d50ec35749fe49ece30801d5ad</span>
</pre></div>
</div>
<p>El <em>hash</em> se calcula haciendo el resumen del resumen siempre usando en ambos
casos <abbr title="Sechure Hash Algorithm">SHA</abbr>-256. Sin embargo, de este <em>hash</em> sólo se añaden los cuatro
primeros <em>bytes</em>, así que la clave privada en formato <abbr title="Wallet Information Format">WIF</abbr> se acaba calculando
así:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span><span class="nv">sufijo</span><span class="o">=</span><span class="k">$(</span><span class="nb">printf</span> <span class="s2">&quot;</span><span class="nv">$hash</span><span class="s2">&quot;</span> <span class="p">|</span> head -c8<span class="k">)</span>
<span class="gp">$ </span><span class="nb">printf</span> <span class="s2">&quot;%s%s%s&quot;</span> <span class="s2">&quot;</span><span class="nv">$prefijo</span><span class="s2">&quot;</span> <span class="s2">&quot;</span><span class="nv">$key</span><span class="s2">&quot;</span> <span class="s2">&quot;</span><span class="nv">$sufijo</span><span class="s2">&quot;</span> <span class="p">|</span> hex2bin <span class="p">|</span> base58
<span class="hll"><span class="go">5HyHE2kn2wx26ShQQGKyaNWzoUXJEvFSUKqWHXF7TgQJKeMwqY</span>
</span></pre></div>
</div>
<p>Esa, pues, sería la clave privada expresada en formato <abbr title="Wallet Information Format">WIF</abbr>. También existe el
formato <abbr title="Wallet Information Format Compressed">WIFC</abbr> que se calcula exactamente igual. pero añadiendo el caracter «01»
justamente después de la clave hexadecimal<a class="footnote-reference brackets" href="#id23" id="id11">11</a>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span><span class="nv">hash</span><span class="o">=</span><span class="s2">&quot;</span><span class="k">$(</span><span class="nb">printf</span> <span class="s2">&quot;</span><span class="nv">$prefijo</span><span class="si">${</span><span class="nv">key</span><span class="si">}</span><span class="s2">01&quot;</span> <span class="p">|</span> hex2bin <span class="p">|</span> sha256 <span class="p">|</span> hex2bin <span class="p">|</span> sha256<span class="k">)</span><span class="s2">&quot;</span>
<span class="gp">$ </span><span class="nv">sufijo</span><span class="o">=</span><span class="k">$(</span><span class="nb">printf</span> <span class="s2">&quot;</span><span class="nv">$hash</span><span class="s2">&quot;</span> <span class="p">|</span> head -c8<span class="k">)</span>
<span class="gp">$ </span><span class="nb">printf</span> <span class="s2">&quot;%s%s01%s&quot;</span> <span class="s2">&quot;</span><span class="nv">$prefijo</span><span class="s2">&quot;</span> <span class="s2">&quot;</span><span class="nv">$key</span><span class="s2">&quot;</span> <span class="s2">&quot;</span><span class="nv">$sufijo</span><span class="s2">&quot;</span> <span class="p">|</span> hex2bin <span class="p">|</span> base58
<span class="hll"><span class="go">KwuQcWkDmbXqq2RLHgekiHyQ88Uj6S2jRc96FvVHWkuqT9Ef7j72</span>
</span></pre></div>
</div>
<p>Pasemos ahora a calcular la <em>clave pública</em> en formato hexadecimal, de la que
hay también versión comprimida:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span><span class="nv">pubkey</span><span class="o">=</span><span class="k">$(</span>openssl ec -in key.pem -pubout -outform DER <span class="p">|</span> tail -c65 <span class="p">|</span> bin2hex<span class="k">)</span>
<span class="gp">$ </span><span class="nb">echo</span> <span class="nv">$pubkey</span>
<span class="go">040611f6d72a59d7e93172567e54228d09afa3af0ca3e685e0d69a0795b3614a577f948873339b0f1800f936b098263357bf019c173ae4c2c97f9d0d9ca95386af</span>
<span class="gp">$ </span><span class="nv">pubkeyc</span><span class="o">=</span><span class="k">$(</span>openssl ec -in key.pem -pubout -outform DER -conv_form compressed <span class="p">|</span> tail -c33 <span class="p">|</span> bin2hex<span class="k">)</span>
<span class="gp">$ </span><span class="nb">echo</span> <span class="nv">$pubkeyc</span>
<span class="go">030611f6d72a59d7e93172567e54228d09afa3af0ca3e685e0d69a0795b3614a57</span>
</pre></div>
</div>
<p>Pero lo realmente interesante es obtener la dirección de <em>bitcoin</em> (la normal y
la comprimida). La primera es:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span><span class="nv">prefijo</span><span class="o">=</span><span class="s2">&quot;00&quot;</span>  <span class="c1"># Para la mainnet, &quot;6F&quot; para la testnet.</span>
<span class="gp">$ </span><span class="nv">hash</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$prefijo</span><span class="k">$(</span><span class="nb">printf</span> <span class="s2">&quot;%s&quot;</span> <span class="s2">&quot;</span><span class="nv">$pubkey</span><span class="s2">&quot;</span> <span class="p">|</span> hex2bin <span class="p">|</span> sha256 <span class="p">|</span> hex2bin <span class="p">|</span> rmd160<span class="k">)</span><span class="s2">&quot;</span>
<span class="gp">$ </span><span class="nv">sufijo</span><span class="o">=</span><span class="s2">&quot;</span><span class="k">$(</span><span class="nb">printf</span> <span class="s2">&quot;</span><span class="nv">$hash</span><span class="s2">&quot;</span> <span class="p">|</span> hex2bin <span class="p">|</span> sha256 <span class="p">|</span> hex2bin <span class="p">|</span> sha256 <span class="p">|</span> head -c8<span class="k">)</span><span class="s2">&quot;</span>
<span class="gp">$ </span><span class="nb">printf</span> <span class="s2">&quot;%s%s&quot;</span> <span class="s2">&quot;</span><span class="nv">$hash</span><span class="s2">&quot;</span> <span class="s2">&quot;</span><span class="nv">$sufijo</span><span class="s2">&quot;</span> <span class="p">|</span> hex2bin <span class="p">|</span> base58
<span class="hll"><span class="go">1BoMhf1btEwwsHcvzxQiiRJowxwLxyz6kp</span>
</span></pre></div>
</div>
<p>Y para la segunda hay que hacer exactamente lo mismo con la versión comprimida:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span><span class="nv">hash</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$prefijo</span><span class="k">$(</span><span class="nb">printf</span> <span class="s2">&quot;%s&quot;</span> <span class="s2">&quot;</span><span class="nv">$pubkeyc</span><span class="s2">&quot;</span> <span class="p">|</span> hex2bin <span class="p">|</span> sha256 <span class="p">|</span> hex2bin <span class="p">|</span> rmd160<span class="k">)</span><span class="s2">&quot;</span>
<span class="gp">$ </span><span class="nv">sufijo</span><span class="o">=</span><span class="s2">&quot;</span><span class="k">$(</span><span class="nb">printf</span> <span class="s2">&quot;</span><span class="nv">$hash</span><span class="s2">&quot;</span> <span class="p">|</span> hex2bin <span class="p">|</span> sha256 <span class="p">|</span> hex2bin <span class="p">|</span> sha256 <span class="p">|</span> head -c8<span class="k">)</span><span class="s2">&quot;</span>
<span class="gp">$ </span><span class="nb">printf</span> <span class="s2">&quot;%s%s&quot;</span> <span class="s2">&quot;</span><span class="nv">$hash</span><span class="s2">&quot;</span> <span class="s2">&quot;</span><span class="nv">$sufijo</span><span class="s2">&quot;</span> <span class="p">|</span> hex2bin <span class="p">|</span> base58
<span class="hll"><span class="go">1PSAfVwy7qDX7htzNKTYJ9cjn1oZr8jzoT</span>
</span></pre></div>
</div>
</section>
<section id="operando-con-la-blockchain-de-bitcoin">
<h3><span class="section-number">9.1.3.7.6.2. </span>Operando con la <em>blockchain</em> de <em>Bitcoin</em><a class="headerlink" href="#operando-con-la-blockchain-de-bitcoin" title="Enlazar permanentemente con este título">¶</a></h3>
<div class="admonition-todo admonition" id="id12">
<p class="admonition-title">Por hacer</p>
<p>Sería interesante practicar la operativa con <em>Bitcoin</em> creando una
<em>blockchain</em> privada o conectándose a la <em>Testnet</em>. Como punto de partida
puede utilizarse <a class="reference external" href="https://academy.bit2me.com/testnet-red-pruebas-bitcoin/">este artículo de bit2me.com</a>.</p>
</div>
<p class="rubric">Notas al pie</p>
<dl class="footnote brackets">
<dt class="label" id="id13"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p>Las claves son <abbr title="Elliptic Curve Digital Signature Algorithm">ECDSA</abbr> y no <abbr title="Rivest, Shamir y Adleman">RSA</abbr>, porque son más eficientes. En teoría,
las claves <abbr title="Rivest, Shamir y Adleman">RSA</abbr> también servirían para este propósito.</p>
</dd>
<dt class="label" id="id14"><span class="brackets"><a class="fn-backref" href="#id2">2</a></span></dt>
<dd><p>En la realidad, la transacción será un poco más complicada, porque no
hemos tenido en cuenta las comisiones. Es posible que también se genere
una <abbr title="Unspent Transaction Output">UTXO</abbr> para recompensar al minero y a la <a class="reference internal" href="#crypto-exchanges"><span class="std std-ref">casa de cambios</span></a>.</p>
</dd>
<dt class="label" id="id15"><span class="brackets"><a class="fn-backref" href="#id3">3</a></span></dt>
<dd><p>La primera trasacción de bitcoins se hizo el 12 de enero de 2009 entre
<a class="reference external" href="https://academy.bit2me.com/quien-es-hal-finney/">Hal Finney</a> y Satoshi
Nakamoto. Conocemos quién es (fue) Hal, pero aún sigue siendo un misterio
quién es en realidad Satoshi. Ni siquiera está claro que sea una persona.</p>
</dd>
<dt class="label" id="id16"><span class="brackets"><a class="fn-backref" href="#id4">4</a></span></dt>
<dd><p>Este es el conocido como <a class="reference external" href="https://es.wikipedia.org/wiki/Problema_de_los_generales_bizantinos">problema de los generales bizantinos</a>.</p>
</dd>
<dt class="label" id="id17"><span class="brackets"><a class="fn-backref" href="#id5">5</a></span></dt>
<dd><p>En realidad, ya no minan, así que no son mineros.</p>
</dd>
<dt class="label" id="id18"><span class="brackets"><a class="fn-backref" href="#id6">6</a></span></dt>
<dd><p>Y, por lo que parece, los <a class="reference external" href="https://twitter.com/koeppelmann/status/1570436882483523585">temores de centralización se han cumplido</a>.</p>
</dd>
<dt class="label" id="id19"><span class="brackets"><a class="fn-backref" href="#id7">7</a></span></dt>
<dd><p>Supuesto, claro está, que los nodos que constituyen la red de la
<em>blockchain</em> sean muchos y no estén monopolizados por nadie.</p>
</dd>
<dt class="label" id="id20"><span class="brackets"><a class="fn-backref" href="#id8">8</a></span></dt>
<dd><p>Véase <a class="reference external" href="https://www.dpoitlaw.com/aspectos-juridicos-a-tener-en-cuenta-en-la-emision-de-criptoactivos-por-la-empresa-utility-token-vs-security-token/">este artículo de dpoitlaw.com</a>.
Además, en breve se aprobará una <a class="reference external" href="https://elderecho.com/reforma-ley-mercado-valores">reforma de la Ley de los Mercados de
Valores</a>.</p>
</dd>
<dt class="label" id="id21"><span class="brackets"><a class="fn-backref" href="#id9">9</a></span></dt>
<dd><p>A estas alturas ya debemos saber que la clave pública se obtiene a partir
de la clave privada.</p>
</dd>
<dt class="label" id="id22"><span class="brackets"><a class="fn-backref" href="#id10">10</a></span></dt>
<dd><p>Evidentemente, la secuencia de palabras debe ser lo suficientemente
extravagante. La escogida no es que digamos la mejor opción.</p>
</dd>
<dt class="label" id="id23"><span class="brackets"><a class="fn-backref" href="#id11">11</a></span></dt>
<dd><p>Obviamente, si se añade un carácter más, la clave será un <em>byte</em> más
larga, aunque paradójicamente la «C» signifique comprimida.</p>
</dd>
</dl>
</section>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../../../index.html">Tabla de contenido</a></h3>
    <ul>
<li><a class="reference internal" href="#">9.1.3.7. Cadenas de bloques</a><ul>
<li><a class="reference internal" href="#proposito">9.1.3.7.1. Propósito</a></li>
<li><a class="reference internal" href="#descripcion">9.1.3.7.2. Descripción</a></li>
<li><a class="reference internal" href="#smart-contracts">9.1.3.7.3. <em>Smart contracts</em></a></li>
<li><a class="reference internal" href="#casas-de-cambio-exchanges">9.1.3.7.4. Casas de cambio (exchanges)</a></li>
<li><a class="reference internal" href="#billeteras">9.1.3.7.5. Billeteras</a></li>
<li><a class="reference internal" href="#apendice-practico">9.1.3.7.6. Apéndice práctico</a><ul>
<li><a class="reference internal" href="#obtencion-de-claves">9.1.3.7.6.1. Obtención de claves</a></li>
<li><a class="reference internal" href="#operando-con-la-blockchain-de-bitcoin">9.1.3.7.6.2. Operando con la <em>blockchain</em> de <em>Bitcoin</em></a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Tema anterior</h4>
    <p class="topless"><a href="06.discos.html"
                          title="capítulo anterior"><span class="section-number">9.1.3.6. </span>Cifrado de discos</a></p>
  </div>
  <div>
    <h4>Próximo tema</h4>
    <p class="topless"><a href="../../05.virtual/index.html"
                          title="próximo capítulo"><span class="section-number">9.2. </span>Virtualización</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>Esta página</h3>
    <ul class="this-page-menu">
      <li><a href="../../../_sources/98.apendice/01.cryto/03.aplicaciones/07.blockchain.rst.txt"
            rel="nofollow">Mostrar el código</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Búsqueda rápida</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Ir a" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navegación</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="Índice General"
             >índice</a></li>
        <li class="right" >
          <a href="../../05.virtual/index.html" title="9.2. Virtualización"
             >siguiente</a> |</li>
        <li class="right" >
          <a href="06.discos.html" title="9.1.3.6. Cifrado de discos"
             >anterior</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">documentación de Linuxnomicón - rolling</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" ><span class="section-number">9. </span>Apéndices</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../index.html" ><span class="section-number">9.1. </span>Criptografía</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../03.aplicaciones.html" ><span class="section-number">9.1.3. </span>Aplicaciones de la criptografía</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><span class="section-number">9.1.3.7. </span>Cadenas de bloques</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Derechos de autor CC BY 4.0, 2016-2022, José Miguel Sánchez Alés.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.5.0.
    </div>
  </body>
</html>