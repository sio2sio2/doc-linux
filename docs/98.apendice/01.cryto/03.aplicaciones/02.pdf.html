


<!DOCTYPE html>

<html lang="es">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>9.1.3.2. Firma de documentos &#8212; documentación de Linuxnomicón - rolling</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/classic.css" />
    <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
    
    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/translations.js"></script>
    
    <link rel="index" title="Índice" href="../../../genindex.html" />
    <link rel="search" title="Búsqueda" href="../../../search.html" />
    <link rel="next" title="9.1.3.3. Correo electrónico" href="03.correo.html" />
    <link rel="prev" title="9.1.3.1. Certificado digital" href="01.certdig.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navegación</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="Índice General"
             accesskey="I">índice</a></li>
        <li class="right" >
          <a href="03.correo.html" title="9.1.3.3. Correo electrónico"
             accesskey="N">siguiente</a> |</li>
        <li class="right" >
          <a href="01.certdig.html" title="9.1.3.1. Certificado digital"
             accesskey="P">anterior</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">documentación de Linuxnomicón - rolling</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" ><span class="section-number">9. </span>Apéndices</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../index.html" ><span class="section-number">9.1. </span>Criptografía</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../03.aplicaciones.html" accesskey="U"><span class="section-number">9.1.3. </span>Aplicaciones de la criptografía</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><span class="section-number">9.1.3.2. </span>Firma de documentos</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <span class="target" id="firm-doc"></span><section id="firma-de-documentos">
<h1><span class="section-number">9.1.3.2. </span>Firma de documentos<a class="headerlink" href="#firma-de-documentos" title="Enlazar permanentemente con este título">¶</a></h1>
<p>Según <a class="reference internal" href="../02.algo.html#firma-digital"><span class="std std-ref">se presentó en un principio</span></a>, puede firmarse
cualquier archivo o flujo de datos y a resultas de ello se obtendrá un archivo
independiente de firma que contiene el resumen cifrado junto a metainformación
sobre el proceso. Es lo que se llama <a class="reference external" href="https://en.wikipedia.org/wiki/Detached_signature">firma independiente</a>. Sobre ello no hay mucho
más que añadir.</p>
<p>Sin embargo, el formato <abbr title="Portable Dcument Format">PDF</abbr> permite integrar en un objeto interno la firma
dentro del propio documento, razón por la cual –junto a la de ser independiente
su aspecto de la plataforma– se utiliza para la formalización digital de
contratos, solicitudes, promulgación de leyes, etc. que requieren validez legal.</p>
<p>Este proceso de firma:</p>
<ul class="simple">
<li><p>utiliza <a class="reference internal" href="01.certdig.html#cert-digital"><span class="std std-ref">certificados digitales X.509</span></a>.</p></li>
<li><p>calcula el <a class="reference internal" href="../02.algo.html#hash"><span class="std std-ref">resumen</span></a> de todo el documento, excepto del contenido
de la propia firma<a class="footnote-reference brackets" href="#id6" id="id1">1</a>.</p></li>
<li><p>permite adjuntar sucesivamente distintas firmas. Tenga presente, no obstante,
que una de las firmas, no incluiría en su resumen los añadidos que suponen las
que se hayan hecho después. Consecuentemente, el orden en que se firme es
importante si los firmantes tienen distinta jerarquía: lo lógico, pues, es que
firme primero el que tenga menos jerarquía, después el supervisor del primer
firmante y así sucesivamente.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>Aunque opcionalmente pueden generarse marcas visibles en el documento
que denoten quién ha firmado y cuándo lo ha hecho, la verdadera firma digital
no deha huella visible en una impresión: se verifica utilizando una
herramienta de verificación sobre el archivo.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">Ver también</p>
<p>Para conocer con mayor profundidad cómo se almacenan las firmas
dentro de un <abbr title="Portable Dcument Format">PDF</abbr> puede leer <a class="reference external" href="https://itextpdf.com/en/resources/books/digital-signatures-pdf">el extenso libro blanco sobre firmas
digitales</a>
de Bruno Lowagie.</p>
</div>
<section id="estatus-legal">
<span id="firma-legal"></span><h2><span class="section-number">9.1.3.2.1. </span>Estatus legal<a class="headerlink" href="#estatus-legal" title="Enlazar permanentemente con este título">¶</a></h2>
<p>La validez legal de la firma digital está desarrollada en España a través de la
<a class="reference external" href="https://www.boe.es/eli/es/l/2020/11/11/6/con">Ley 6/2020</a>, de 11 de noviembre, <em>reguladora de determinados aspectos de los
servicios electrónicos de confianza</em>, y  el <a class="reference external" href="https://www.boe.es/buscar/doc.php?id=DOUE-L-2014-81822">Reglamento eIDAS</a> (<em>Reglamento
910/2014</em>, conocidos por sus siglas en ingles <abbr title="Electronic IDentification, Authentication and trust Services">eIDAS</abbr>). La normativa establece
dos tipos de <em>prestadores de servicios de confianza</em> (esto es, de <abbr title="Certification Authority">CA</abbr>):</p>
<ul class="simple">
<li><p><em class="dfn">Prestadores cualificados</em>, que son aquellos reconocidos como tales por
un organismo supervisor<a class="footnote-reference brackets" href="#id7" id="id2">2</a>. Las obligaciones a los que están sujetos se
encuentran enumeradas en el artículo <strong>9</strong> de la <a class="reference external" href="https://www.boe.es/eli/es/l/2020/11/11/6/con">Ley 6/2020</a>.</p></li>
<li><p><em class="dfn">Prestadores no cualificados</em>, que son aquellos que no gozan de este
reconocimiento, aunque se encuentran inscritos para el ejercicio de su
actividad.</p></li>
</ul>
<p>Esta distinción origina que haya <em class="dfn">certificados digitales cualificados</em> y
<em class="dfn">certificados digitales no cualificados</em> y, consecuentemente, una
<em class="dfn">firma electrónica cualificada</em> y una <em class="dfn">firma electrónica no
cualificada</em>. La diferencia legal entre una y otra firma es que la primera tiene
los mismos efectos juridicos que la firma manuscrita, mientras que la segunda
no, aunque puede ser admitida en un juicio<a class="footnote-reference brackets" href="#id8" id="id3">3</a>.</p>
<p>El Ministerio publica en su web la <a class="reference external" href="https://avancedigital.mineco.gob.es/es-es/Servicios/FirmaElectronica/Paginas/Prestadores.aspx">lista de prestadores cualificados y no
cualificados de confianza</a>.
Como todos los países de la Unión tiene la obligación de remitir estas listas
también es posible la <a class="reference external" href="https://digital-strategy.ec.europa.eu/en/policies/eu-trusted-lists">consulta de todos los prestadores europeos</a>.</p>
</section>
<section id="apendice-practico">
<span id="pdfsig"></span><h2><span class="section-number">9.1.3.2.2. </span>Apéndice práctico<a class="headerlink" href="#apendice-practico" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Hay varias aplicaciones en Linux que permiten la firma y verificación de firmas
de documentos <abbr title="Portable Dcument Format">PDF</abbr>:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://www.libreoffice.org">LibreOffice</a> (dentro del menú «Archivo»).</p></li>
<li><p><a class="reference external" href="https://mupdf.com">MuPDF</a><a class="footnote-reference brackets" href="#id9" id="id4">4</a>.</p></li>
<li><p><a class="reference external" href="https://poppler.freedesktop.org">Poppler</a> y todas las aplicaciones que lo tomen como base (<a class="reference external" href="https://www.xpdfreader.com">Xpdf</a>, <a class="reference external" href="https://wiki.gnome.org/Apps/Evince">Evince</a>)<a class="footnote-reference brackets" href="#id10" id="id5">5</a>.</p></li>
<li><p>Las proporcionadas por el Gobierno de España:</p>
<ul>
<li><p><a class="reference external" href="https://firmaelectronica.gob.es/Home/Descargas.html">Autofirma</a>, escrita en <em>Java</em>,
para la firma.</p></li>
<li><p>La página <a class="reference external" href="https://valide.redsara.es/">Valide</a>, para validación  de
documentos firmados con certificados expedidos por algunas <abbr title="Certification Authority">CA</abbr> reconocidas
por el <a class="reference external" href="https://mincotur.gob.es">Ministerio de Industria, Comercio y Turismo</a>. Esta página también ofrece la opción de firmar,
pero lo hace, en realidad, recurriendo a un <a class="reference external" href="https://firmaelectronica.gob.es/Home/Descargas.html">Autofirma</a> que haya instalado
en el sistema.</p></li>
</ul>
</li>
</ul>
<p>Nos centraremos en este apéndice práctico en el uso por línea de órdenes de
<em class="manpage"><a class="manpage reference external" href="https://manpages.debian.org/pdfsign">pdfsign</a></em>, una orden incluida dentro del paquete <a class="reference external" href="https://packages.debian.org/stable/poppler-utils">poppler-utils</a>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp"># </span>apt install poppler-utils
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>El uso de las citadas utilidades del Gobierno no entraña mucha
dificultad:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://firmaelectronica.gob.es/Home/Descargas.html">Autofirma</a> se distribuye como un archivo <kbd class="kbd docutils literal notranslate">.zip</kbd> que, entre otros,
contiene un <a class="reference internal" href="../../../02.conbas/09.admbasica/08.paqueteria.html#paquetes-deb"><span class="std std-ref">paquete deb</span></a>. La instalación de este
paquete asegura que se satisfagan las dependencias (p.e. el intérprete de
<em>Java</em>) y se asocie a la aplicación el tipo <abbr title="Multipurpose Internet Mail Extensions">MIME</abbr>
<code class="docutils literal notranslate"><span class="pre">x-scheme-handler/afirma</span></code> que permite soportar el protocolo <code class="docutils literal notranslate"><span class="pre">afirma://</span></code>
que usan las páginas oficiales cuando requieren firmar un documento.</p></li>
<li><p>La <abbr title="Fábrica Nacional de Moneda y Timebre">FNMT</abbr>, que emite gratuitamente certificados personales, usa otra
aplicación más, <a class="reference external" href="https://www.sede.fnmt.gob.es/descargas/descarga-software/instalacion-software-generacion-de-claves">Configurador FNMT-RCM</a>,
exclusivamente para el proceso de generación de certificados. Esta es la
aplicación que se encarga de generar las claves, solicitar el certificado
y, finalmente, recibirlo. También para ella hay un paquete <em>deb</em> que se
encargará de satisfacer las dependencias y asociar el tipo <abbr title="Multipurpose Internet Mail Extensions">MIME</abbr>
<code class="docutils literal notranslate"><span class="pre">x-scheme-handler/fnmtcr</span></code> que permite soportar el protocolo
<code class="docutils literal notranslate"><span class="pre">fnmtcr://</span></code>.</p></li>
</ul>
<p>Por tanto, una vez que haga la instalación de ambas aplicaciones, cerciórese
de que el sistema es capaz de soportar los dos protocolos referidos:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>xdg-mime query default x-scheme-handler/fnmtcr
<span class="go">configuradorfnmt.desktop</span>
<span class="gp">$ </span>xdg-mime query default x-scheme-handler/afirma
<span class="go">afirma.desktop</span>
</pre></div>
</div>
<p>Para más información, consulte «<a class="reference internal" href="../../../02.conbas/99.misc/06.mimetypes.html#mimetypes"><span class="std std-ref">Aplicaciones predeterminadas</span></a>».</p>
</div>
<section id="validacion">
<h3><span class="section-number">9.1.3.2.2.1. </span>Validación<a class="headerlink" href="#validacion" title="Enlazar permanentemente con este título">¶</a></h3>
<p>La validez de la firma de un <abbr title="Portable Dcument Format">PDF</abbr> se puede hacer del siguiente modo:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>pdfsig -nocert documento.pdf
</pre></div>
</div>
<p>La orden de arriba, sin embargo, no comprobará la fiabilidad del certificado
firmante (<kbd class="kbd docutils literal notranslate">-nocert</kbd>). Para hacerlo, es necesario que el programa utilice
un catálogo de claves que disponga de toda la cadena de confianza. Este
catálogo es <a class="reference internal" href="01.certdig.html#cert-nss"><span class="std std-ref">un almacen NSS</span></a> como los que usa <a class="reference external" href="https://www.mozilla.org">Firefox</a> o
<a class="reference external" href="https://www.chromium.org">Chromium</a>. Supuesto que dispongamos de ese catálogo, entonces podremos
comprobar la firma y cerciorarnos de la fiabilidad del certificado:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>pdfsig -nssdir ~/.pki/nssdb documento.pdf
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">Ver también</p>
<p>Consulte cómo crear, consultar y mantener un <a class="reference internal" href="01.certdig.html#cert-nss"><span class="std std-ref">catálogo NSS</span></a>. En la orden de ejemplo se ha supuesto que se usa el catálogo
creado por <a class="reference external" href="https://www.chromium.org">Chromium</a>.</p>
</div>
</section>
<section id="firma">
<h3><span class="section-number">9.1.3.2.2.2. </span>Firma<a class="headerlink" href="#firma" title="Enlazar permanentemente con este título">¶</a></h3>
<div class="admonition warning">
<p class="admonition-title">Advertencia</p>
<p>Para poder firmar documentos es necesario utilizar al menos la
versión <strong>21.01</strong> de <a class="reference external" href="https://packages.debian.org/stable/poppler-utils">poppler-utils</a>, y preferentemente al menos la
<strong>21.10</strong> (o sea, al menos, <em>Bookworm</em>) que permite añadir nuevos campos de
firma.</p>
</div>
<p>Supuesto que dispongamos de un almacén <abbr title="Network Secure Services">NSS</abbr> con nuestro certificado y su cadena
de confianza:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>pdfsig -nssdir ~/.pki/nssdb -add-signature -nick <span class="s1">&#39;CADENA-EN-NSSDB-DEL-CERT&#39;</span> doc.pdf doc_firmado.pdf
</pre></div>
</div>
<p class="rubric">Notas al pie</p>
<dl class="footnote brackets">
<dt class="label" id="id6"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p>Obviamente, ya que de lo contrario el contenido de la firma dependería
del propio resumen que forma parte del contenido.</p>
</dd>
<dt class="label" id="id7"><span class="brackets"><a class="fn-backref" href="#id2">2</a></span></dt>
<dd><p>La <a class="reference external" href="https://avancedigital.mineco.gob.es/es-es/Paginas/index.aspx">Secretaria de Estado de Telecomunicaciones e
Infraestructuras Digitales</a> dependiente del <a class="reference external" href="https://portal.mineco.gob.es/es-es/Paginas/default.aspx">Ministerio de Asuntos Económicos
y Transformación Digital</a>. La variabilidad política hará que este párrafo
quede pronto obsoleto y el nombre del Ministerio y de la Secretaría de Estado
cambie de nombre y <em>dirección web</em>.</p>
</dd>
<dt class="label" id="id8"><span class="brackets"><a class="fn-backref" href="#id3">3</a></span></dt>
<dd><p>Puede hacerse una lectura del artículo <a class="reference external" href="http://e-procesal.com/dterceros-de-confianza-y-certificacion-de-prueba-electronica-una-nueva-frontera-en-materia-de-probatica-2109">Terceros de confianza y
certificación de prueba electrónica. Una nueva frontera en materia de
probática</a>.</p>
</dd>
<dt class="label" id="id9"><span class="brackets"><a class="fn-backref" href="#id4">4</a></span></dt>
<dd><p>Aunque el soporte parece deficiente y no permitir la adición de un objeto
de firma. La <a class="reference external" href="https://www.mupdf.com/docs/manual-mutool-sign.html">escasa documentación</a> no contribuye a
aclararlo.</p>
</dd>
<dt class="label" id="id10"><span class="brackets"><a class="fn-backref" href="#id5">5</a></span></dt>
<dd><p>En realidad, <strong class="program">Poppler</strong> a través de <a class="reference internal" href="#pdfsig"><span class="std std-ref">pdfsig</span></a> lo
permite, pero a fecha de redacción (abril de 2022) las aplicaciones
derivadas, no.</p>
</dd>
</dl>
</section>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../../../index.html">Tabla de contenido</a></h3>
    <ul>
<li><a class="reference internal" href="#">9.1.3.2. Firma de documentos</a><ul>
<li><a class="reference internal" href="#estatus-legal">9.1.3.2.1. Estatus legal</a></li>
<li><a class="reference internal" href="#apendice-practico">9.1.3.2.2. Apéndice práctico</a><ul>
<li><a class="reference internal" href="#validacion">9.1.3.2.2.1. Validación</a></li>
<li><a class="reference internal" href="#firma">9.1.3.2.2.2. Firma</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Tema anterior</h4>
    <p class="topless"><a href="01.certdig.html"
                          title="capítulo anterior"><span class="section-number">9.1.3.1. </span>Certificado digital</a></p>
  </div>
  <div>
    <h4>Próximo tema</h4>
    <p class="topless"><a href="03.correo.html"
                          title="próximo capítulo"><span class="section-number">9.1.3.3. </span>Correo electrónico</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>Esta página</h3>
    <ul class="this-page-menu">
      <li><a href="../../../_sources/98.apendice/01.cryto/03.aplicaciones/02.pdf.rst.txt"
            rel="nofollow">Mostrar el código</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Búsqueda rápida</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Ir a" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navegación</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="Índice General"
             >índice</a></li>
        <li class="right" >
          <a href="03.correo.html" title="9.1.3.3. Correo electrónico"
             >siguiente</a> |</li>
        <li class="right" >
          <a href="01.certdig.html" title="9.1.3.1. Certificado digital"
             >anterior</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">documentación de Linuxnomicón - rolling</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" ><span class="section-number">9. </span>Apéndices</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../index.html" ><span class="section-number">9.1. </span>Criptografía</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../03.aplicaciones.html" ><span class="section-number">9.1.3. </span>Aplicaciones de la criptografía</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><span class="section-number">9.1.3.2. </span>Firma de documentos</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Derechos de autor CC BY 4.0, 2016-2022, José Miguel Sánchez Alés.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.5.0.
    </div>
  </body>
</html>