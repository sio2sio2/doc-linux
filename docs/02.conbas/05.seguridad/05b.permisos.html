

<!DOCTYPE html>

<html lang="es" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>2.3.2. Permisos &#8212; documentación de Linuxnomicón - rolling</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/classic.css?v=2bf1fcf8" />
    <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
    
    <script src="../../_static/documentation_options.js?v=a621b78a"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/translations.js?v=f85f4cfb"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    
    <link rel="index" title="Índice" href="../../genindex.html" />
    <link rel="search" title="Búsqueda" href="../../search.html" />
    <link rel="next" title="2.4. Configuración básica" href="../06.conbas/index.html" />
    <link rel="prev" title="2.3.1. Gestión de usuarios" href="05a.usuarios.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navegación</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="Índice General"
             accesskey="I">índice</a></li>
        <li class="right" >
          <a href="../06.conbas/index.html" title="2.4. Configuración básica"
             accesskey="N">siguiente</a> |</li>
        <li class="right" >
          <a href="05a.usuarios.html" title="2.3.1. Gestión de usuarios"
             accesskey="P">anterior</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">documentación de Linuxnomicón - rolling</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" ><span class="section-number">2. </span>Conceptos básicos</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" accesskey="U"><span class="section-number">2.3. </span>Seguridad del sistema</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><span class="section-number">2.3.2. </span>Permisos</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="permisos">
<h1><span class="section-number">2.3.2. </span>Permisos<a class="headerlink" href="#permisos" title="Link to this heading">¶</a></h1>
<p>Los archivos del sistema se encuentran protegidos mediante un sistema de
permisos para impedir que usuarios o torpes o malintencionados puedan provocar
daños al sistema; y también, para proteger la privacidad frente a usuarios
indiscretos.</p>
<p>Los permisos en <em>Linux</em> implementan un <a class="reference internal" href="../../guias/0226.seg/02.entorno/02.acceso.html#control-dac"><span class="std std-ref">control de accesos DAC</span></a> y
siguen el estándar <abbr title="Portable Operating System Interface for uniX">POSIX</abbr> compuesto por dos sistemas de permisos
complementarios:</p>
<ul class="simple">
<li><p>Los <em>permisos clásicos</em> de <em>Unix</em>.</p></li>
<li><p>Las listas de control de accesos (<abbr title="Access Control List">ACL</abbr>) adicional al anterior.</p></li>
</ul>
<p>Por lo general, el primer sistema es suficiente y es al que dedicaremos el resto
del epígrafe.</p>
<div class="admonition seealso">
<p class="admonition-title">Ver también</p>
<p>Más adelante, el manual estudia también las <a class="reference internal" href="../../05.discos/02.seguridad/02.acl.html#acls"><span class="std std-ref">reglas ACL</span></a>.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>Hay otros metadatos de archivo que influyen en los permisos de usuario
como los <a class="reference internal" href="../../05.discos/04.attr/index.html#ext4-fattr"><span class="std std-ref">atributos de archivo</span></a> o los <a class="reference internal" href="../../05.discos/04.attr/index.html#xattr"><span class="std std-ref">atributos
extendidos</span></a>, pero que no trataremos aquí.</p>
</div>
<section id="sistema-ugo">
<span id="ugo"></span><h2><span class="section-number">2.3.2.1. </span>Sistema <abbr title="User-Group-Others">UGO</abbr><a class="headerlink" href="#sistema-ugo" title="Link to this heading">¶</a></h2>
<p>En el sistema clásico de permisos de <em>Unix</em> cada archivo tiene un usuario
propietario y un grupo propietario, que ya hemos visto que pueden consultarse a
través de <a class="reference internal" href="../02.informacion/03.ficheros.html#ls"><span class="std std-ref">ls</span></a> o <a class="reference internal" href="../02.informacion/03.ficheros.html#stat"><span class="std std-ref">stat</span></a>. El nombre es un acrónimo de
<strong>U</strong>suario-<strong>G</strong>rupo-<strong>Otro</strong>), porque consiste en definir los
permisos del archivo para:</p>
<ul class="simple">
<li><p>El usuario propietario.</p></li>
<li><p>El grupo propietario.</p></li>
<li><p>El resto de usuarios que ni sean el propietario ni pertenezcan al grupo
propietario.</p></li>
</ul>
<p>Para cada uno de ellos se definen tres permisos:</p>
<ul class="simple">
<li><p>El permiso de <em>lectura</em>, representado por un letra <strong>r</strong>.</p></li>
<li><p>El permiso de <em>escritura</em>, representado por una letra <strong>w</strong>.</p></li>
<li><p>El permiso de <em>ejecución</em>, representado por una letra <strong>x</strong>.</p></li>
</ul>
<p>Por todo ello, cuando inspeccionamos la salida de <strong class="command">ls</strong>, vemos lo
siguiente:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>ls<span class="w"> </span>-l<span class="w"> </span>/var/log/syslog
<span class="go">-rw-r----- 1 syslog adm 125534 oct 19 10:56 /var/log/syslog</span>
</pre></div>
</div>
<p>Tal archivo pertenece a un usuario llamado <em>syslog</em> y a un grupo llamado <em>adm</em>.
Los permisos por su parte son <code class="docutils literal notranslate"><span class="pre">rw-r-----</span></code>, o sea tres ternas de permisos.
<code class="docutils literal notranslate"><span class="pre">rw-</span></code>, <code class="docutils literal notranslate"><span class="pre">r--</span></code> y <code class="docutils literal notranslate"><span class="pre">---</span></code>. La primera terna corresponde al propietario, la
segunda al grupo propietario y la tercena al resto. Como un guión indica
ausencia del permiso y el orden en que se expresan son siempre <strong>rwx</strong>,
resulta que <em>syslog</em> tiene permisos de lectura y escritura; <em>adm</em>, sólo de
lectura; y el resto de usuarios, ninguno.</p>
<p>Además, de expresar los permisos mediante letras, pueden expresarme por medio de
un código numérico de tres números, de manera que cada cifra representa una
terna de permisos. Para calcular esta cifra se toma <strong>r</strong> como 4, la <strong>w</strong> como
2 y la <strong>x</strong> como 1. Por tanto, una terna <strong>rwx</strong> es 7 (4+2+1) o una terna
<strong>r-x</strong>, 5 (4+1).</p>
<p>Por tanto, para el caso del archivo <code class="file docutils literal notranslate"><span class="pre">/var/log/syslog</span></code> los permisos se
pueden expresar con el número <strong>640</strong>. Como <strong class="command">stat</strong> muestra los permisos
en formato numérico y alfabético, podemos comprobar que hemos hecho bien el
cálculo:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>stat<span class="w"> </span>/var/log/syslog
<span class="go">  Fichero: «/var/log/syslog»</span>
<span class="go">  Tamaño: 197721      Bloques: 392        Bloque E/S: 4096   archivo regular</span>
<span class="go">Dispositivo: 801h/2049d   Nodo-i: 1188288     Enlaces: 1</span>
<span class="go">Acceso: (0640/-rw-r-----)  Uid: (  101/  syslog)   Gid: (    4/     adm)</span>
<span class="go">Acceso: 2016-10-19 07:43:21.173102488 +0200</span>
<span class="go">Modificación: 2016-10-19 12:17:01.720998505 +0200</span>
<span class="go">      Cambio: 2016-10-19 12:17:01.720998505 +0200</span>
<span class="go">    Creación: -</span>
</pre></div>
</div>
</section>
<section id="permisos-habituales">
<span id="perm-habituales"></span><h2><span class="section-number">2.3.2.2. </span>Permisos habituales<a class="headerlink" href="#permisos-habituales" title="Link to this heading">¶</a></h2>
<p>Hemos introducido ya los permisos habituales, pero no hemos entrado a valorar
qué significan exactamente. Dependiendo de si el archivo es un archivo regular o
un directorio, el significado cambia:</p>
<dl class="simple">
<dt><strong>Fichero regular</strong></dt><dd><ul class="simple">
<li><p>Permiso de <em>lectura</em>: Implica que se tiene permiso para ver su contenido,
por tanto, podremos hacer un <a class="reference internal" href="../02.informacion/03.ficheros.html#cat"><span class="std std-ref">cat</span></a> sobre él.</p></li>
<li><p>Permiso de <em>escritura</em>: Implica la potestad de poder alterar su contenido.</p></li>
<li><p>Permiso de <em>ejecución</em>: Permite ejecutar el archivo como programa, si este,
obviamente, es un programa. Si no lo es, el permiso no tiene razón de ser.</p></li>
</ul>
</dd>
<dt><strong>Directorio</strong></dt><dd><ul class="simple">
<li><p>Permiso de <em>lectura</em>: Implica ver el contenido de un directorio, esto es,
poder comprobar que archivos y subdirectorios contiene. Por tanto, podremos
usar sobre él <strong class="command">ls</strong>.</p></li>
<li><p>Permiso de <em>escritura</em>: Implica modificar su contenido lo cual se traduce
en poder crear y borrar archivos dentro de él.</p></li>
<li><p>Permiso de <em>ejecución</em>: Permite acceder al directorio o a algún
subdirectorio descendiente suyo, ya que para acceder hay que pasar por él.</p></li>
</ul>
</dd>
</dl>
<div class="admonition warning">
<p class="admonition-title">Advertencia</p>
<p>Téngase en cuenta que la posibilidad de poder borrar un archivo no reside en
los permisos del propio archivo, sino en los permisos del directorio en el que
se encuentra. Si tenemos permisos de escritura sobre el directorio, podremos
borrar el archivo. En caso contrario, no; aun teniendo permiso de escritura
sobre el archivo. Lo más que podremos hacer en este último caso es dejarlo
vacío.</p>
</div>
</section>
<section id="permisos-especiales">
<span id="perm-especiales"></span><h2><span class="section-number">2.3.2.3. </span>Permisos especiales<a class="headerlink" href="#permisos-especiales" title="Link to this heading">¶</a></h2>
<p>Además de los permisos habituales, se pueden definir sobre los archivos otros
tres permisos:</p>
<ul class="simple">
<li><p>El bit pegajoso (<em>sticky bit</em>), cuyo valor numérico es 1.</p></li>
<li><p>El bit <em>setgid</em>, cuyo valor numérico es 2.</p></li>
<li><p>El bit <em>setuid</em>, cuyo valor numérico es 4.</p></li>
</ul>
<p>Como en el caso de los tres permisos anteriores, esta terna de permisos
especiales puede expresarse con un numero formado por la suma de sus
respectivos valores numéricos. Al expresarse todos los permisos juntos (es decir
los especiales junto a los habituales), se usa un número de cuatro cifras: la
primera representa los permisos especiales y las otras tres los habituales. Por
ejemplo, la cifra <strong>1750</strong> representa un archivo con el bit pegajoso activo (<strong>1</strong>),
con todos los permisos para el propietario (<strong>7</strong>), y con permisos de lectura y
ejecución para el grupo propietario y con ningún permiso para el resto (<strong>0</strong>). Aunque
en puridad, la expresión completa de los permisos exige las cuatro cifras, si
sólamente se indican tres, se sobrentiende que la cifra para los
permisos especiales es <strong>0</strong>. Por tanto, unos permisos expresados como <strong>640</strong>
equivalen a <strong>0640</strong>.</p>
<p>Es pertinente también aclarar qué significa cada permisos:</p>
<dl>
<dt><strong>Ejecutable</strong> (para archivos regulares normales no tiene significado)</dt><dd><ul class="simple">
<li><p><em>Bit pegajoso</em>: El programa sigue en memoria aun después de dejarse de usar.
Esto permite no tener que volver a cargarlo, si se vuelve a usar. No obstante,
en linux se eliminó este uso, de modo que no tiene ninguna utilidad.</p></li>
<li><p><em>setgid</em>: El programa se ejecuta con los privilegios del grupo propietario.</p></li>
<li><p><em>setuid</em>: El programa se ejecuta con los privilegios del propietario.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>Es preciso notar que cuando indicamos «programa», nos referimos a
programa compilado, porque sólo los programas compilados se ejecutan
realmente. Los programas interpretados no se ejecutan directamente, sino
que son archivos regulares leídos por un intérprete que se encarga de
hacer lo que indica el código.  Por tanto, lo que realmente se ejecuta es
el intérprete. Así pues, no esperemos que un <em>script</em> de <strong class="command">bash</strong>
que pertenece a <em>root</em> y tiene habilitado el <em>setuid</em>, se ejecute con
permisos de administrador: tal <em>setuid</em> no tiene ningún efecto y tendrá
los permisos del usuario que lo invoca.</p>
</div>
</dd>
<dt><strong>Directorios</strong></dt><dd><ul class="simple">
<li><p><em>Bit pegajoso</em>: Los archivos que contiene sólo pueden ser borrados por el
propietario del propio directorio o el dueño del archivo que se pretende
borrar. Un caso típico es el del archivo temporal <code class="file docutils literal notranslate"><span class="pre">/tmp</span></code>, ya que
cualquier usuario debe poder escribir en él, por lo que todos los usuarios
tendrán permiso de escritura. Sin embargo, debe impedirse que los usuarios
borren archivos ajenos. La solución, pues, es fijar el bit pegajoso.</p></li>
<li><p><em>setgid</em>: Todos lo archivo creados dentro tendrán como grupo
propietario el grupo propietario del propio directorio y no el grupo
principal del usuario creador. En el caso de crearse un
subdirectorio, éste, además, tendrá también habilitado el <em>setgid</em>.</p></li>
<li><p><em>setuid</em>: No tiene utilidad.</p></li>
</ul>
</dd>
</dl>
<p>Por último, es necesario explicar cómo se notan estos permisos: el bit pegajoso
aparece como una <code class="docutils literal notranslate"><span class="pre">t</span></code> en el lugar donde aparece la <code class="docutils literal notranslate"><span class="pre">x</span></code> para <em>otros</em></p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>ls<span class="w"> </span>-ld<span class="w"> </span>/tmp
<span class="go">drwxrwxrwt 7 root root 4096 oct 19 18:43 /tmp/</span>
</pre></div>
</div>
<p>El <em>setgid</em> se nota con una <code class="docutils literal notranslate"><span class="pre">s</span></code> en el lugar donde aparece la <code class="docutils literal notranslate"><span class="pre">x</span></code> para el
grupo propietario:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>find<span class="w"> </span>/<span class="w"> </span>-perm<span class="w"> </span>-2000<span class="w"> </span>-ls<span class="w"> </span>-quit<span class="w"> </span><span class="m">2</span>&gt;<span class="w"> </span>/dev/null
<span class="go">   9605   0 drwxr-sr-x   3 root   systemd-journal    60 oct 19 19:26 /run/log/journal</span>
</pre></div>
</div>
<p>Por último, el <em>setuid</em> se nota con una <code class="docutils literal notranslate"><span class="pre">s</span></code> en el lugar donde aparece la <code class="docutils literal notranslate"><span class="pre">x</span></code>
para el propietario:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>ls<span class="w"> </span>-l<span class="w"> </span>/usr/bin/sudo
<span class="go">-rwsr-xr-x 1 root root 140944 jul  5 16:01 /usr/bin/sudo</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>Aparecen letras minúsculas cuando el archivo tiene definido el
permiso de ejecución que oculta la letra del permiso especial. Cuando este
permiso de ejecución no existe, la letra se muestra en mayúscula.</p>
</div>
</section>
<section id="mascara">
<h2><span class="section-number">2.3.2.4. </span>Máscara<a class="headerlink" href="#mascara" title="Link to this heading">¶</a></h2>
<p>Cuando se crean archivo y directorios, estos pertenecen al usuario que lo crea
y el grupo propietario es el principal del creador. Además, se crean con unos
permisos específicos:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>mkdir<span class="w"> </span>directorio
<span class="gp">$ </span>touch<span class="w"> </span>archivo
<span class="gp">$ </span>ls<span class="w"> </span>-ld<span class="w"> </span>directorio<span class="w"> </span>archivo
<span class="go">drwxr-xr-x 2 usuario usuario 1024 oct 19 17:17 directorio/</span>
<span class="go">-rw-r--r-- 1 usuario usuario    0 oct 19 17:17 archivo</span>
</pre></div>
</div>
<span id="umask"></span><dl id="index-0">
<dt><strong class="command">umask</strong></dt><dd><p>El directorio se ha creado con permisos 755 y el archivo con permisos 644. Esto
es debido a que hay definida en el sistema una máscara predeterminada:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span><span class="nb">umask</span>
<span class="go">0022</span>
</pre></div>
</div>
<p>Para saber los permisos con los que se creará un archivo es necesario hacer
la operación binaria <code class="code docutils literal notranslate"><span class="pre">0666</span> <span class="pre">&amp;</span> <span class="pre">~mask</span></code><a class="footnote-reference brackets" href="#id2" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a>, y para conocer aquellos con los
que se creará un directorio <code class="code docutils literal notranslate"><span class="pre">0777</span> <span class="pre">&amp;</span> <span class="pre">~mask</span></code>. Consecuentemente, si la
máscara es <strong>0022</strong>, los archivos se crearán con permisos <strong>0644</strong> y los
directorios con permisos <strong>0755</strong>, que es precisamente lo que ocurre.</p>
<p>Para cambiar la máscara predeterminada basta con ejecutar <strong class="command">umask</strong>
indicándola como argumento:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>rm<span class="w"> </span>archivo<span class="w"> </span>directorio<span class="w"> </span>-r
<span class="gp">$ </span><span class="nb">umask</span><span class="w"> </span><span class="m">027</span>
<span class="gp">$ </span>mkdir<span class="w"> </span>directorio
<span class="gp">$ </span>touch<span class="w"> </span>archivo
<span class="go">ls -ld archivo directorio</span>
<span class="go">drwxr-x--- 2 usuario usuario 1024 oct 19 17:37 directorio</span>
<span class="go">-rw-r----- 1 usuario usuario    0 oct 19 17:37 archivo</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>Obviamente, el cambio sólo tendrá efecto durante la sesión. Si se
quiere hacer permanente, se deberá incluir el comando en algún archivo de
<a class="reference internal" href="../07.avanzada/08.interpretaciones.html#inicio-bash"><span class="std std-ref">arranque de sesión</span></a> o <a class="reference internal" href="../../04.servidor/09.autenticacion/pam_modules/10.pam_umask.html#pam-umask"><span class="std std-ref">manipular el proceso de
autenticación</span></a>.</p>
</div>
</dd>
</dl>
</section>
<section id="manipulacion">
<h2><span class="section-number">2.3.2.5. </span>Manipulación<a class="headerlink" href="#manipulacion" title="Link to this heading">¶</a></h2>
<p>Manipular el sistema de permisos implica cambiar usuario y grupo propietarios y
cambiar los propios permisos.</p>
<span id="chgrp"></span><dl id="index-1">
<dt><strong class="command">chgrp</strong></dt><dd><p>Permite cambiar el grupo propietario del archivo. Sólo el propietario del
archivo (o <em>root</em>) es capaz de hacer este cambio y sólo podrá cambiar a un
grupo del que sea miembro:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>chgrp<span class="w"> </span>audio<span class="w"> </span>archivo
<span class="gp">$ </span>ls<span class="w"> </span>-l<span class="w"> </span>archivo
<span class="go">-rw-r----- 1 usuario audio 0 oct 19 17:37 archivo</span>
<span class="gp">$ </span>chgrp<span class="w"> </span>root<span class="w"> </span>archivo
<span class="go">chgrp: cambiando el grupo de «archivo»: Operación no permitida</span>
</pre></div>
</div>
<p>Es posible usar la opción <code class="docutils literal notranslate"><span class="pre">-R</span></code> para hacer los cambios recursivos y que se
apliquen a los argumentos y a toda la parte del árbol de directorios que
cuelgue de ellos.</p>
</dd>
</dl>
<span id="chown"></span><dl id="index-2">
<dt><strong class="command">chown</strong></dt><dd><p>Permite cambiar el propietario o el grupo propietario o ambos a la vez. El
cambio de propietario sólo puede llevarlo a cabo el administrador (<em>root</em>).
La sintaxis del comando es la siguiente:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">chown [usuario][:grupo] archivo1 [archivo2...]</span>
</pre></div>
</div>
<p>Así, si desea cambiarse sólo el propietario:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp"># </span>chown<span class="w"> </span>usuario<span class="w"> </span>/tmp/archivo
</pre></div>
</div>
<p>Si desea cambiarse sólo el grupo:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp"># </span>chown<span class="w"> </span>:usuario<span class="w"> </span>/tmp/archivo
</pre></div>
</div>
<p>Y si desean cambiarse ambos a la vez:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp"># </span>chown<span class="w"> </span>usuario:usuario<span class="w"> </span>/tmp/archivo
</pre></div>
</div>
<p>Como <strong class="command">chgrp`</strong>, dispone de la opción <code class="docutils literal notranslate"><span class="pre">-R</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>El carácter de separación puede ser el punto (<em>.</em>) en vez de los dos
puntos (<em>:</em>).</p>
</div>
</dd>
</dl>
<span id="chmod"></span><dl id="index-3">
<dt><strong class="command">chmod</strong></dt><dd><p>Permite cambiar los permisos sobre un archivo a su propietario (o al
administador). La sintaxis básica es la siguiente:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">chmod &lt;permisos&gt; archivo1 [archivo2...]</span>
</pre></div>
</div>
<p>La expresión de los permisos, por otro lado puede ser bien numérica, bien
alfabética. La expresión numérica no tiene dificultad alguna, si se ha
entendido lo hasta aquí explicado:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>chmod<span class="w"> </span><span class="m">600</span><span class="w"> </span>archivo
<span class="go">-rw------- 1 usuario audio 0 oct 19 17:37 archivo</span>
<span class="gp">$ </span>chmod<span class="w"> </span><span class="m">1700</span><span class="w"> </span>archivo
<span class="go">-rws------ 1 usuario audio 0 oct 19 17:37 archivo</span>
</pre></div>
</div>
<p>La expresión alfabética, en cambio, requiere algo más de explicación: está
constituida por tres partes:</p>
<ul>
<li><p>La expresión de a quién se le aplica el permiso: <strong>u</strong>(usuario
propietario), <strong>g</strong>(grupo propietario), <strong>o</strong>(otros) y
<strong>a</strong>(todos). Es posible también juntar varias letras (por ejemplo,
<strong>ug</strong> significa usuario y grupo propietarios) o bien no expresar
ninguna, en cuyo último caso se usará la máscara para determinar el
efecto. Por ejemplo, si la máscara es <code class="docutils literal notranslate"><span class="pre">0022</span></code>, y se hace:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>chmod<span class="w"> </span>+w<span class="w"> </span>archivo
</pre></div>
</div>
<p>Se añadirá el permiso de escritura sólo al propierario, ya que
los permisos predeterminados sólo dan permisos de escritura a este.</p>
</li>
<li><p>Un signo que puede ser un <strong>=</strong>, si se quieren fijar los permisos que
se expresarán a continuación; un <strong>+</strong>, si se quieren añadir permisos
a los que hay ya fijados; y un <strong>-</strong>, si se quieren quitar permisos.</p></li>
<li><p>La expresión alfabética del permiso <strong>r</strong>, <strong>w</strong>o <strong>x</strong>. Se pueden
yuxtaponer varias letras si se quieren indicar varios permisos a la
vez. Por ejemplo, <strong>rw</strong> o <strong>wr</strong> significa que se quiere expresar los
permisos de lectura y escritura. Dejar en blanco esta parte implica
indicar ningún permiso.</p></li>
</ul>
<p>Ilustremos lo anterior:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>chmod<span class="w"> </span><span class="nv">a</span><span class="o">=</span>rw<span class="w"> </span>archivo
<span class="go">-rw-rw-rw- 1 josem josem 0 oct 19 20:05 archivo</span>
<span class="gp">$ </span>chmod<span class="w"> </span><span class="nv">g</span><span class="o">=</span><span class="w"> </span>archivo
<span class="go">-rw----rw- 1 josem josem 0 oct 19 20:05 archivo</span>
<span class="gp">$ </span>chmod<span class="w"> </span>uo-w<span class="w"> </span>archivo
<span class="go">-r-----r-- 1 josem josem 0 oct 19 20:05 archivo</span>
<span class="gp">$ </span>chmod<span class="w"> </span>u+w<span class="w"> </span>archivo
<span class="go">-rw----r-- 1 josem josem 0 oct 19 20:05 archivo</span>
</pre></div>
</div>
<p>También es posible escribir varias expresiones separadas por comas:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>chmod<span class="w"> </span><span class="nv">u</span><span class="o">=</span>rw,g<span class="o">=</span>r,o<span class="o">=</span><span class="w"> </span>archivo
<span class="go">-rw-r----- 1 josem josem 0 oct 19 20:05 archivo</span>
</pre></div>
</div>
<p>Para expresar los permisos especiales se usan las letras <code class="docutils literal notranslate"><span class="pre">s</span></code> y <code class="docutils literal notranslate"><span class="pre">t</span></code>
aplicadas a <code class="docutils literal notranslate"><span class="pre">u</span></code>, <code class="docutils literal notranslate"><span class="pre">g</span></code> o <code class="docutils literal notranslate"><span class="pre">o</span></code>, según convenga:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>chmod<span class="w"> </span>g+s,o<span class="o">=</span>xt<span class="w"> </span>archivo
<span class="go">-rw-r-S--t 1 josem josem 0 oct 19 20:05 archivo</span>
</pre></div>
</div>
<p>Como las dos órdenes anteriores, dispone de la opción <code class="docutils literal notranslate"><span class="pre">-R</span></code>.</p>
</dd>
</dl>
</section>
<section id="ejercicios-sobre-permisos">
<span id="ej-perm"></span><h2><span class="section-number">2.3.2.6. </span>Ejercicios sobre permisos<a class="headerlink" href="#ejercicios-sobre-permisos" title="Link to this heading">¶</a></h2>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>Es obligatorio usar el usuario sin privilegios si para hacer el
ejetcicio concreto no es necesario ser administrador.</p>
</div>
<ol class="arabic">
<li><p>Mejorar la privacidad de nuestro usuario para que
solamente él pueda ver los archivos contenidos en su espacio personal.</p></li>
<li><p>Volver a dejar el directorio personal como estaba y crear dentro un
subdirectorio al que no puedan acceder los usuarios que no pertenezca a mi
grupo principal.</p></li>
<li><p>Crear un directorio propiedad de <em>root</em> al que solo puedan acceder
los usuarios del grupo «netdev» (además del propio <em>root</em>).</p></li>
<li><p>Crear un directorio <code class="file docutils literal notranslate"><span class="pre">D</span></code>, dentro un fichero <code class="file docutils literal notranslate"><span class="pre">f</span></code> y permitir que
todos puedan ver el contenido del fichero <code class="file docutils literal notranslate"><span class="pre">f</span></code>, pero impedir que alguien
(incluido uno mismo) lo pueda borrar.</p></li>
<li><p>Cambiar el grupo del directorio <code class="file docutils literal notranslate"><span class="pre">D</span></code> a <em>plugdev</em>. ¿Es posible? ¿Y a
<em>disk</em>? ¿Por qué?</p></li>
<li><p>Hacer que de forma predeterminada cada vez que creo un archivo sólo yo pueda
leerlo.</p></li>
<li><p>Supongamos que hacemos lo siguiente como administradores:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp"># </span>ls<span class="w"> </span>-l<span class="w"> </span>/bin/rm
<span class="go">-rwxr-xr-x 1 root root 72752 sep 20  2022 /bin/rm</span>
<span class="gp"># </span>chmod<span class="w"> </span>u+s<span class="w"> </span>/bin/rm
</pre></div>
</div>
<p>¿Qué he hecho y que implicaciones prácticas tiene?</p>
</li>
<li><p>Supongamos que creamos un directorio <code class="file docutils literal notranslate"><span class="pre">/srv/ftp</span></code> al que queremos
que todos los usuarios por <abbr title="File Transfer Protocol">FTP</abbr> puedan subir ficheros, pero no queremos que
unos usuarios borren o modifiquen lo que pertenecen a los demás, ¿qué podemos
hacer?</p></li>
<li><p>Tomando el caso anterior, supongamos que el directorio es para que
los estudiantes suban sus trabajos y los profesores puedan
corregirlos. En esta circunstancia, además, de que unos estudiantes
no puedan alterar o borrar los trabajos de los demás, queremos que
no se puedan copiar, ¿cómo lo logramos? Búsquense posibles soluciones</p></li>
<li><p>Supongamos que tengo un directorio llamado <code class="file docutils literal notranslate"><span class="pre">Fotos</span></code> cuyo contenido (incluido
subdirectorios) solo quiero que sea accesible por mi grupo de amigos. Para
ello, el administrador ha creado el grupo <em>amigos_usuario</em> y me ha metido
a mí y a mis amigos dentro. ¿Cómo lo hago?</p>
<ol class="loweralpha">
<li><p>Resuélvase de forma expeditiva (solución sencilla)</p></li>
<li><p>Resuélvase de forma que se pretenda dar envidia, es decir, los
usuarios que no son mis amigos. podrán ver que tengo fotos y cuáles
son («Viaje a las islas griegas», «Yo en Cancún»), pero no abrirlas.</p>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>O sea, mire lo que ocurre en un sistema bien resuelto de esta
segunda forma::</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>ls<span class="w"> </span>-l<span class="w"> </span>/tmp/Fotos
<span class="go">ls: no se puede acceder a &#39;/tmp/Fotos/MiFotoEnElCaribe.jpg&#39;: Permiso denegado</span>
<span class="go">ls: no se puede acceder a &#39;/tmp/Fotos/ZanganeandoEnMadagascar.jpg&#39;: Permiso denegado</span>
<span class="go">ls: no se puede acceder a &#39;/tmp/Fotos/EscalandoElHimalaya.jpg&#39;: Permiso denegado</span>
<span class="go">total 0</span>
<span class="go">-????????? ? ? ? ?            ? EscalandoElHimalaya.jpg</span>
<span class="go">-????????? ? ? ? ?            ? MiFotoEnElCaribe.jpg</span>
<span class="go">-????????? ? ? ? ?            ? ZanganeandoEnMadagascar.jpg</span>
</pre></div>
</div>
<p>Y si prueba a copiar alguna foto fuera del directorio, verá que es
imposible.</p>
</div>
</li>
</ol>
</li>
</ol>
</section>
<section id="ejercicios-sobre-usuarios-y-permisos">
<span id="ej-usu-perm"></span><h2><span class="section-number">2.3.2.7. </span>Ejercicios sobre usuarios y permisos<a class="headerlink" href="#ejercicios-sobre-usuarios-y-permisos" title="Link to this heading">¶</a></h2>
<ol class="arabic">
<li><p>Crear un usuario llamado moises y obligarle a cambiar la contraseña en el
primer ingreso.</p></li>
<li><p>Evitar que cualquier otro usuario pueda espiar el directorio personal de
moises. ¿Puede hacer el propio moises?</p></li>
<li><p>Crear un usuario llamado «sara» cuyo grupo prinicpal sea «users». Comprobar,
además, que este grupo ya existe.</p></li>
<li><p>Crear un usuario del sistema (o sea, un usuario que no representan a una
persona física) llamado «ftp». Su directorio personal debe ser /srv/ftp.</p></li>
<li><p>Hacer que «sara» cree un subdirectorio dentro de su directorio personal
en el que otros usuarios puedan dejar ficheros, pero que unos usuarios no
puedan borrar los ficheros dejados por otro.</p></li>
<li><p>Crear con moises un directorio llamado «PRUEBA» dentro del directorio
temporal. Intente hacer con moises que el grupo propietario de este
directorio sea «www-data». ¿Es posible? Justifique la respuesta.</p></li>
<li><p>Impedir que «sara» pueda acceder al sistema.</p></li>
<li><p>Escriba en un fichero llamado «script.sh» el siguiente contenido:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/bin/sh</span>

<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;Hola, mundo!!!!&quot;</span>
</pre></div>
</div>
<ol class="loweralpha simple">
<li><p>Permita que se pueda ejecutar.</p></li>
<li><p>Ejecútelo.</p></li>
</ol>
</li>
<li><p>¿Cuál es el equivalente numérico a los permisos <kbd class="kbd compound docutils literal notranslate"><kbd class="kbd docutils literal notranslate">r</kbd>-<kbd class="kbd docutils literal notranslate">xrwxr</kbd>-<kbd class="kbd docutils literal notranslate">x</kbd></kbd>? ¿Cuál es la
máscara que debe definirse para que los ficheros de los usuarios se creen con
permisos <kbd class="kbd compound docutils literal notranslate"><kbd class="kbd docutils literal notranslate">rw</kbd>-<kbd class="kbd docutils literal notranslate"></kbd>-<kbd class="kbd docutils literal notranslate"></kbd>-<kbd class="kbd docutils literal notranslate"></kbd>-<kbd class="kbd docutils literal notranslate"></kbd>-<kbd class="kbd docutils literal notranslate"></kbd>-<kbd class="kbd docutils literal notranslate">-</kbd></kbd>?</p></li>
<li><p>Un dispositivo se configura a través de su puerto serie (representando por
<code class="file docutils literal notranslate"><span class="pre">/dev/ttyS0</span></code> en los sistemas <em>Linux</em>), por lo que se conecta mediante
cable nuestro equipo con <em>Linux</em>. Si configurar implica poder leer y escribir
el archivo de dispositivo referido, ¿qué debemos hacer para permitir
al usuario habitual configurar el dispositivo?</p></li>
</ol>
<p class="rubric">Notas al pie</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id2" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">1</a><span class="fn-bracket">]</span></span>
<p>Para entender bien cómo es esta operación binaria recuérdese que en
el número 666 cada cifra expresa una terna de permisos cada uno de
los cuales se representa con los números 4, 2 y 1. Es decir, que cada
cifra es la representación de un número de 3 bits. De modo que <strong>6</strong>
es, en realidad, <strong>110</strong> en binario.</p>
<p>Por esto mismo, si tenemos una máscara de <strong>022</strong>, su expresión en
binario es 000.010.010 y su negación <strong>~022</strong> es 111.101.101. Por
último, al hacer la operación <em>AND</em> sobre bits con <strong>666</strong> obtenemos
<span class="math notranslate nohighlight">\(110.110.110 \ \&amp;\  111.101.101 = 110.100.100\)</span>, esto es, <strong>644</strong>.</p>
<p>Si no nos queremos calentar la cabeza, simplemente nos vale con restar
en decimal la máscara a <strong>777</strong> y, si la entidad es un archivo, eliminar
del resultado los permisos de ejecución. Por tanto, <span class="math notranslate nohighlight">\(777-022=755\)</span>,
con lo que <strong>755</strong> serían los permisos predeterminados para un directorio y
<strong>644</strong> (o sea, a <strong>755</strong> se le quitan los permisos de ejecución) para
un archivo.</p>
</aside>
</aside>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
  <div>
    <h3><a href="../../index.html">Tabla de contenido</a></h3>
    <ul>
<li><a class="reference internal" href="#">2.3.2. Permisos</a><ul>
<li><a class="reference internal" href="#sistema-ugo">2.3.2.1. Sistema <abbr title="User-Group-Others">UGO</abbr></a></li>
<li><a class="reference internal" href="#permisos-habituales">2.3.2.2. Permisos habituales</a></li>
<li><a class="reference internal" href="#permisos-especiales">2.3.2.3. Permisos especiales</a></li>
<li><a class="reference internal" href="#mascara">2.3.2.4. Máscara</a></li>
<li><a class="reference internal" href="#manipulacion">2.3.2.5. Manipulación</a></li>
<li><a class="reference internal" href="#ejercicios-sobre-permisos">2.3.2.6. Ejercicios sobre permisos</a></li>
<li><a class="reference internal" href="#ejercicios-sobre-usuarios-y-permisos">2.3.2.7. Ejercicios sobre usuarios y permisos</a></li>
</ul>
</li>
</ul>

  </div>
  <div>
    <h4>Tema anterior</h4>
    <p class="topless"><a href="05a.usuarios.html"
                          title="capítulo anterior"><span class="section-number">2.3.1. </span>Gestión de usuarios</a></p>
  </div>
  <div>
    <h4>Próximo tema</h4>
    <p class="topless"><a href="../06.conbas/index.html"
                          title="próximo capítulo"><span class="section-number">2.4. </span>Configuración básica</a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>Esta página</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/02.conbas/05.seguridad/05b.permisos.rst.txt"
            rel="nofollow">Mostrar el código</a></li>
    </ul>
   </div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Búsqueda rápida</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Ir a" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navegación</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="Índice General"
             >índice</a></li>
        <li class="right" >
          <a href="../06.conbas/index.html" title="2.4. Configuración básica"
             >siguiente</a> |</li>
        <li class="right" >
          <a href="05a.usuarios.html" title="2.3.1. Gestión de usuarios"
             >anterior</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">documentación de Linuxnomicón - rolling</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" ><span class="section-number">2. </span>Conceptos básicos</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" ><span class="section-number">2.3. </span>Seguridad del sistema</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><span class="section-number">2.3.2. </span>Permisos</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright CC BY 4.0, 2016-2025, José Miguel Sánchez Alés.
      Creado usando <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.1.3.
    </div>
  </body>
</html>