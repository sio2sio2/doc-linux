


<!DOCTYPE html>

<html lang="es">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>2.3.3. Privilegios &#8212; documentación de Linuxnomicón - rolling</title>
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
    
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/translations.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <link rel="index" title="Índice" href="../../genindex.html" />
    <link rel="search" title="Búsqueda" href="../../search.html" />
    <link rel="next" title="2.4. Configuración básica" href="../06.conbas/index.html" />
    <link rel="prev" title="2.3.2. Permisos" href="05b.permisos.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navegación</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="Índice General"
             accesskey="I">índice</a></li>
        <li class="right" >
          <a href="../06.conbas/index.html" title="2.4. Configuración básica"
             accesskey="N">siguiente</a> |</li>
        <li class="right" >
          <a href="05b.permisos.html" title="2.3.2. Permisos"
             accesskey="P">anterior</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">documentación de Linuxnomicón - rolling</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" ><span class="section-number">2. </span>Conceptos básicos</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" accesskey="U"><span class="section-number">2.3. </span>Seguridad del sistema</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><span class="section-number">2.3.3. </span>Privilegios</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="privilegios">
<span id="capabilities"></span><h1><span class="section-number">2.3.3. </span>Privilegios<a class="headerlink" href="#privilegios" title="Enlazar permanentemente con este título">¶</a></h1>
<p>Cuando la consecución de una acción implica exclusivamente la manipulación de un archivo, basta con tener permisos sobre tal archivo para poder llevarla a término. Por ejemplo, <a class="reference internal" href="../02.informacion/04.devices.html#dispositivos"><span class="std std-ref">los dispositivos tiene un representación como archivo</span></a> (p.e. <code class="file docutils literal notranslate"><span class="pre">/dev/sda</span></code>), por lo que el privilegio de particionar un disco se reduce a tener permisos de escritura sobre el archivo que lo representa. Sin embargo, existen otras actuaciones que no están directamente relaconadas con un archivo por lo que, en consecuencia, el privilegio no puede reducirse a un mero problema de permisos sobre archivos. Tal es el caso de cambiar de hora el sistema o crear o manipular una interfaz de red.</p>
<p>Trataremos bajo este epígrafe las dos estrategias para que un usuario
inicialmente sin privilegios pueda llevar a término estas acciones
privilegiadas.</p>
<div class="admonition warning">
<p class="admonition-title">Advertencia</p>
<p>El núcleo de <em>Linux</em> se desentiende del <em>setuid</em> y las
<em>capabilities</em> definidas en ejecutables interpretados (p.e. un <em>script</em> de
<strong class="program">bash</strong>). Así pues, su definición sólo tiene sentido para programas
compilados. Esta limitación, no obstante, no es común a todos los <em>UNIX</em>.</p>
</div>
<p class="rubric">El <em>setuid</em></p>
<p>La solución tradicional en los sistemas <em>Linux</em> fue la dicotomía entre el usuario con <em>UID</em> <strong>0</strong> (o sea, <em>root</em>) y el resto: con el primero el <em>kernel</em> salta todas las comprobaciones referentes a privilegios convirtiéndolo en un usuario omnímodo; mientras que sobre los demás operan los permisos de archivo y las limitaciones en las acciones privilegidas. En consecuencia, la única forma de que un usuario pueda realizar algo sobre lo que no tiene privilegio es actuar con <em>UID</em> <strong>0</strong>. Para eso se creó el <a class="reference internal" href="05b.permisos.html#perm-especiales"><span class="std std-ref">setuid</span></a> y todas las escaladas legítimas de privilegios se basan en ello:</p>
<ul class="simple">
<li><p>En principio, aplicar el <em>setuid</em> a un programa cuyo propietario es el
administrador implica que cualquier usuario actúe de forma incondicional como
administrador cuando lo ejecuta.</p></li>
<li><p>Una variante es <a class="reference internal" href="05a.usuarios.html#su"><span class="std std-ref">su</span></a> (o <a class="reference internal" href="05a.usuarios.html#runuser"><span class="std std-ref">runuser</span></a>): tiene el <em>setuid</em>
activado, pero para que dé paso es necesario conocer la contraseña de
administrador, por lo que el acceso no es incondicional. En contraposición,
da acceso a cualquier acción, ya que convierte al usuario en administrador.</p></li>
<li><p>La última variante más restrictiva aún es <a class="reference internal" href="../09.admbasica/10.sudo.html#sudo"><span class="std std-ref">sudo</span></a>: como el anterior
tiene el <em>setuid</em> activado y también establece una autenticación para su uso,
pero a diferencia de <strong class="command">su</strong>, permite definir unas reglas que limitan
qué puede hacer como administrador el usuario. Gracias a ello, puede definirse
que un determinado usuario sólo pueda ejecutar un programa como administrador
o incluso definir con qué argumentos podrá ejecutar tal programa.</p></li>
</ul>
<p>Gracias a <strong class="command">sudo</strong>, pues, pueden restringirse los casos en los que un
usuario sin privilegios accede a ser administrador. Sin embargo, su
identificación como <em>root</em> es completa y el proceso correrá con privilegios
absolutos. Por tanto, sigue adoleciendo del principal problema de segurodad
asociado al <em>setuid</em>: violar el <cite>principio de mínimo privilegio
&lt;https://news.sophos.com/es-es/2013/03/25/principio-de-minimo-privilegio-reducir-el-area-de-ataque/&gt;</cite>,
lo cual propicia que cualquier programa se convierta en un peligro potencial de
seguridad si contiene algún <em>bug</em> que permita a un usuario malintencionado
utilizar el programa para algo distinto de lo que fue diseñado.</p>
<p class="rubric">Las capacidades</p>
<p>Por este motivo, <em>Linux</em> a partir de su versión <em>2.2</em> introdujo el concepto de
<em class="manpage"><a class="manpage reference external" href="https://manpages.debian.org/capabilities(7)">capabilities(7)</a></em>, cuya filosofía es descomponer el poder
para realizar acciones privilegiadas en múltiples capacidades
independientes. De este modo, en vez de darle poder absoluto a un programa
activando su <em>setuid</em>, se le activan exclusivamente las capacidades necesarias
para que pueda completar su tarea. Por ejemplo, si requerimos que un programa
cree y configure alguna interfaz de red podemos, simplemente, activarle la
capacidad <strong>CAP_NET_ADMIN</strong>.</p>
<p>Las herramientas para manipular las capacidades deben estar ya instaladas en el
sistema, puesto que el paquete que las contiene (<em>libcap2-bin</em>) es dependencia
de <em>systemd</em>. En cualquier caso, antes de ilustrar cómo usarlas, conviene
explicar en qué consisten:</p>
<div class="admonition-todo admonition" id="id1">
<p class="admonition-title">Por hacer</p>
<p>Seguir e introducir libpam-cap</p>
</div>
<p>Los archivos permiten definir cada capacidad por separado con un juego de tres
<em>flags</em>:</p>
<p><strong>P</strong><em>ermitida</em></p>
<p><strong>E</strong><em>fectiva</em></p>
<p><em>heredable</em> (<strong>I</strong><em>nheritable</em>)</p>
</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Tema anterior</h4>
  <p class="topless"><a href="05b.permisos.html"
                        title="capítulo anterior"><span class="section-number">2.3.2. </span>Permisos</a></p>
  <h4>Próximo tema</h4>
  <p class="topless"><a href="../06.conbas/index.html"
                        title="próximo capítulo"><span class="section-number">2.4. </span>Configuración básica</a></p>
  <div role="note" aria-label="source link">
    <h3>Esta página</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/02.conbas/05.seguridad/06.capabilities.rst.txt"
            rel="nofollow">Mostrar el código</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Búsqueda rápida</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Ir a" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navegación</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="Índice General"
             >índice</a></li>
        <li class="right" >
          <a href="../06.conbas/index.html" title="2.4. Configuración básica"
             >siguiente</a> |</li>
        <li class="right" >
          <a href="05b.permisos.html" title="2.3.2. Permisos"
             >anterior</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">documentación de Linuxnomicón - rolling</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" ><span class="section-number">2. </span>Conceptos básicos</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" ><span class="section-number">2.3. </span>Seguridad del sistema</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><span class="section-number">2.3.3. </span>Privilegios</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Derechos de autor CC BY 4.0, 2016-2021, José Miguel Sánchez Alés.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 3.4.3.
    </div>
  </body>
</html>