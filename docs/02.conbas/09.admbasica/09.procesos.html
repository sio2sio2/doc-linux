


<!DOCTYPE html>

<html lang="es">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>2.7.2. Control de procesos &#8212; documentación de Linuxnomicón - rolling</title>
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
    
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/translations.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <link rel="index" title="Índice" href="../../genindex.html" />
    <link rel="search" title="Búsqueda" href="../../search.html" />
    <link rel="next" title="2.7.3. Escalada de privilegios" href="10.sudo.html" />
    <link rel="prev" title="2.7.1. Gestión del software" href="08.paqueteria.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navegación</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="Índice General"
             accesskey="I">índice</a></li>
        <li class="right" >
          <a href="10.sudo.html" title="2.7.3. Escalada de privilegios"
             accesskey="N">siguiente</a> |</li>
        <li class="right" >
          <a href="08.paqueteria.html" title="2.7.1. Gestión del software"
             accesskey="P">anterior</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">documentación de Linuxnomicón - rolling</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" ><span class="section-number">2. </span>Conceptos básicos</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" accesskey="U"><span class="section-number">2.7. </span>Administración básica</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><span class="section-number">2.7.2. </span>Control de procesos</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="control-de-procesos">
<span id="procesos"></span><h1><span class="section-number">2.7.2. </span>Control de procesos<a class="headerlink" href="#control-de-procesos" title="Enlazar permanentemente con este título">¶</a></h1>
<p><em>linux</em> es un sistema operativo multitarea, esto es, capaz de ejecutar varios
programas en paralelo. Al hilo de este asunto, cabe hacer una serie de
definiciones:</p>
<dl class="simple">
<dt><strong>Proceso</strong></dt><dd><p>Se denomina proceso, simplemente, a un programa que está en ejecución. Cada
procesos tiene una serie de propiedades que definen su estado. Una de ellas,
muy importante es el <abbr title="Process IDentifier">PID</abbr>.</p>
</dd>
</dl>
<dl class="simple" id="pid">
<dt><strong>PID</strong> (Process IDentifier)</dt><dd><p>Es el número asociada a un proceso que lo identifica de manera inequívoca.
Esto implica que es único.</p>
</dd>
<dt><strong>Demonio</strong> (<strong>servicio</strong> en la terminología de los sistemas <em>windows</em>)</dt><dd><p>Es un proceso que se ejecuta en segundo plano, es decir, que se ejecuta sin
que intervenga en su ejecución de manera interactiva el usuario.</p>
</dd>
<dt><strong>Prioridad</strong></dt><dd><p>Es la preferencia que el sistema le da a la ejecución de un proceso. Está
representada por un número entre <em>-20</em> (máxima prioridad) y <em>19</em> (mínima
prioridad). La prioridad normal es <em>0</em>.</p>
</dd>
</dl>
<p>Bajo este epígrafe trataremos el modo de conocer cuáles son los procesos que
ejecuta el sistema, qué recursos consumen, cómo cancelarlos o como traerlos a
primer plano y mandarlos a segundo plano. La gestión de los demonios, por ser
más un asunto de servidor, se dejará para más adelante.</p>
<div class="section" id="consulta">
<span id="consproc"></span><h2><span class="section-number">2.7.2.1. </span>Consulta<a class="headerlink" href="#consulta" title="Enlazar permanentemente con este título">¶</a></h2>
<span class="target" id="ps"></span><dl id="index-0">
<dt><strong class="command">ps</strong></dt><dd><p>Permite obtener información sobre los procesos que se ejecutan en el sistema.
Hay dos modos de pasarle opciones: siguiendo el estilo <em>BSD</em>, en que las
opciones no van precedidas de guión; y siguiendo el estilo <em>unix</em>, en que
son precedidas por uno. Por coherencia con el resto de comandos,
usaremos este segundo método<a class="footnote-reference brackets" href="#id4" id="id1">1</a>.</p>
<p>El modo más elemental de uso es aquel que muestra todos los procesos:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> ps -e
<span class="go"> PID TTY          TIME CMD</span>
<span class="go">[...]</span>
<span class="go">518 ?        00:00:00 ntpd</span>
<span class="go">520 ?        00:00:00 samba</span>
<span class="go">522 ?        00:00:00 samba</span>
<span class="go">523 ?        00:00:00 samba</span>
<span class="go">524 ?        00:00:00 samba</span>
<span class="go">525 ?        00:00:00 samba</span>
<span class="go">526 ?        00:00:00 smbd</span>
<span class="go">527 ?        00:00:00 samba</span>
<span class="go">528 ?        00:00:00 samba</span>
<span class="go">529 ?        00:00:00 samba</span>
<span class="go">530 ?        00:00:00 samba</span>
<span class="go">531 ?        00:00:00 samba</span>
<span class="go">532 ?        00:00:00 winbindd</span>
<span class="go">533 ?        00:00:00 samba</span>
<span class="go">534 ?        00:00:00 samba</span>
<span class="go">535 ?        00:00:00 samba</span>
<span class="go">536 ?        00:00:00 samba</span>
<span class="go">541 ?        00:00:00 smbd-notifyd</span>
<span class="go">542 ?        00:00:00 cleanupd</span>
<span class="go">544 ?        00:00:00 winbindd</span>
<span class="go">545 ?        00:00:00 lpqd</span>
<span class="go">[...]</span>
</pre></div>
</div>
<p>o bien todos los procesos que están asociados a una terminal:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> ps -e
<span class="go"> PID TTY          TIME CMD</span>
<span class="go">3068 pts/1    00:00:06 vim</span>
<span class="go">3913 pts/0    00:00:00 tmux: client</span>
<span class="go">4354 pts/5    00:00:00 su</span>
<span class="go">4368 pts/5    00:00:00 bash</span>
<span class="go">5490 pts/4    00:00:00 vim</span>
<span class="go">5654 pts/7    00:00:00 su</span>
<span class="go">5667 pts/7    00:00:00 bash</span>
<span class="go">5672 pts/3    00:00:00 ps</span>
</pre></div>
</div>
<p>En la salida se observan entre otros el <abbr title="Process IDentifier">PID</abbr> del proceso, la terminal
asociada y el ejecutable que lo originó. Puede obtenerse un formato
largo que da más información con <code class="docutils literal notranslate"><span class="pre">-f</span></code>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> ps -ef
<span class="go">[...]</span>
<span class="go">ntp        518     1  0 11:08 ?        00:00:00 /usr/sbin/ntpd -p /var/run/ntpd.pid -g -u 107:111</span>
<span class="go">root       520     1  0 11:08 ?        00:00:00 /usr/sbin/samba</span>
<span class="go">root       522   520  0 11:08 ?        00:00:00 /usr/sbin/samba</span>
<span class="go">root       523   520  0 11:08 ?        00:00:00 /usr/sbin/samba</span>
<span class="go">root       524   520  0 11:08 ?        00:00:00 /usr/sbin/samba</span>
<span class="go">root       525   520  0 11:08 ?        00:00:00 /usr/sbin/samba</span>
<span class="go">root       526   522  0 11:08 ?        00:00:00 /usr/sbin/smbd -D --option=server role check:inhibit=yes --foreground</span>
<span class="go">root       527   520  0 11:08 ?        00:00:00 /usr/sbin/samba</span>
<span class="go">root       528   520  0 11:08 ?        00:00:00 /usr/sbin/samba</span>
<span class="go">root       529   520  0 11:08 ?        00:00:00 /usr/sbin/samba</span>
<span class="go">root       530   520  0 11:08 ?        00:00:00 /usr/sbin/samba</span>
<span class="go">root       531   520  0 11:08 ?        00:00:00 /usr/sbin/samba</span>
<span class="go">root       532   531  0 11:08 ?        00:00:00 /usr/sbin/winbindd -D --option=server role check:inhibit=yes --foreground</span>
<span class="go">root       533   520  0 11:08 ?        00:00:00 /usr/sbin/samba</span>
<span class="go">root       534   520  0 11:08 ?        00:00:00 /usr/sbin/samba</span>
<span class="go">root       535   520  0 11:08 ?        00:00:00 /usr/sbin/samba</span>
<span class="go">root       536   520  0 11:08 ?        00:00:00 /usr/sbin/samba</span>
<span class="go">root       541   526  0 11:08 ?        00:00:00 /usr/sbin/smbd -D --option=server role check:inhibit=yes --foreground</span>
<span class="go">root       542   526  0 11:08 ?        00:00:00 /usr/sbin/smbd -D --option=server role check:inhibit=yes --foreground</span>
<span class="go">root       544   532  0 11:08 ?        00:00:00 /usr/sbin/winbindd -D --option=server role check:inhibit=yes --foreground</span>
<span class="go">root       545   526  0 11:08 ?        00:00:00 /usr/sbin/smbd -D --option=server role check:inhibit=yes --foreground</span>
<span class="go">[...]</span>
</pre></div>
</div>
<p>Los procesos derivan unos de otros, de manera que un proceso tiene un
proceso padre. SI se quiere observar esta jerarquía de permisos puede
usarse la opción <code class="docutils literal notranslate"><span class="pre">-H</span></code>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> ps -eH
<span class="go">[...]</span>
<span class="go">518 ?        00:00:00   ntpd</span>
<span class="go">520 ?        00:00:00   samba</span>
<span class="go">522 ?        00:00:00     samba</span>
<span class="go">526 ?        00:00:00       smbd</span>
<span class="go">541 ?        00:00:00         smbd-notifyd</span>
<span class="go">542 ?        00:00:00         cleanupd</span>
<span class="go">545 ?        00:00:00         lpqd</span>
<span class="go">523 ?        00:00:00     samba</span>
<span class="go">524 ?        00:00:00     samba</span>
<span class="go">525 ?        00:00:00     samba</span>
<span class="go">527 ?        00:00:00     samba</span>
<span class="go">528 ?        00:00:00     samba</span>
<span class="go">529 ?        00:00:00     samba</span>
<span class="go">530 ?        00:00:00     samba</span>
<span class="go">531 ?        00:00:00     samba</span>
<span class="go">532 ?        00:00:00       winbindd</span>
<span class="go">544 ?        00:00:00         winbindd</span>
<span class="go">533 ?        00:00:00     samba</span>
<span class="go">534 ?        00:00:00     samba</span>
<span class="go">535 ?        00:00:00     samba</span>
<span class="go">536 ?        00:00:00     samba</span>
<span class="go">[...]</span>
</pre></div>
</div>
<p>Alternativa a la opción <code class="docutils literal notranslate"><span class="pre">-H</span></code> es <code class="docutils literal notranslate"><span class="pre">--forest</span></code>, con la que obtenemos una
salida más vistosa y elocuente:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> ps -e --forest
<span class="go">[...]</span>
<span class="go">518 ?        00:00:00 ntpd</span>
<span class="go">520 ?        00:00:00 samba</span>
<span class="go">522 ?        00:00:00  \_ samba</span>
<span class="go">526 ?        00:00:00  |   \_ smbd</span>
<span class="go">541 ?        00:00:00  |       \_ smbd-notifyd</span>
<span class="go">542 ?        00:00:00  |       \_ cleanupd</span>
<span class="go">545 ?        00:00:00  |       \_ lpqd</span>
<span class="go">523 ?        00:00:00  \_ samba</span>
<span class="go">524 ?        00:00:00  \_ samba</span>
<span class="go">525 ?        00:00:00  \_ samba</span>
<span class="go">527 ?        00:00:00  \_ samba</span>
<span class="go">528 ?        00:00:00  \_ samba</span>
<span class="go">529 ?        00:00:00  \_ samba</span>
<span class="go">530 ?        00:00:00  \_ samba</span>
<span class="go">531 ?        00:00:00  \_ samba</span>
<span class="go">532 ?        00:00:00  |   \_ winbindd</span>
<span class="go">544 ?        00:00:00  |       \_ winbindd</span>
<span class="go">533 ?        00:00:00  \_ samba</span>
<span class="go">534 ?        00:00:00  \_ samba</span>
<span class="go">535 ?        00:00:00  \_ samba</span>
<span class="go">536 ?        00:00:00  \_ samba</span>
<span class="go">[...]</span>
</pre></div>
</div>
<p>También hay formas de filtrar los procesos mostrados según distintos
criterios. Por ejemplo, para elegir los de un determinado usuario:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> ps -u josem
</pre></div>
</div>
<p>o elegir procesos por nombre:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> ps -C systemd
</pre></div>
</div>
<p>o por <abbr title="Process IDentifier">PID</abbr><a class="footnote-reference brackets" href="#id5" id="id2">2</a>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> ps <span class="m">1000</span>
</pre></div>
</div>
<p>o mostrar los procesos de un determinado padre. Para ello se debe indicar el
<abbr title="Process IDentifier">PID</abbr> del proceso padre:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> ps --ppid <span class="m">1579</span>
</pre></div>
</div>
<p><strong class="command">ps</strong> permite incluir varias opciones de filtrado:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> ps -C bash -u josem
</pre></div>
</div>
<p>incluso varias veces la misma opción:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> ps -C bash -C system
</pre></div>
</div>
<p>pero nunca acomulan el efecto de filtrado, sino el resultado. Es decir, en el
ejemplo:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> ps -C bash -u josem
</pre></div>
</div>
<p>no devuelve los procesos de <strong class="program">bash</strong> que esté ejecutando el usuario
«josem», sino cualquier proceso de <strong class="program">bash</strong> (sea o no de «josem») más
cualquier proceso que pertenezca a «josem» (sea de <strong class="program">bash</strong> o de
cualquier otro programa). En el segundo ejemplo:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> ps -C bash -C system
</pre></div>
</div>
<p>la orden devuelve cualquier proceso de <strong class="program">bash</strong> o de <a class="reference internal" href="../../04.servidor/03.init/index.html#systemd"><span class="std std-ref">systemd</span></a>. Cuando el criterio es el mismo también se puede usar esta
alternativa:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> ps -C systemd,bash
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Advertencia</p>
<p>Tenga presente que los efectos de filtro no son acomulativos.
Si su intención es aplicar varios criterios de filtrado a la vez, tendrá
que recurrir a <a class="reference internal" href="#pgrep"><span class="std std-ref">pgrep</span></a>.</p>
</div>
<p>También se puede definir exactamente qué campos se quieren obtener mediante
la opción <code class="docutils literal notranslate"><span class="pre">-o</span></code> seguida de los nombres de los campos (véase la página del
manual). Por ejemplo, esto mostraría para todos de los procesos el nombre del
usuario que lo ejecuta, el <em>pid</em>, el <em>ppid</em> y el ejecutable:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> ps -eo <span class="nv">user</span><span class="o">=</span>,pid<span class="o">=</span>,ppid<span class="o">=</span>,comm<span class="o">=</span>
</pre></div>
</div>
<p>El signo <em>igual</em>, indica que no se desea que <strong class="command">ps</strong> incluya para el
campo cabecera. Si todos los campos incluyen un igual, entonces no habrá
cabecera alguna.</p>
<p>Se pueden también ordenar los resultados con <code class="docutils literal notranslate"><span class="pre">-sort</span></code>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> ps -eo <span class="nv">user</span><span class="o">=</span>,pid<span class="o">=</span>,ppid<span class="o">=</span>,comm<span class="o">=</span> --sort ppid,pid
</pre></div>
</div>
</dd>
</dl>
<span class="target" id="pstree"></span><dl class="simple" id="index-1">
<dt><strong class="command">pstree</strong></dt><dd><p>Muestra los procesos del sistema en forma de árbol, tal como hace el comando
<a class="reference internal" href="../02.informacion/03.ficheros.html#tree"><span class="std std-ref">tree</span></a> con los directorios y ficheros. Para constituir este árbol
debe saber que todo proceso tiene un proceso padre del que deriva. Por
ejemplo, si en una sesión de <strong class="program">bash</strong> ejecutamos este comando
<strong class="command">pstree</strong>, el proceso correspondiente a éste es hijo del proceso de
<strong class="command">bash</strong>.</p>
</dd>
</dl>
<span class="target" id="pgrep"></span><dl id="index-2">
<dt><strong class="command">pgrep</strong></dt><dd><p>Permite obtener el <abbr title="Process IDentifier">PID</abbr> de un proceso atendiendo a distintos criterios.
Su uso más sencillo es obtener los <abbr title="Process IDentifier">PID</abbr> asociado al nombre de un programa.
Por ejemplo, esto devolvería todos los procesos que se corresponden con
sesiones de <strong class="program">bash</strong>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> pgrep bash
<span class="go">2966</span>
<span class="go">3004</span>
<span class="go">3084</span>
<span class="go">3588</span>
<span class="go">3811</span>
<span class="go">3967</span>
<span class="go">4368</span>
<span class="go">4546</span>
<span class="go">5529</span>
</pre></div>
</div>
<p>Puede no indicarse el nombre del programa, en cuyo caso se entenderá que
deseamos el de cualquier programa, o bien, utilizar una <a class="reference internal" href="../10.texto/01.regex.html#regex"><span class="std std-ref">expresión
regular</span></a> que nos permitirá hacer búsquedas más poderosas. Por
ejemplo, esta búsqueda:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> pgrep <span class="s1">&#39;sh$&#39;</span>
</pre></div>
</div>
<p>nos devolverá los <abbr title="Process IDentifier">PID</abbr> de todos los procesos cuyo nombre de programa acabe
en «sh».</p>
<div class="admonition warning">
<p class="admonition-title">Advertencia</p>
<p>En realidad el argumento de <strong class="command">pgrep</strong>  es simplemente un
patrón expresado en forma de  expresión regular, incluso en el primer
ejemplo:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> pgrep bash
</pre></div>
</div>
<p>Por tanto, este primer ejemplo no devuelve los <abbr title="Process IDentifier">PID</abbr> de los procesos de
:program: bash`, sino los <abbr title="Process IDentifier">PID</abbr> de cualquier programa que dentro de su
nombre incluya la cadena «bash».</p>
</div>
<p>Para filtrar los resultados podemos añadir opciones que fija criterios
adicionales. Por ejemplo:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> pgrep -u usuario
<span class="go">1223</span>
<span class="go">1300</span>
<span class="go">1311</span>
<span class="go">1328</span>
<span class="go">1380</span>
<span class="go">1387</span>
</pre></div>
</div>
<p>permite obtener los <abbr title="Process IDentifier">PID</abbr> de todos los procesos (no hemos indicado qué
programa) que pertenezcan al usuario de nombre «usuario». O bien:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> pgrep -P <span class="m">1114</span>
<span class="go">1116</span>
<span class="go">2602</span>
</pre></div>
</div>
<p>devuelve los procesos cuyo proceso padre es el proceso 1114.</p>
<p>A diferencia de <a class="reference internal" href="#ps"><span class="std std-ref">ps</span></a> los criterios de filtro son acumulativos, por
lo que si se utilizan varios, <strong class="command">pgrep</strong> sólo devolverá aquellos que
cumplan con todos. En consecuencia:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> pgrep -u usuario bash
</pre></div>
</div>
<p>devolverá los procesos de <strong class="program">bash</strong> a nombre del usuario «usuario».
Además, debe tenerse en cuenta que en las opciones (pero no en el patrón que
debe ser único), pueden indicarse varios criterios a la vez:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> pgrep -u usuario,root bash
</pre></div>
</div>
<p>que devolverá los procesos de <strong class="program">bash</strong> a nombre de «usuario» o «root».</p>
<p>Otra opción interesante es <kbd class="kbd docutils literal notranslate"><kbd class="kbd docutils literal notranslate"></kbd>-<kbd class="kbd docutils literal notranslate">c</kbd></kbd> que en vez de devolver los <abbr title="Process IDentifier">PID</abbr> de los
procesos, devuelve cuántos procesos en total. Por tanto, pasa saber cuántos
procesos está ejecutando el usuario «usuario»:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> pgrep -cu usuario
<span class="go">6</span>
</pre></div>
</div>
<p>Lamentablemente, <strong class="command">pgrep</strong> sólo devuelve el <abbr title="Process IDentifier">PID</abbr> y no una información
tan completa y configurable como <a class="reference internal" href="#ps"><span class="std std-ref">ps</span></a>.<a class="footnote-reference brackets" href="#id6" id="id3">3</a></p>
</dd>
</dl>
<span class="target" id="top"></span><dl id="index-3">
<dt><strong class="command">top</strong></dt><dd><p>Permite observar los procesos en tiempo real:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> top
</pre></div>
</div>
</dd>
</dl>
<span class="target" id="htop"></span><dl id="index-4">
<dt><strong class="command">htop</strong></dt><dd><p>Es una aplicación que mejora la interfaz de <a class="reference internal" href="#top"><span class="std std-ref">top</span></a>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> htop
</pre></div>
</div>
<p>Es probable que no esté incluida en la instalación base y requiera su
instalación explícita.</p>
</dd>
</dl>
<span class="target" id="uptime"></span><dl id="index-5">
<dt><strong class="command">uptime</strong></dt><dd><p>Muestra el tiempo trascurrido desde el arranque. el número de usuarios
conectados y la carga media del sistema en el último minuto, los cinco
últimos minutos y los quince últimos minutos:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> uptime
<span class="go">00:07:44 up 116 days, 12:15,  2 users,  load average: 0,00, 0,03, 0,09</span>
</pre></div>
</div>
<p>Tiene algunas opciones. Con <code class="docutils literal notranslate"><span class="pre">-s</span></code> da una respuesta muy parecida a <a class="reference internal" href="../05.seguridad/05a.usuarios.html#who"><span class="std std-ref">who</span></a> con la opción <code class="docutils literal notranslate"><span class="pre">-b</span></code>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> uptime -s
<span class="go">2016-09-09 12:52:12</span>
</pre></div>
</div>
</dd>
</dl>
<span class="target" id="time"></span><dl id="index-6">
<dt><strong class="command">time</strong></dt><dd><p>Permite conocer el tiempo que tarda una orden en completarse:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> <span class="nb">time</span> sleep <span class="m">2</span>

<span class="go">real    0m2.009s</span>
<span class="go">user    0m0.004s</span>
<span class="go">sys     0m0.000s</span>
</pre></div>
</div>
<p><strong>real</strong> es el tiempo trascurrido desde que comenzó la orden hasta que se
completo. <strong>user</strong> el tiempo de <abbr title="Central Processing Unit">CPU</abbr> fuera del <em>kernel</em> empleado y <strong>sys</strong>
el tiempo de <abbr title="Central Processing Unit">CPU</abbr> dentro del <strong>kernel</strong> empleado. Por tanto, la suma de las
dos últimas cantidad indica el tiempo total de <abbr title="Central Processing Unit">CPU</abbr> empleada.</p>
</dd>
</dl>
</div>
<div class="section" id="manipulacion">
<h2><span class="section-number">2.7.2.2. </span>Manipulación<a class="headerlink" href="#manipulacion" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Ya se ha explicado <a class="reference internal" href="../01.preliminares/index.html#ordenar"><span class="std std-ref">cómo dar órdenes</span></a>. Una orden provoca la
creación de un proceso durante un determiando tiempo. Ahora bien, es posible
modificar la forma en que se da la orden para lograr distintos fines.</p>
<span class="target" id="nice"></span><dl id="index-7">
<dt><strong class="command">nice</strong></dt><dd><p>Modifica la prioridad de un proceso. Cuando se ejecuta una orden, la
prioridad del proceso es <em>0</em>. Sin embargo, <strong class="command">nice</strong> permite cambiar
esta prioridad. Para usuarios distintos del administrador sólo se puede
disminuir la prioridad, es decir, dar valores positivos.</p>
<p>Para usar <strong class="command">nice</strong> basta con anteponerlo al proceso que se quiere
ejecutar. Por ejemplo:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> nice ffmpeg -i input.wmv -s hd720 -c:v libx264 -crf <span class="m">23</span> -c:a aac -strict -2 output.mp4
</pre></div>
</div>
<p>recodifica una película en calidad HD720, haciendo que para este proceso
bastante costoso disminuya la prioridad. Cuando <strong class="command">nice</strong> se usa sin
indicar la prioridad, se supone que esta es <em>10</em>. Puede especificarse la
prioridad exacta con la opción <code class="docutils literal notranslate"><span class="pre">-n</span></code>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> nice -n10 ffmpeg <span class="o">[</span>...<span class="o">]</span>
</pre></div>
</div>
<p>Valores negativos hace el proceso más prioritario de lo normal, pero deben
adjudicarse como <em>root</em>.</p>
</dd>
</dl>
<span class="target" id="renice"></span><dl id="index-8">
<dt><strong class="command">renice</strong></dt><dd><p>Modifica la prioridad de un proceso ya comenzado. Para seleccionar este
proceso necesitamos el <em>pid</em> del mismo, el cual podemos obtener a traves de
<strong class="command">ps</strong>, por ejemplo. Suponiendo que sea el <em>5789</em>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> renice -n <span class="m">10</span> -p <span class="m">5789</span>
</pre></div>
</div>
</dd>
</dl>
<span class="target" id="kill"></span><dl id="index-9">
<dt><strong class="command">kill</strong></dt><dd><p>Envía señales a los procesos, muy comúnmente para acabar con ellos, de ahí su
nombre. Hay una larga lista de señales que pueden obtenerse mediante la
opción <kbd class="kbd docutils literal notranslate"><kbd class="kbd docutils literal notranslate"></kbd>-<kbd class="kbd docutils literal notranslate">L</kbd></kbd>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> <span class="nb">kill</span> -L
<span class="go"> 1) SIGHUP       2) SIGINT       3) SIGQUIT      4) SIGILL       5) SIGTRAP</span>
<span class="go"> 6) SIGABRT      7) SIGBUS       8) SIGFPE       9) SIGKILL     10) SIGUSR1</span>
<span class="go">11) SIGSEGV     12) SIGUSR2     13) SIGPIPE     14) SIGALRM     15) SIGTERM</span>
<span class="go">16) SIGSTKFLT   17) SIGCHLD     18) SIGCONT     19) SIGSTOP     20) SIGTSTP</span>
<span class="go">21) SIGTTIN     22) SIGTTOU     23) SIGURG      24) SIGXCPU     25) SIGXFSZ</span>
<span class="go">26) SIGVTALRM   27) SIGPROF     28) SIGWINCH    29) SIGIO       30) SIGPWR</span>
<span class="go">31) SIGSYS      34) SIGRTMIN    35) SIGRTMIN+1  36) SIGRTMIN+2  37) SIGRTMIN+3</span>
<span class="go">38) SIGRTMIN+4  39) SIGRTMIN+5  40) SIGRTMIN+6  41) SIGRTMIN+7  42) SIGRTMIN+8</span>
<span class="go">43) SIGRTMIN+9  44) SIGRTMIN+10 45) SIGRTMIN+11 46) SIGRTMIN+12 47) SIGRTMIN+13</span>
<span class="go">48) SIGRTMIN+14 49) SIGRTMIN+15 50) SIGRTMAX-14 51) SIGRTMAX-13 52) SIGRTMAX-12</span>
<span class="go">53) SIGRTMAX-11 54) SIGRTMAX-10 55) SIGRTMAX-9  56) SIGRTMAX-8  57) SIGRTMAX-7</span>
<span class="go">58) SIGRTMAX-6  59) SIGRTMAX-5  60) SIGRTMAX-4  61) SIGRTMAX-3  62) SIGRTMAX-2</span>
<span class="go">63) SIGRTMAX-1  64) SIGRTMAX</span>
</pre></div>
</div>
<p>Las más usadas para acabar procesos son:</p>
<dl class="simple">
<dt><strong>SIGTERM</strong> (15)</dt><dd><p>Que le indica al proceso que haga un apagado suave e intente cerrar antes
todo los recursos que tenga abiertos. Es el apagado más recomentable,
aunque no siempre funciona, sobre todo si el proceso tiene algún hijo.
Es el apagado que <strong class="command">kill</strong> o <strong class="command">killall</strong> intentan por
defecto si no se especifica otro concreto.</p>
</dd>
<dt><strong>SIGHUP</strong> (1)</dt><dd><p><em>HUP</em> proviene de <em>hang up</em>, esto es, colgar y es la señal que recibían
los programas cuando en accesos remotos por conexión serie el usuario
decide colgar. En sistemas modernos este acceso no es tan común y la señal
se ha reciclado y significa que la terminal dentro de la que corre el
programa se ha cerrado. En bastantes programas interactivos la señal puede
tener el efecto de un apagado suavve como <em>SIGTERM</em>, pero en los
demonios, que como no son interactivos, no suelen ejecutarse en una
terminal, es común se interprete como que es necesario volver a leer la
configuración y, en consecuencia, el programa no acabe. Por tanto, si
nuestra intención es acabar un proceso de forma suave, es más recomendable
la opción anterior.</p>
</dd>
<dt><strong>SIGINT</strong> (2)</dt><dd><p>Que equivale a <kbd class="kbd docutils literal notranslate"><kbd class="kbd docutils literal notranslate">Ctrl</kbd>+<kbd class="kbd docutils literal notranslate">C</kbd></kbd> y que realiza acaba taxativamente el proceso,
aunque éste puede no hacer caso a la señal.</p>
</dd>
<dt><strong>SIGKILL</strong> (9)</dt><dd><p>Provoca el apagado obligatorio, por lo que, aunque tiene las mismas
consecuencias de la señal anterior (puede quedar algo abierto), la señal
no puede ser obviada por el proceso.</p>
</dd>
</dl>
<p>Lo habitual, cuando se intenta acabar manualmente con un proceso, es intentar
el apagado suave (<em>SIGTERM</em>) y, si este no es posible, intentar el apagado
forzoso (<em>SIGKILL</em>). Por tanto, si quisiéramos acabar con los procesos de
<abbr title="Process IDentifier">PID</abbr> 1037 y 1000, haríamos:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> <span class="nb">kill</span> <span class="m">1897</span> <span class="m">1000</span>
</pre></div>
</div>
<p>o bien:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> <span class="nb">kill</span> -15 <span class="m">1897</span> <span class="m">1000</span>
</pre></div>
</div>
<p>que es lo mismo. Y, si esto no funciona, no tendremos más remedio que hacer:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> <span class="nb">kill</span> -9 <span class="m">5675</span> <span class="m">6676</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>En ocasiones, es imposible acabar del todo con un proceso ni aun
con la señal <code class="docutils literal notranslate"><span class="pre">SIGKILL</span></code> (<em>9</em>). En estos casos, el proceso acaba en un estado
<em>zombi</em> por tiempo indefinido, que se nota con un <strong>Z</strong> al consultar el
proceso con <strong class="command">ps</strong>.</p>
</div>
</dd>
</dl>
<span class="target" id="killall"></span><dl id="index-10">
<dt><strong class="command">killall</strong></dt><dd><p>Cancela procesos identificándolos por su nombre. Pueden usarse las señales
indicadas anteriormente. Por ejemplo, esto cancela de forma suave todas las
sesiones de <strong class="program">bash</strong> abiertas por el usuario:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> killall bash
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Advertencia</p>
<p>killall es parte del <a class="reference external" href="https://packages.debian.org/search?keywords=psmisc">paquete psmisc</a>, que puede no
encontrarse instalado por defecto.</p>
</div>
</dd>
</dl>
<p>Por lo general, cuando se ejecuta una orden, la <em>shell</em> espera hasta que esta
haya acabado para liberar la línea de comandos. Esto es debido a que la orden se
ejecuta en primer plano. Arrancada de este modo, podemos escribir <kbd class="kbd docutils literal notranslate"><kbd class="kbd docutils literal notranslate">Ctrl</kbd>+<kbd class="kbd docutils literal notranslate">C</kbd></kbd>
para cancelar la orden tal como haríamos con <strong class="command">kill</strong>; pero también
podemos escribir <kbd class="kbd docutils literal notranslate"><kbd class="kbd docutils literal notranslate">Ctrl</kbd>+<kbd class="kbd docutils literal notranslate">Z</kbd></kbd> para detener la orden. Si hacemos esto segundo,
la orden deja de ejecutarse, pero no están cancelada: simplemente queda a la
espera de que demos la orden de proseguir. Por ejemplo, supongamos que hacemos
una cuenta de 1 a 10 esperando un segundo entre número y número:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> <span class="o">(</span><span class="k">for</span> i in <span class="o">{</span><span class="m">1</span>..10<span class="o">}</span><span class="p">;</span> <span class="k">do</span> sleep <span class="m">1</span><span class="p">;</span> <span class="nb">echo</span> <span class="nv">$i</span><span class="p">;</span> <span class="k">done</span><span class="o">)</span>
<span class="go">1</span>
<span class="go">^Z</span>
<span class="go">[1]+  Detenido                ( for i in {1..10};</span>
</pre></div>
</div>
<span class="target" id="jobs"></span><dl id="index-11">
<dt><strong class="command">jobs</strong></dt><dd><p>Permite consultar la lista de trabajos activos:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> <span class="nb">jobs</span>
<span class="go">[1]+  Detenido                ( for i in {1..10};</span>
</pre></div>
</div>
</dd>
</dl>
<p>Por tanto, hay una tarea detenida. Si deseamos que prosiga, hay dos
posibilidades: que mandemos que se ejecute en primer plano…</p>
<span class="target" id="fg"></span><dl id="index-12">
<dt><strong class="command">fg</strong></dt><dd><p>Manda una tarea a primer plano. Para referirse a ella se debe especificar
el número de trabajo que proporciona <strong class="command">jobs</strong>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> <span class="nb">fg</span> <span class="m">1</span>
<span class="go">2</span>
<span class="go">3</span>
<span class="go">...</span>
<span class="go">10</span>
<span class="gp">$</span>
</pre></div>
</div>
</dd>
</dl>
<p>o mandamos que se ejecute en segundo plano…</p>
<span class="target" id="bg"></span><dl id="index-13">
<dt><strong class="command">bg</strong></dt><dd><p>Manda una tarea a segundo plano. Para referirse a ella se debe especificar el
número de trabajo que proporciona <strong class="command">jobs</strong>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> <span class="nb">bg</span> <span class="m">1</span>
</pre></div>
</div>
</dd>
</dl>
<p>Es posible también ejecutar una tarea en segundo plano acabando la orden con un
<em>&amp;</em>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> sleep <span class="m">60</span> <span class="p">&amp;</span>
<span class="go">[1] 15991</span>
<span class="gp">$</span> <span class="nb">jobs</span>
<span class="go">[1]+  Ejecutando              sleep 60 &amp;</span>
</pre></div>
</div>
<p>Al ejecutar de esta forma se facilita el número de <abbr title="Process IDentifier">PID</abbr>. Es posible usar el
comando <strong class="command">kill</strong> para cancelar tareas usando el número de tarea, en vez
de el <em>pid</em>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> <span class="nb">kill</span> %1
</pre></div>
</div>
</div>
<div class="section" id="ejercicios-sobre-gestion-de-procesos">
<span id="ej-procesos"></span><h2><span class="section-number">2.7.2.3. </span>Ejercicios sobre gestión de procesos<a class="headerlink" href="#ejercicios-sobre-gestion-de-procesos" title="Enlazar permanentemente con este título">¶</a></h2>
<ol class="arabic">
<li><p>Mostrar los procesos ejecutados por el usuario «usuario».</p></li>
<li><p>Mostrar:</p>
<ol class="loweralpha simple">
<li><p>las shells que se están ejecutando en el sistema.</p></li>
<li><p>Lo mismo, pero sólo aquellas que ejecutan el usuario
«usuario» (en este segundo casa, basta con indicual
cuáles son los <abbr title="Process IDentifier">PID</abbr>)</p></li>
</ol>
</li>
<li><p>Mostrar todos los procesos ordenados por uso de la <abbr title="Central Processing Unit">CPU</abbr>.</p></li>
<li><p>Mostrar todos los procesos indicando el <abbr title="Process IDentifier">PID</abbr>, el <abbr title="User IDentifier">UID</abbr> del propietario, la
memoria utilizada, la prioridad y el comando completo.</p></li>
<li><p>¿Cúantos procesos tiene corriendo en el sistema el usuario «usuario»?</p></li>
<li><p>¿Desde cuándo lleva encencida la máquina?</p></li>
<li><p>Ejecutar el comando sleep 1000, suspenderlo y ponerlo a trabajar en segundo
plano; volverlo a traer a primer plano y, por último, cancelarlo</p></li>
<li><p>Ejecutar el comando sleep 1000, suspenderlo, ponerlo a trabajar en segundo
plano y, sin traerlo a primer plano, acabar con él.</p></li>
<li><p>Indicar qué tiempo tarda el ordenador en buscar dentro del directorio de
configuraciones el fichero dhclient.conf.</p></li>
<li><p>La orden:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> programa_muy_pesado
</pre></div>
</div>
<p>tarda mucho en ejcutarse y consume mucho procesamiento, y hace que la
película que estamos viendo mientras esperamos a que se complete, vaya a
tirones. ¿Cömo puedo ejecutarla para poder ver la película sin problemas?</p>
</li>
</ol>
<p class="rubric">Notas al pie</p>
<dl class="footnote brackets">
<dt class="label" id="id4"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p>Aunque lo habitual es verlo explicado al estilo BSD:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 31%" />
<col style="width: 69%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>BSD</p></th>
<th class="head"><p>UNIX</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="code docutils literal notranslate"><span class="pre">ax</span></code></p></td>
<td><p><code class="code docutils literal notranslate"><span class="pre">-ef</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="code docutils literal notranslate"><span class="pre">axf</span></code></p></td>
<td><p><code class="code docutils literal notranslate"><span class="pre">-ef</span> <span class="pre">--forest</span></code></p></td>
</tr>
</tbody>
</table>
</dd>
<dt class="label" id="id5"><span class="brackets"><a class="fn-backref" href="#id2">2</a></span></dt>
<dd><p>Para utilizar el criterio del <abbr title="Process IDentifier">PID</abbr> pueden utilizarse la opción
<kbd class="kbd docutils literal notranslate"><kbd class="kbd docutils literal notranslate"></kbd>-<kbd class="kbd docutils literal notranslate">p</kbd></kbd>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> ps -p <span class="m">1000</span>
</pre></div>
</div>
</dd>
<dt class="label" id="id6"><span class="brackets"><a class="fn-backref" href="#id3">3</a></span></dt>
<dd><p>Como <a class="reference internal" href="#ps"><span class="std std-ref">ps</span></a> da más posibilidades de formateo, es muy útil aunar
ambos comandos. Por ejemplo:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> ps -f -p <span class="k">$(</span>pgrep -u usuario bash<span class="k">)</span>
</pre></div>
</div>
<p>en donde hemos usado <strong class="command">pgrep</strong> para obtener la lista de <abbr title="Process IDentifier">PID</abbr> de los
procesos que nos interesan.</p>
</dd>
</dl>
</div>
</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../index.html">Tabla de contenido</a></h3>
  <ul>
<li><a class="reference internal" href="#">2.7.2. Control de procesos</a><ul>
<li><a class="reference internal" href="#consulta">2.7.2.1. Consulta</a></li>
<li><a class="reference internal" href="#manipulacion">2.7.2.2. Manipulación</a></li>
<li><a class="reference internal" href="#ejercicios-sobre-gestion-de-procesos">2.7.2.3. Ejercicios sobre gestión de procesos</a></li>
</ul>
</li>
</ul>

  <h4>Tema anterior</h4>
  <p class="topless"><a href="08.paqueteria.html"
                        title="capítulo anterior"><span class="section-number">2.7.1. </span>Gestión del software</a></p>
  <h4>Próximo tema</h4>
  <p class="topless"><a href="10.sudo.html"
                        title="próximo capítulo"><span class="section-number">2.7.3. </span>Escalada de privilegios</a></p>
  <div role="note" aria-label="source link">
    <h3>Esta página</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/02.conbas/09.admbasica/09.procesos.rst.txt"
            rel="nofollow">Mostrar el código</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Búsqueda rápida</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Ir a" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navegación</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="Índice General"
             >índice</a></li>
        <li class="right" >
          <a href="10.sudo.html" title="2.7.3. Escalada de privilegios"
             >siguiente</a> |</li>
        <li class="right" >
          <a href="08.paqueteria.html" title="2.7.1. Gestión del software"
             >anterior</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">documentación de Linuxnomicón - rolling</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" ><span class="section-number">2. </span>Conceptos básicos</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="index.html" ><span class="section-number">2.7. </span>Administración básica</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><span class="section-number">2.7.2. </span>Control de procesos</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Derechos de autor CC BY 4.0, 2016-2021, José Miguel Sánchez Alés.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 3.4.3.
    </div>
  </body>
</html>