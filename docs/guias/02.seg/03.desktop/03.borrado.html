


<!DOCTYPE html>

<html lang="es">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>3.3. Recuperación de datos &#8212; documentación de Linuxnomicón - rolling</title>
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
    
    <script id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/translations.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <link rel="index" title="Índice" href="../../../genindex.html" />
    <link rel="search" title="Búsqueda" href="../../../search.html" />
    <link rel="next" title="3.4. Software antiintrusos (antivirus)" href="04.anti.html" />
    <link rel="prev" title="3.2. Software malicioso" href="02.malware.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navegación</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="Índice General"
             accesskey="I">índice</a></li>
        <li class="right" >
          <a href="04.anti.html" title="3.4. Software antiintrusos (antivirus)"
             accesskey="N">siguiente</a> |</li>
        <li class="right" >
          <a href="02.malware.html" title="3.2. Software malicioso"
             accesskey="P">anterior</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">documentación de Linuxnomicón - rolling</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Seguridad Informática</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../03.desktop.html" accesskey="U"><span class="section-number">3. </span>Sistemas de escritorio</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><span class="section-number">3.3. </span>Recuperación de datos</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="recuperacion-de-datos">
<h1><span class="section-number">3.3. </span>Recuperación de datos<a class="headerlink" href="#recuperacion-de-datos" title="Enlazar permanentemente con este título">¶</a></h1>
<p>La recuperación de datos perdidos es, ciertamente, un asunto propio de la
<a class="reference internal" href="../02.discos/02.integridad.html#integridad-datos"><span class="std std-ref">integridad de datos</span></a> estudiada en la <a class="reference internal" href="../02.discos.html#seg-alm"><span class="std std-ref">unidad
dedicada al almacenamiento</span></a>, pero que por motivos meramente
relacionados con la evaluación<a class="footnote-reference brackets" href="#id2" id="id1">1</a> hemos reservado para esta unidad.</p>
<p>La recuperación de datos es obvio que deriva siempre de una pérdida previa,
pero dependiendo de si se tomó alguna contramedida de seguridad activa y de
cuál fuera la contramedida, se llevará a cabo de distinta forma:</p>
<ul class="simple">
<li><p>En <a class="reference internal" href="../../../05.discos/05.raid/index.html#raid"><span class="std std-ref">sistemas RAID</span></a> (siempre que el fallo no sea irrecuperable,
por supuesto) la recuperación de datos por la pérdida de un disco, es
automática en cuanto se conecta el sustituto.</p></li>
<li><p>Si se perdieron datos, pero existen <a class="reference internal" href="../../../05.discos/04.copias/01.backups.html#backups"><span class="std std-ref">copias de seguridad</span></a>, no
hay más que recurrir a estas, según el mecanismo que implemente cada
herramienta particular.</p></li>
<li><p>Por último, si para la pérdida no hay contramedida ninguna, entonces
aún puede intentarse la recuperación de los datos sobre el soporte original,
para lo cual habrá que distinguir entre:</p>
<ul>
<li><p><em>Fallos de disco</em>, que derivan en la imposibilidad de la lectura.</p></li>
<li><p><em>Borrados accidentales</em>.</p></li>
</ul>
</li>
</ul>
<p>Es a esta última circunstancia en la que no se previó mecanismo de salvaguarda de los datos, a la que está dedicado el texto del epígrafe.</p>
<div class="section" id="fallos-de-disco">
<h2><span class="section-number">3.3.1. </span>Fallos de disco<a class="headerlink" href="#fallos-de-disco" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Cuando un disco falla físicamente, todos los datos de la partición o del disco
entero resultan inaccesibles. Hay dos casos:</p>
<ul class="simple">
<li><p><strong>Fallo completo</strong> de disco que lo dejan absolutamente inutilizado y que
requieran la intervención de una empresa especializada en recuperación de
datos.</p></li>
<li><p><strong>Fallos parciales</strong> que afectan sólo a un número limitado de sectores. En
estos casos, es posible recuperar toda o parte de la información por medios
ordinarios, aunque la resolución depende de qué información contuvieran estos
sectores:</p>
<ul>
<li><p>Los sectores pueden almacenar información sobre el particionado de disco y
en ese caso, las particiones serán inaccesibles y, en consecuencia, todos
los datos que contengan, también. En estos casos, puede que valga con
recuperar la copia (en particionado <abbr title="Guid Partition Table">GPT</abbr>) o quizás haya que hacer una
inspección del disco con una herramienta especializada como <a class="reference internal" href="../../../05.discos/08.recup/index.html#testdisk"><span class="std std-ref">testdisk</span></a> para adivinar cuáles eran estas particiones.</p></li>
<li><p>Pueden ser sectores que almacenen metainformación de un sistema de archivos.
En ese caso, habrá que recurrir a herramientas específicas de tal sistema de
archivo como se ilustra en la <a class="reference internal" href="../../../05.discos/08.recup/index.html#superbloque-danado"><span class="std std-ref">recuperación del superbloque de un
sistema ext4</span></a>.</p></li>
<li><p>Por último, los sectores pueden contener información. En ese caso, el propio
sistema de archivos proveerá de alguna herramienta para desechar esos
sectores, aunque sea a costa de perder el archivo que contuviera. Véase
<a class="reference internal" href="../../../05.discos/08.recup/index.html#bloques-datos-danados"><span class="std std-ref">como recuperarlos en ext4</span></a>.</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="borrados-accidentales">
<h2><span class="section-number">3.3.2. </span>Borrados accidentales<a class="headerlink" href="#borrados-accidentales" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Hasta <em>el mejor escribano echa un borrón</em>… Es común que por equivocación se borre algún archivo que, en realidad, no quisiéramos borrar. Para evitar estas situaciones los sistemas operativos suelen habilitar una «Papelera», esto es, un lugar en el que se almacenan los archivos borrados. Funciona más o menos del siguiente modo:</p>
<ul>
<li><p>El archivo no es, en realidad, borrado del sistema de archivos, sino
simplemente trasladado a un directorio oculto (la <em>Papelera</em>) en donde es
almacenado.</p></li>
<li><p>El <em>software</em> asociado a esta función no se limita a trasladar el archivo sino  que:</p>
<ul class="simple">
<li><p>Guarda la memoria de la ubicación original para que en caso de que se
quiera recuperar el archivo, éste se encuentre allí donde se encontraba
cuando se borró.</p></li>
<li><p>Mantiene la «Papelera» por debajo de un tamaño máximo configurable, de modo
que, si es necesario para no sobrepasar este límite, borra definitivamente
archivos tomando primero aquellos con una fecha de borrado anterior.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>En <em>Linux</em>, los escritorios más habituales (<a class="reference external" href="https://www.gnome.org">Gnome</a>, <a class="reference external" href="https://kde.org">KDE</a>, <a class="reference external" href="http://www.lxde.org">LXDE</a>,
<a class="reference external" href="https://xfce.org">XFCE</a>) disponen de Papelera. En <em>Windows</em> también existe.</p>
</div>
</li>
</ul>
<p>Por tanto, para recuperar el archivo no hay más que acudir a la «Papelera».
Sin embargo, el borrado puede haber sido efectivo (bien porque se borró el
archivo de la propia «Papelera», bien porque se fuerza su borrado sin pasar por
esta, bien porque se usa la <abbr title="Command Line Interface">CLI</abbr>), y entonces ¿hay forma de recuperar el archivo? La respuesta es «quizás»:</p>
<p>Cuando un archivo es borrado del sistema de archivos, sus datos (los bloques de
disco asociados) no se sobrescriben de inmediato. Simplemente, se libera el espacio para que futuros archivos puedan ocupar esos bloques. Por tanto, si intentamos la recuperación del archivo antes que estos bloques vuelvan a ocuparse, podremos obtener de nuevo el archivo. Así pues:</p>
<ul>
<li><p>Se requerirá una herramienta especializada en buscar el archivo borrado en
los metadatos del sistema de archivos:</p>
<dl class="simple">
<dt><strong>FAT32</strong></dt><dd><ul class="simple">
<li><p><a class="reference internal" href="../../../05.discos/08.recup/index.html#testdisk"><span class="std std-ref">testdisk</span></a>.</p></li>
<li><p><a class="reference external" href="https://sourceforge.net/projects/kickassundelete">Kickass Undelete</a> (<em>Windows</em>).</p></li>
</ul>
</dd>
<dt><strong>NTFS</strong></dt><dd><ul class="simple">
<li><p><a class="reference internal" href="../../../05.discos/08.recup/index.html#testdisk"><span class="std std-ref">testdisk</span></a>.</p></li>
<li><p><strong class="command">ntfsundelete</strong> (del paquete <em>ntfs-3g</em>).</p></li>
<li><p><a class="reference external" href="https://sourceforge.net/projects/kickassundelete">Kickass Undelete</a> (<em>Windows</em>).</p></li>
</ul>
</dd>
<dt><strong>EXT4</strong></dt><dd><ul class="simple">
<li><p><a class="reference internal" href="../../../05.discos/08.recup/index.html#testdisk"><span class="std std-ref">testdisk</span></a>.</p></li>
<li><p><a class="reference internal" href="../../../05.discos/08.recup/index.html#extundelete-1"><span class="std std-ref">extundelete</span></a>.</p></li>
<li><p><a class="reference internal" href="../../../05.discos/08.recup/index.html#ext3grep-1"><span class="std std-ref">ext3grep</span></a>.</p></li>
<li><p><a class="reference internal" href="../../../05.discos/08.recup/index.html#ext4magic"><span class="std std-ref">ext4magic</span></a>.</p></li>
</ul>
</dd>
</dl>
</li>
<li><p>La recuperación será tanto más probable cuantas menos operaciones de escritura
se hayan hecho desde el borrado del archivo. A este efecto, es muy útil que
los datos de usuario se almacenen en una partición distinta a la del sistema
operativo, puesto que la herramienta no suele estar ya instalada y su
instalación requiere escribir en disco. Si las particiones están separadas, la
instalación no implicará ninguna operación de escritura sobre el sistema de
archivos del que queremos recuperar archivos.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p><a class="reference external" href="https://gparted.org">GParted</a> Live además del propio particionador, incluye, entre otras
aplicaciones, <a class="reference internal" href="../../../05.discos/08.recup/index.html#testdisk"><span class="std std-ref">testdisk</span></a>, con lo que es también una excelente
herramienta no sólo para manipular particiones, sino también para recuperar
archivos (y particiones).</p>
</div>
</div>
<div class="section" id="ejercicios-de-recuperacion-de-particiones">
<h2><span class="section-number">3.3.3. </span>Ejercicios de recuperación de particiones<a class="headerlink" href="#ejercicios-de-recuperacion-de-particiones" title="Enlazar permanentemente con este título">¶</a></h2>
<ol class="arabic">
<li><p>En una máquina virtual cree un disco de 50GiB, arranque con la <em>ISO</em> de
<strong class="program">Gparted</strong> y:</p>
<ol class="loweralpha">
<li><p>Haga las siguientes <a class="reference internal" href="../../../05.discos/01.division/01.part.html#part-dos"><span class="std std-ref">particiones DOS</span></a>:</p>
<ul class="simple">
<li><p>Una partición de 10GiB para un sistema que corre <em>Linux</em>.</p></li>
<li><p>Una partición de 10GiB para datos de Linux, pero con <em>XFS</em>.</p></li>
<li><p>Una partición lógica de 3 GiB formateada en <em>FAT32</em>.</p></li>
<li><p>Una partición lógica para <em>Windows</em> 7 que ocupe el resto..</p></li>
</ul>
</li>
<li><p>Cree un fichero en cada una de esas particiones con el texto que usted
estime oportuno.</p></li>
<li><p><em>Recuerde</em> la tabla de particiones creada.</p>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>Lo más adecuado es que recurra a la terminal y usando un
<a class="reference internal" href="../../../05.discos/01.division/03.pract.html#fdisk"><span class="std std-ref">fdisk</span></a> la guarde en un  fichero de texto. Recuerde que
puede consultar la tabla de particiones con esta orden mediante:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">#</span> fdisk -l /dev/sda
</pre></div>
</div>
</div>
</li>
<li><p>Elimine la tabla de particiones. Como la tabla de particiones se guarda
en el <abbr title="Master Boot Record">MBR</abbr>, basta con que rellene con ceros ese primer byte:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">#</span> dd &lt; /dev/zero &gt; /dev/sda <span class="nv">bs</span><span class="o">=</span><span class="m">512</span> <span class="nv">count</span><span class="o">=</span><span class="m">1</span>
</pre></div>
</div>
</li>
<li><p>Compruebe que ya no hay particiones en el disco.</p></li>
<li><p>Utilice <a class="reference internal" href="../../../05.discos/08.recup/index.html#testdisk"><span class="std std-ref">testdisk</span></a> para recuperar la tabla de particiones.</p></li>
<li><p>Compruebe de nuevo la tabla de particiones. ¿Es la misma?</p></li>
<li><p>Monte los cuatro sistemas de archivos y vea si se encuentra el fichero y
su contenido. ¿Ha sobrevivido la información?</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>El primer paso puede justificarlo mediante una captura del
resultado obtenido en <strong class="program">Gparted</strong>. Para las restantes puede copiar
las órdenes en línea usadas.</p>
</div>
</li>
<li><p>Haga lo mismo pero utilizando <a class="reference internal" href="../../../05.discos/01.division/01.part.html#part-gpt"><span class="std std-ref">particionado GPT</span></a>. En este
caso, tenga en cuenta lo siguiente:</p>
<ul class="simple">
<li><p>Como el particionado es <abbr title="Guid Partition Table">GPT</abbr> utilice <a class="reference internal" href="../../../05.discos/01.division/03.pract.html#gdisk-i"><span class="std std-ref">gdisk</span></a> en vez de
<strong class="command">fdisk</strong>.</p></li>
<li><p>Al eliminar la tabla de particiones:</p>
<ul>
<li><p>Pruebe primero a borrar exclusivamente la tabla de particiones y no los
dos primeros <em>bytes</em>. ¿Qué ocurre?</p></li>
<li><p>Borre también estos dos primeros <em>bytes</em>. ¿Queda aún información sobre
las particiones en algún sitio? Prueba a ver si <strong class="command">gdisk</strong> es capaz
de rehacer las particiones.</p></li>
</ul>
</li>
</ul>
</li>
</ol>
<p class="rubric">Notas al pie</p>
<dl class="footnote brackets">
<dt class="label" id="id2"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p>La recuperación de datos aparece incompresiblemente como criterio de
evaluación del <strong>RA3</strong> relativo a seguridad activa, el cual se desarrolla
enteramente con esta unidad.</p>
</dd>
</dl>
</div>
</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../../index.html">Tabla de contenido</a></h3>
  <ul>
<li><a class="reference internal" href="#">3.3. Recuperación de datos</a><ul>
<li><a class="reference internal" href="#fallos-de-disco">3.3.1. Fallos de disco</a></li>
<li><a class="reference internal" href="#borrados-accidentales">3.3.2. Borrados accidentales</a></li>
<li><a class="reference internal" href="#ejercicios-de-recuperacion-de-particiones">3.3.3. Ejercicios de recuperación de particiones</a></li>
</ul>
</li>
</ul>

  <h4>Tema anterior</h4>
  <p class="topless"><a href="02.malware.html"
                        title="capítulo anterior"><span class="section-number">3.2. </span>Software malicioso</a></p>
  <h4>Próximo tema</h4>
  <p class="topless"><a href="04.anti.html"
                        title="próximo capítulo"><span class="section-number">3.4. </span>Software antiintrusos (antivirus)</a></p>
  <div role="note" aria-label="source link">
    <h3>Esta página</h3>
    <ul class="this-page-menu">
      <li><a href="../../../_sources/guias/02.seg/03.desktop/03.borrado.rst.txt"
            rel="nofollow">Mostrar el código</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Búsqueda rápida</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Ir a" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navegación</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="Índice General"
             >índice</a></li>
        <li class="right" >
          <a href="04.anti.html" title="3.4. Software antiintrusos (antivirus)"
             >siguiente</a> |</li>
        <li class="right" >
          <a href="02.malware.html" title="3.2. Software malicioso"
             >anterior</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">documentación de Linuxnomicón - rolling</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Seguridad Informática</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../03.desktop.html" ><span class="section-number">3. </span>Sistemas de escritorio</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><span class="section-number">3.3. </span>Recuperación de datos</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Derechos de autor CC BY 4.0, 2016-2021, José Miguel Sánchez Alés.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 3.4.3.
    </div>
  </body>
</html>