


<!DOCTYPE html>

<html lang="es">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>9.1.3.4. Protocolos seguros de red &#8212; documentación de Linuxnomicón - rolling</title>
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/custom.css" type="text/css" />
    
    <script id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/translations.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <link rel="index" title="Índice" href="../../../genindex.html" />
    <link rel="search" title="Búsqueda" href="../../../search.html" />
    <link rel="next" title="9.1.3.5. Autenticación" href="05.auth.html" />
    <link rel="prev" title="9.1.3.3. Correo electrónico" href="03.correo.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navegación</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="Índice General"
             accesskey="I">índice</a></li>
        <li class="right" >
          <a href="05.auth.html" title="9.1.3.5. Autenticación"
             accesskey="N">siguiente</a> |</li>
        <li class="right" >
          <a href="03.correo.html" title="9.1.3.3. Correo electrónico"
             accesskey="P">anterior</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">documentación de Linuxnomicón - rolling</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" ><span class="section-number">9. </span>Apéndices</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../index.html" ><span class="section-number">9.1. </span>Criptografía</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../03.aplicaciones.html" accesskey="U"><span class="section-number">9.1.3. </span>Aplicaciones de la criptografía</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><span class="section-number">9.1.3.4. </span>Protocolos seguros de red</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="protocolos-seguros-de-red">
<span id="proto-seguro"></span><h1><span class="section-number">9.1.3.4. </span>Protocolos seguros de red<a class="headerlink" href="#protocolos-seguros-de-red" title="Enlazar permanentemente con este título">¶</a></h1>
<p>Para la comunicación segura entre extremos se han desarrollado distintos protocolos
que recurren al <a class="reference internal" href="../02.algo.html#hibrido"><span class="std std-ref">cifrado híbrido</span></a>. Todos los protocolos modernos
incluyen la seguridad en su diseño, pero para asegurar antiguos carentes de
ella, nació <a class="reference internal" href="#ssl"><span class="std std-ref">SSL</span></a> que es tan sólo un protocolo que permite crear un
canal seguro sobre el que puedan actuar protocolos inseguros.</p>
<div class="section" id="ssl-tls">
<span id="ssl"></span><h2><span class="section-number">9.1.3.4.1. </span><abbr title="Secure Socket Layer">SSL</abbr>/<abbr title="Transport Layer Security">TLS</abbr><a class="headerlink" href="#ssl-tls" title="Enlazar permanentemente con este título">¶</a></h2>
<p>En realidad son el mismo protocolo, ya que <abbr title="Transport Layer Security">TLS</abbr> es el sucesor de <abbr title="Secure Socket Layer">SSL</abbr>, aunque
es común que se le siga denominando <abbr title="Secure Socket Layer">SSL</abbr>. Básicamente es un protocolo que
permite encapsular de modo seguro otro protocolo de red. Surgió en 1994 para
encapsular el protocolo <abbr title="HyperText Transfer Protocol">HTTP</abbr> (y crear <abbr title="HyperText Transfer Protocol">HTTP</abbr>s) en los navegadores <a class="reference external" href="https://es.wikipedia.org/wiki/Netscape_">Netscape</a>.</p>
<p><abbr title="Secure Socket Layer">SSL</abbr> es independiente del protocolo no seguro que cifre y, simplemente,
establece un encapsulamiento cifrado bajo el cual circula el protocolo plano sin
modificaciones. Su funcionamiento básicamente es el siguiente:</p>
<ul class="simple">
<li><p>Los extremos establecen la conexión segura intercambiando las claves según lo
explicado en el cifrado híbrido, de manera que cuando la clave simétrica se
encuentra en ambos extremos, el túnel está listo para funcionar.</p></li>
<li><p>En el cliente, la comunicación en el protocolo arbitrario se cifra gracias a
<abbr title="Secure Socket Layer">SSL</abbr> y se envía al servidor donde el protocolo <abbr title="Secure Socket Layer">SSL</abbr> se encarga de descifrar
y entregar la comunicación en claro al servidor.</p></li>
<li><p>La respuesta del servidor se cifra, se envía a través de la red, y al llegar
al cliente, se descifra y se entrega al cliente.</p></li>
</ul>
<p>Podemos pues considerar al protocolo <abbr title="Secure Socket Layer">SSL</abbr> como un mero intérprete que se
encarga de cifrar la comunicación al salir y descifrarla al entrar.</p>
<img alt="../../../_images/ssl.png" src="../../../_images/ssl.png" />
<p>Por tanto, servidor y cliente siguen comunicándose a través del mismo protocolo
en claro. Lo que suele ocurrir, no obstante, es que ambos, servidor y cliente,
lleven incorporada la capacidad de cifrar con <abbr title="Secure Socket Layer">SSL</abbr>. Por ejemplo, en una
comunicación <abbr title="HyperText Transfer Protocol">HTTP</abbr>s, que no es más que <abbr title="HyperText Transfer Protocol">HTTP</abbr> sobre <abbr title="Secure Socket Layer">SSL</abbr>, se comunican
directamente navegador con servidor web, porque son ellos dos mismos lo que
también cifran y descifran. Sin embargo, esto no tiene por qué ser así. Es
bastante común el siguiente esquema:</p>
<img alt="../../../_images/https.png" src="../../../_images/https.png" />
<p>en el que no es el servidor web el que cifra usando el protocolo <abbr title="Secure Socket Layer">SSL</abbr>, sino un
proxy web intermedio. Este proxy web inverso, se encuentra en la misma máquina
que el servidor o en una máquina de la misma red, por lo que no se compromete la
seguridad y facilita que se pueda colocar entre él y el servidor web, un proxy
de cacheo como <a class="reference external" href="https://varnish-cache.org/">varnish</a> que, con una buena política, permite agilizar el
servicio de páginas dinámicas.</p>
<p><abbr title="Secure Socket Layer">SSL</abbr> usa  <a class="reference internal" href="01.certdig.html#cert-digital"><span class="std std-ref">certificados digitales X.509</span></a>. que, además,
de contribuir al cifrado, permiten al cliente confirmar la identidad del
servidor.</p>
<div class="admonition seealso">
<p class="admonition-title">Ver también</p>
<p>Consulte cómo <a class="reference internal" href="../../../07.serre/02.web/02.nginx/02.avanz/07.https.html#certbot"><span class="std std-ref">obtener un certificado de servidor válido con
Let’s Encrypt</span></a>.</p>
</div>
<div class="section" id="sni">
<span id="id1"></span><h3><span class="section-number">9.1.3.4.1.1. </span><abbr title="Server Name Indication">SNI</abbr><a class="headerlink" href="#sni" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Al cifrar <abbr title="Transport Layer Security">TLS</abbr> por completo el protocolo subyacente, es preciso que opere el
certificado antes de poder acceder a cualquier información de capa de
aplicación. Esto supone un problema cuando un servidor maneja varios
certificados, cada uno asociado a un nombre de máquina, y se precisa conocer de
antemano qué nombre ha utilizado el cliente al hacer la petición para que el
servidor utilice el certificado correspondiente. En este caso, no hay modo de
saber el nombre sin descifrar y no se puede descifrar hasta no conocer cuál es
el nombre de máquina.</p>
<p>Para sortear este inconveniente se creó la extensión <abbr title="Server Name Indication">SNI</abbr>, que permite incluir
sin cifrar el nombre de la máquina a la que se conecta el cliente, de modo que
el servidor pueda escoger el certificado adecuado. Todos los navegadores
modernos soportan esta extensión.</p>
</div>
<div class="section" id="starttls">
<span id="id2"></span><h3><span class="section-number">9.1.3.4.1.2. </span>STARTTLS<a class="headerlink" href="#starttls" title="Enlazar permanentemente con este título">¶</a></h3>
<p>El uso de <abbr title="Secure Socket Layer">SSL</abbr> tiene, sin embargo, un inconveniente: al tener que establecerse
previamente el túnel seguro, dentro del cual circula el protocolo en claro, es
necesario utilizar un puerto distinto de escucha, ya que o se escucha para
establecer una comunicación con el protocolo en claro o se escucha para
establecer un canal seguro. Esa es la razón por la que los servidores web
escuchan habitualmente en el puerto <strong>80</strong> (<abbr title="HyperText Transfer Protocol">HTTP</abbr>) y en el puerto <strong>443</strong>
(<abbr title="HyperText Transfer Protocol">HTTP</abbr>s).</p>
<table class="starttls docutils align-default" id="id5">
<caption><span class="caption-text"><strong>Puertos de escucha</strong></span><a class="headerlink" href="#id5" title="Enlace permanente a esta tabla">¶</a></caption>
<colgroup>
<col style="width: 23%" />
<col style="width: 21%" />
<col style="width: 56%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Puerto original</p></th>
<th class="head"><p>Puerto seguro</p></th>
<th class="head"><p>Propósito</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><abbr title="Simple Mail Transfer Protocol">SMTP</abbr>/25</p></td>
<td><p><abbr title="Simple Mail Transfer Protocol">SMTP</abbr>S/465</p></td>
<td><p>Envío de correo electrónico.</p></td>
</tr>
<tr class="row-odd"><td><p><abbr title="HyperText Transfer Protocol">HTTP</abbr>/80</p></td>
<td><p><abbr title="HyperText Transfer Protocol">HTTP</abbr>S/443</p></td>
<td><p>Servicio web.</p></td>
</tr>
<tr class="row-even"><td><p><abbr title="Post Office Protocol v3">POP3</abbr>/110</p></td>
<td><p><abbr title="Post Office Protocol v3">POP3</abbr>S/995</p></td>
<td><p>Buzón de correo electrónico.</p></td>
</tr>
<tr class="row-odd"><td><p><abbr title="Internet Message Access Protocol">IMAP</abbr>/143</p></td>
<td><p><abbr title="Internet Message Access Protocol">IMAP</abbr>S/993</p></td>
<td><p>Buzón de correo electrónico.</p></td>
</tr>
<tr class="row-even"><td><p><abbr title="Lightweight Directory Access Protocol">LDAP</abbr>/389</p></td>
<td><p><abbr title="Lightweight Directory Access Protocol">LDAP</abbr>S/636</p></td>
<td><p>Servicio de directorio.</p></td>
</tr>
</tbody>
</table>
<p>Para evitarlo, se ideó <em class="dfn">STARTTLS</em> que es una extensión para los protocolos
en claro (<abbr title="Simple Mail Transfer Protocol">SMTP</abbr>, <abbr title="Internet Message Access Protocol">IMAP</abbr>, <abbr title="Lightweight Directory Access Protocol">LDAP</abbr>, etc.) que permite negociar el cifrado, de
manera que servidor y cliente establecen comunicación con el protocolo
correspondiente y negocian para que la comunicación pase a cifrarse con <abbr title="Secure Socket Layer">SSL</abbr>.
Gracias a ello, no es necesario ocupar dos puertos distintos y la comunicación,
segura o no, puede realizarse siempre por el puerto tradicional. No obstante:</p>
<ul class="simple">
<li><p>A diferencia de lo que ocurre en el resto de protocolos, en la comunicación
web, sigue sin usarse STARTTLS. En los demás, se ha ido abandonando el uso del
protocolo seguro por la negociación del cifrado.</p></li>
<li><p>En el protocolo <abbr title="Simple Mail Transfer Protocol">SMTP</abbr> suelen usarse dos puertos: el <strong>25</strong> para comunicación
entre servidores, por lo general, sin autenticación; y el <strong>587</strong> para
comunicación con autenticación cliente-servidor. En cualquier caso, nada tiene
que ver esto con el cifrado, puesto que en ambos puertos se suele habilitar la
negociación del cifrado mediante STARTTLS.</p></li>
</ul>
</div>
<div class="section" id="pruebas-practicas">
<h3><span class="section-number">9.1.3.4.1.3. </span>Pruebas prácticas<a class="headerlink" href="#pruebas-practicas" title="Enlazar permanentemente con este título">¶</a></h3>
<div class="admonition-todo admonition" id="id3">
<p class="admonition-title">Por hacer</p>
<p>Reformar esto para usar <a class="reference external" href="https://manpages.debian.org/buster/openssl/s_server.1ssl.en.html">openssL s_server</a>.
stunnel debería dejarse para la sección de proxies e incluir aquí
simplemente una referencia.</p>
</div>
<p>Es posible ilustrar cómo funciona el protocolo <abbr title="Secure Socket Layer">SSL</abbr> en servidores con algunas
órdenes sencillas. Por ejemplo, para comunicarnos sin cifrado a un servidor que
usa un protocolo en claro, podemos usar, simplemente, <strong class="command">telnet</strong>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> telnet smtp.gmail.com <span class="m">587</span>
<span class="go">Trying 108.177.15.108...</span>
<span class="go">Connected to gmail-smtp-msa.l.google.com.</span>
<span class="go">Escape character is &#39;^]&#39;.</span>
<span class="go">220 smtp.gmail.com ESMTP r12sm6291342wrq.3 - gsmtp</span>
<span class="hll"><span class="go">EHLO localhost</span>
</span><span class="go">250-smtp.gmail.com at your service, [81.0.56.71]</span>
<span class="go">250-SIZE 35882577</span>
<span class="go">250-8BITMIME</span>
<span class="go">250-STARTTLS</span>
<span class="go">250-ENHANCEDSTATUSCODES</span>
<span class="go">250-PIPELINING</span>
<span class="go">250-CHUNKING</span>
<span class="go">250 SMTPUTF8</span>
<span class="hll"><span class="go">QUIT</span>
</span><span class="go">221 2.0.0 closing connection r12sm6291342wrq.3 - gsmtp</span>
<span class="go">Connection closed by foreign host.</span>
</pre></div>
</div>
<p>Si queremos conectarnos usando <abbr title="Secure Socket Layer">SSL</abbr> para que previamente se establezca el canal
seguro, podemos usar <strong class="command">openssl</strong>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> openssl s_client -connect smtp.gmail.com:465 -quiet
<span class="go">depth=2 OU = GlobalSign Root CA - R2, O = GlobalSign, CN = GlobalSign</span>
<span class="go">verify return:1</span>
<span class="go">depth=1 C = US, O = Google Trust Services, CN = Google Internet Authority G3</span>
<span class="go">verify return:1</span>
<span class="go">depth=0 C = US, ST = California, L = Mountain View, O = Google LLC, CN =</span>
<span class="go">smtp.gmail.com</span>
<span class="go">verify return:1</span>
<span class="go">220 smtp.gmail.com ESMTP h16sm24225437wrb.62 - gsmtp</span>
<span class="hll"><span class="go">EHLO localhost</span>
</span><span class="go">250-smtp.gmail.com at your service, [81.0.56.71]</span>
<span class="go">250-SIZE 35882577</span>
<span class="go">250-8BITMIME</span>
<span class="go">250-AUTH LOGIN PLAIN XOAUTH2 PLAIN-CLIENTTOKEN OAUTHBEARER XOAUTH</span>
<span class="go">250-ENHANCEDSTATUSCODES</span>
<span class="go">250-PIPELINING</span>
<span class="go">250-CHUNKING</span>
<span class="go">250 SMTPUTF8</span>
<span class="hll"><span class="go">QUIT</span>
</span><span class="go">221 2.0.0 closing connection h16sm24225437wrb.62 - gsmtp</span>
<span class="go">read:errno=0</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>Para incluir <abbr title="Server Name Indication">SNI</abbr> en la petición de <strong class="program">openssl</strong> puede añadirse
la opción <kbd class="kbd docutils literal notranslate"><kbd class="kbd docutils literal notranslate"></kbd>-<kbd class="kbd docutils literal notranslate">servername</kbd> <kbd class="kbd docutils literal notranslate">smtp.gmail.com</kbd></kbd>.</p>
</div>
<p>Si, por el contrario, queremos negociar el establecimiento del cifrado con
STARTTLS, podemos usar también <strong class="command">openssl</strong> indicándole que use STARTTLS:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> openssl s_client -connect smtp.gmail.com:587 -starttls smtp -quiet
<span class="go">depth=2 OU = GlobalSign Root CA - R2, O = GlobalSign, CN = GlobalSign</span>
<span class="go">verify return:1</span>
<span class="go">depth=1 C = US, O = Google Trust Services, CN = Google Internet Authority G3</span>
<span class="go">verify return:1</span>
<span class="go">depth=0 C = US, ST = California, L = Mountain View, O = Google LLC, CN =</span>
<span class="go">smtp.gmail.com</span>
<span class="go">verify return:1</span>
<span class="go">250 SMTPUTF8</span>
<span class="hll"><span class="go">EHLO localhost</span>
</span><span class="go">250-smtp.gmail.com at your service, [81.0.56.71]</span>
<span class="go">250-SIZE 35882577</span>
<span class="go">250-8BITMIME</span>
<span class="go">250-AUTH LOGIN PLAIN XOAUTH2 PLAIN-CLIENTTOKEN OAUTHBEARER XOAUTH</span>
<span class="go">250-ENHANCEDSTATUSCODES</span>
<span class="go">250-PIPELINING</span>
<span class="go">250-CHUNKING</span>
<span class="go">250 SMTPUTF8</span>
<span class="hll"><span class="go">QUIT</span>
</span><span class="go">221 2.0.0 closing connection 200sm9064552wmw.31 - gsmtp</span>
<span class="go">read:errno=0</span>
</pre></div>
</div>
<p class="rubric" id="stunnel">stunnel</p>
<p>Podemos ilustrar cómo <abbr title="Secure Socket Layer">SSL</abbr> cifra con independencia del protocolo en claro,
utilizando el <a class="reference external" href="https://www.stunnel.org/">proxy stunnel</a> y <a class="reference internal" href="../../../02.conbas/99.misc/05.ordenes.html#netcat"><span class="std std-ref">netcat</span></a>. Es obvio que sí hacemos
en una máquina servidor:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> nc -l -p <span class="m">12345</span>
</pre></div>
</div>
<p>y en otra cliente:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> telnet servidor <span class="m">12345</span>
</pre></div>
</div>
<p>podremos establecer un diálogo entre ambas máquinas. El diálogo viajará
absolutamente en claro:</p>
<img alt="../../../_images/nc-claro.png" src="../../../_images/nc-claro.png" />
<p>Pero podemos interponer <strong class="program">stunnel</strong> para que se encargue de cifrar la
comunicación en ambos extremos:</p>
<img alt="../../../_images/nc-cifrado.png" src="../../../_images/nc-cifrado.png" />
<p>De esta forma, el cliente se comunica con la parte cliente de
<strong class="program">stunnel</strong>, éste con su parte servidor y, finalmente, esta parte servidor
con el <strong class="program">netcat</strong> servidor.</p>
<p>Como en el <strong>servidor</strong> necesitaremos un certificado, debemos instalar:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">#</span> apt install stunnel4 ssl-cert
</pre></div>
</div>
<p>y lo usamos para crear un certificado autofirmado:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">#</span> make-ssl-cert /usr/share/ssl-cert/ssleay.cnf /etc/stunnel/stunnel.pem
</pre></div>
</div>
<p>Hecho lo cual, podemos crear esta configuración dentro de
<code class="file docutils literal notranslate"><span class="pre">/etc/stunnel/nc.conf</span></code> (el nombre es irrelevante: basta con su extensión
sea <em>.conf</em>):</p>
<div class="highlight-ini notranslate"><div class="highlight"><pre><span></span><span class="k">[netcat-ssl]</span>
<span class="na">cert</span> <span class="o">=</span> <span class="s">/etc/stunnel/stunnel.pem</span>
<span class="na">accept</span> <span class="o">=</span> <span class="s">IP.DEL.SERVIDOR:12345</span>
<span class="na">connect</span> <span class="o">=</span> <span class="s">127.0.0.1:12345</span>
</pre></div>
</div>
<p>De esta forma, <strong class="program">stunnel</strong> acepta datos cifrados en el puerto <strong>12345</strong>
de la interfaz real, los descifra y los entrega en claro en el mismo puerto de
la interfaz de <em>loopback</em>. En el sentido inverso, recibe datos en claro
procedentes de esta interfaz y los cifra antes de enviarlos al cliente.</p>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>En <em>Stretch</em> es necesario también habilitar explícitamente el
servicio editando el fichero <code class="file docutils literal notranslate"><span class="pre">/etc/default/stunnel4</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">ENABLED</span><span class="o">=</span><span class="m">1</span>
</pre></div>
</div>
</div>
<p>Hecha la configuración, podemos reiniciar el servicio:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">#</span> invoke-rc.d stunnel4 restart
</pre></div>
</div>
<p>Además debemos ejecutar <strong class="command">netcat</strong>, haciendo que escuche únicamente en la
interfaz de <em>loopback</em>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">#</span> nc -l -p <span class="m">12345</span> -s <span class="m">127</span>.0.0.1
</pre></div>
</div>
<p>En el <strong>cliente</strong> debemos también instalar <strong class="program">stunnel</strong> y arrancarlo con
esta configuración:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">[netcat-ssl]</span>
<span class="go">client = yes</span>
<span class="go">accept = 127.0.0.1:12345</span>
<span class="go">connect = IP.DEL.SERVIDOR:12345</span>
</pre></div>
</div>
<p>Finalmente, para comunicarnos de modo seguro con el <strong class="command">netcat</strong> servidor,
conectamos <strong class="command">telnet</strong> al <strong class="program">stunnel</strong> cliente:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">#</span> telnet localhost <span class="m">12345</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>En este caso, en que simplemente establecemos una sesión cruda con el
servidor, podríamos habernos ahorrado la instalación de <strong class="program">stunnel</strong> en
el cliente y haber usado <strong class="command">openssl</strong>, que es capaz de hacer el
proceso de cifrado, además de habilitar la conversación cruda:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">#</span> openssl s_client -connect IP.DEL.SERVIDOR:12345 -quiet
</pre></div>
</div>
</div>
<div class="admonition warning">
<p class="admonition-title">Advertencia</p>
<p>Aunque la comunicación se lleva a cabo perfectamente, hay, sin
embargo, una muy grande diferencia respecto a cuando hicimos la conexión
directa (y sin cifrar): el <strong class="program">netcat</strong> servidor siempre conecta con el
<strong class="program">stunnel</strong> local con lo que para él todas las conexiones son locales
y desconoce por completo cuál es la <abbr title="Internet Protocol">IP</abbr> del cliente con el que se está
comunicando. En el cliente ocurre otro tanto, aunque en este caso es menos
importante y, además, podemos usar <strong class="command">openssl</strong> que sí conecta
directamente con la máquina servidor. Para paliar esto, <strong class="command">stunnel</strong>
debería ejecutarse como un <a class="reference internal" href="../../../07.serre/05.proxies/03.reverse/02.transparencia.html#proxy-transparente"><span class="std std-ref">proxy transparente</span></a>.</p>
</div>
</div>
</div>
<div class="section" id="ssh">
<h2><span class="section-number">9.1.3.4.2. </span><abbr title="Security SHell">SSH</abbr><a class="headerlink" href="#ssh" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Surgió como reemplazo al protocolo <em>telnet</em> que se usaba para la administración
remota de servidores. Sin embargo, no se limita a esto y es capaz de ofrecer
otros servicios seguros como la <a class="reference internal" href="../../../07.serre/01.ftp/03.ssh.html#ssh-ftp"><span class="std std-ref">transferencia de ficheros</span></a> o la
<a class="reference internal" href="../../../04.servidor/10.ssh/03.tuneles.html#tunel-ssh"><span class="std std-ref">tunelización de otras comunicaciones</span></a> (funcionalidad esta
análoga a la que ofrece <a class="reference internal" href="#ssl"><span class="std std-ref">SSL</span></a>).</p>
<p>Utiliza certificados con formato propio para implementar el cifrado híbrido, no
los <a class="reference internal" href="01.certdig.html#cert-digital"><span class="std std-ref">certificados digitales X.509</span></a>.</p>
<div class="admonition seealso">
<p class="admonition-title">Ver también</p>
<p>Hay <a class="reference internal" href="../../../04.servidor/10.ssh/index.html#adm-rem"><span class="std std-ref">todo un epígrafe</span></a> dedicado a la configuración
de un servicio <abbr title="Security SHell">SSH</abbr>.</p>
</div>
<div class="admonition-todo admonition" id="id4">
<p class="admonition-title">Por hacer</p>
<p>En <a class="reference external" href="https://smallstep.com/blog/use-ssh-certificates/">esta página</a>
se explica cómo usar certificados <abbr title="Security SHell">SSH</abbr> en vez de simplemente claves
públicas y privadas. Debería desarrollarse la explicación en el epígrafe
dedicado a este servicio y aquí hacer una referencia explícita.</p>
</div>
</div>
<div class="section" id="vpn">
<h2><span class="section-number">9.1.3.4.3. </span><abbr title="Virtual Private Network">VPN</abbr><a class="headerlink" href="#vpn" title="Enlazar permanentemente con este título">¶</a></h2>
<p>No es propiamente un protocolo, sino una red privada virtual, esto es una
tecnología de comunicación entre redes de ordenadores que permite, a través de
una red pública (internet), la conexión segura punto a punto entre dos redes
locales de ordenadores. Esta conexión puede ser efectuada en capa 3, en cuyo
caso las dos redes extremas serán redes distintas; o en capa 2, en cuyo caso el
enlace conectará las dos redes extremas como dos segmentos de una misma red.</p>
<p>Para establecer una <abbr title="Virtual Private Network">VPN</abbr> no hay un único protocolo, sino toda pléyade de
protocolos que se pueden agrupar en cuatro familias: el obsoleto <abbr title="Point-tp-Point Tunneling Protocol">PPTP</abbr>, las que
usan <em>IPSec</em>, los que usan <abbr title="Secure Socket Layer">SSL</abbr> y otros que se basan en <a class="reference external" href="http://www.noiseprotocol.org">Noise</a>.</p>
<div class="admonition seealso">
<p class="admonition-title">Ver también</p>
<p>Hay <a class="reference internal" href="../../../07.serre/04.vpn/index.html#vpn"><span class="std std-ref">un extenso epígrafe</span></a> dedicado a este tipo de
protocolos.</p>
</div>
</div>
</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../../index.html">Tabla de contenido</a></h3>
  <ul>
<li><a class="reference internal" href="#">9.1.3.4. Protocolos seguros de red</a><ul>
<li><a class="reference internal" href="#ssl-tls">9.1.3.4.1. <abbr title="Secure Socket Layer">SSL</abbr>/<abbr title="Transport Layer Security">TLS</abbr></a><ul>
<li><a class="reference internal" href="#sni">9.1.3.4.1.1. <abbr title="Server Name Indication">SNI</abbr></a></li>
<li><a class="reference internal" href="#starttls">9.1.3.4.1.2. STARTTLS</a></li>
<li><a class="reference internal" href="#pruebas-practicas">9.1.3.4.1.3. Pruebas prácticas</a></li>
</ul>
</li>
<li><a class="reference internal" href="#ssh">9.1.3.4.2. <abbr title="Security SHell">SSH</abbr></a></li>
<li><a class="reference internal" href="#vpn">9.1.3.4.3. <abbr title="Virtual Private Network">VPN</abbr></a></li>
</ul>
</li>
</ul>

  <h4>Tema anterior</h4>
  <p class="topless"><a href="03.correo.html"
                        title="capítulo anterior"><span class="section-number">9.1.3.3. </span>Correo electrónico</a></p>
  <h4>Próximo tema</h4>
  <p class="topless"><a href="05.auth.html"
                        title="próximo capítulo"><span class="section-number">9.1.3.5. </span>Autenticación</a></p>
  <div role="note" aria-label="source link">
    <h3>Esta página</h3>
    <ul class="this-page-menu">
      <li><a href="../../../_sources/09.apendice/01.cryto/03.aplicaciones/04.ssl.rst.txt"
            rel="nofollow">Mostrar el código</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Búsqueda rápida</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Ir a" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navegación</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="Índice General"
             >índice</a></li>
        <li class="right" >
          <a href="05.auth.html" title="9.1.3.5. Autenticación"
             >siguiente</a> |</li>
        <li class="right" >
          <a href="03.correo.html" title="9.1.3.3. Correo electrónico"
             >anterior</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">documentación de Linuxnomicón - rolling</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" ><span class="section-number">9. </span>Apéndices</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../index.html" ><span class="section-number">9.1. </span>Criptografía</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../03.aplicaciones.html" ><span class="section-number">9.1.3. </span>Aplicaciones de la criptografía</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href=""><span class="section-number">9.1.3.4. </span>Protocolos seguros de red</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Derechos de autor CC BY 4.0, 2016-2021, José Miguel Sánchez Alés.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 3.4.3.
    </div>
  </body>
</html>