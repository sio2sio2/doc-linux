


<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="es">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>5.4.1.2.2. dar &#8212; documentación de Linuxnomicón - rolling</title>
    <link rel="stylesheet" href="../../../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/custom.css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../_static/language_data.js"></script>
    <script type="text/javascript" src="../../../_static/translations.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <link rel="index" title="Índice" href="../../../genindex.html" />
    <link rel="search" title="Búsqueda" href="../../../search.html" />
    <link rel="next" title="5.4.1.2.3. rsync" href="03.rsync.html" />
    <link rel="prev" title="5.4.1.2.1. tar" href="01.tar.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navegación</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="Índice General"
             accesskey="I">índice</a></li>
        <li class="right" >
          <a href="03.rsync.html" title="5.4.1.2.3. rsync"
             accesskey="N">siguiente</a> |</li>
        <li class="right" >
          <a href="01.tar.html" title="5.4.1.2.1. tar"
             accesskey="P">anterior</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">documentación de Linuxnomicón - rolling</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" >5. Dispositivos de almacenamiento</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../index.html" >5.4. Copias</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../01.backups.html" accesskey="U">5.4.1. Copias de seguridad</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="dar">
<span id="id1"></span><h1>5.4.1.2.2. dar<a class="headerlink" href="#dar" title="Enlazar permanentemente con este título">¶</a></h1>
<p>El <a class="reference external" href="http://dar.linux.free.fr/">programa dar</a>, acrónimo de <em>Disk ARchive</em> es un
comando equivalente a <a class="reference internal" href="../../../02.conbas/11.backup/02.empaquetado.html#tar"><span class="std std-ref">tar</span></a>, aunque con importantes ventajas respecto
a este:</p>
<ol class="arabic simple">
<li>El acceso al contenido no es secuencial.</li>
<li>La compresión está integrada dentro del propio formato, lo que permite
excluir tipos de ficheros de tal compresión (p.e. una imagen <abbr title="Joint Photographic Experts Group">JPEG</abbr> está ya
suficientemente comprimida).</li>
</ol>
<p>Con <strong class="command">dar</strong> podemos llevar a cabo cuatro acciones distintas:</p>
<ul class="simple">
<li>Crear la copia con <kbd class="kbd docutils literal notranslate">-c</kbd>.</li>
<li>Restaurar la copia con <kbd class="kbd docutils literal notranslate">-x</kbd>.</li>
<li>Consultar el contenido de la copia con <kbd class="kbd docutils literal notranslate">-l</kbd>.</li>
<li>Mezclar copias con <kbd class="kbd docutils literal notranslate">-+</kbd> (p.e. para obtener una copia completa a partir de
una copia completa y su copia diferencial)</li>
</ul>
<p><strong class="command">dar</strong> dispone de muchas opciones por lo que es más apropiado presentar
una tabla resumen de las más frecuentes y algunos ejemplos de uso. Es
importante tener presente que los nombres de las copias serán
<code class="file docutils literal notranslate"><span class="pre">nombre.N.dar</span></code>, donde «N» es el número de volumen, ya que podemos
indicarle al programa que a la vez que genera la copia la trocee en partes de
un peso determinado (p.e. 650 MiB). Cuando una opción requiera que indiquemos
el nombre de la copia, no debemos indicar ni el nímero de volumen ni la
extensión.</p>
<table border="1" class="dar docutils" id="id4">
<caption><span class="caption-text">Opciones comunes de dar</span><a class="headerlink" href="#id4" title="Enlace permanente a esta tabla">¶</a></caption>
<colgroup>
<col width="16%" />
<col width="27%" />
<col width="58%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Acción</th>
<th class="head">Opción</th>
<th class="head">Descripción</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td rowspan="2">-</td>
<td>-v</td>
<td>Muestra más información de la operación.</td>
</tr>
<tr class="row-odd"><td>-ar</td>
<td>En opciones que permiten patrones (como
<kbd class="kbd docutils literal notranslate">-X</kbd>), permite utilizar expresiones reg.
en vez de expansiones de la <em>shell</em>.</td>
</tr>
<tr class="row-even"><td colspan="2">-l &lt;fichero&gt;</td>
<td>Lista el contenido del directorio</td>
</tr>
<tr class="row-odd"><td rowspan="9">-c &lt;nombre&gt;</td>
<td>-z[&lt;algo&gt;][:&lt;nivel&gt;]</td>
<td>Comprime según el algoritmo (lzo, gzip, bzip2,
xz<a class="footnote-reference" href="#id3" id="id2">[1]</a>) y el nivel de compresión (1-9)
indicados. Si sólo se incluye <kbd class="kbd docutils literal notranslate">-z</kbd> se
sobrentiende <kbd class="kbd docutils literal notranslate">-zgzip:9</kbd>.</td>
</tr>
<tr class="row-even"><td>-s &lt;TAM&gt;</td>
<td>Trocea el backup de salida en archivos del
tamaño indicado. Se pueden añadir unidades (K,
M, G, T). Por ejemplo, <kbd class="kbd docutils literal notranslate">-s 650M</kbd> troceará
en ficheros de 650MiB: <code class="file docutils literal notranslate"><span class="pre">nombre.1.dar</span></code>,
<code class="file docutils literal notranslate"><span class="pre">nombre.2.dar</span></code>, etc.</td>
</tr>
<tr class="row-odd"><td>-R &lt;dir&gt;</td>
<td>Directorio del que se realiza el respaldo.</td>
</tr>
<tr class="row-even"><td>-Z &lt;patron&gt;</td>
<td>Excluye de la compresión los archivos que
cumplan cierto patrón (p.e. <kbd class="kbd docutils literal notranslate">-Z &quot;*.gz&quot;</kbd>).
Puede usarse varias veces.</td>
</tr>
<tr class="row-odd"><td>-X &lt;patron&gt;</td>
<td>Excluye del respaldo los archivos que cumplan
cierto patrón (p.e. <kbd class="kbd docutils literal notranslate">-X &quot;*.bak&quot;</kbd>). Puede
usarse varias veces.</td>
</tr>
<tr class="row-even"><td>-P &lt;patron&gt;</td>
<td>Excluye del respaldo los archivos que cumplan
cierto patrón (p.e. <kbd class="kbd docutils literal notranslate">-P proc</kbd>). La ruta
es relativa al directorio indicado con
<kbd class="kbd docutils literal notranslate">-R</kbd>. Puede incluirse varias veces</td>
</tr>
<tr class="row-odd"><td>-D</td>
<td>Los directorios excluidos se guardan en la
copia como directorios vacias.</td>
</tr>
<tr class="row-even"><td>-M</td>
<td>Se excluyen los directorios cuyo contenido no
forma parte del sistema de archivos del
directorio indicado con <kbd class="kbd docutils literal notranslate">-R</kbd>.</td>
</tr>
<tr class="row-odd"><td>-A &lt;archivo&gt;</td>
<td>Copia <strong>diferencial</strong>. Indica el fichero que
contiene la copia de referencia.</td>
</tr>
<tr class="row-even"><td rowspan="6">-x &lt;nombre&gt;</td>
<td>-R &lt;dir&gt;</td>
<td>Directorio de restauración del respaldo.</td>
</tr>
<tr class="row-odd"><td>-w</td>
<td>Sobrescribe archivos sin preguntar.</td>
</tr>
<tr class="row-even"><td>-r</td>
<td>Sobrescribe archivos sólo si son más recientes
que los del sistema.</td>
</tr>
<tr class="row-odd"><td>-g &lt;archivo&gt;</td>
<td>Restaura el archivo (o el directorio). Debe
expresarse como ruta relativa a <kbd class="kbd docutils literal notranslate">-R</kbd>.
Puede incluirse varias veces.</td>
</tr>
<tr class="row-even"><td>-I &lt;patron&gt;</td>
<td>Restaura sólo los ficheros cuyo nombre cumple
el patrón. Puede incluirse varias veces.</td>
</tr>
<tr class="row-odd"><td>-f</td>
<td>Restaura los ficheros sin reproducir la
estructura de directorios.</td>
</tr>
<tr class="row-even"><td rowspan="5">-+</td>
<td>-A &lt;archivo&gt;</td>
<td>Respaldo que se toma como referencia.</td>
</tr>
<tr class="row-odd"><td>-&#64; &lt;fichero&gt;</td>
<td>Respaldo cuyo contenido se añadirá a la
referencia.</td>
</tr>
<tr class="row-even"><td>-ak</td>
<td>Mantiene la compresión.</td>
</tr>
<tr class="row-odd"><td>-w</td>
<td>Sobrescribe sin preguntar.</td>
</tr>
<tr class="row-even"><td>-/ &lt;reglas&gt;</td>
<td>Establece cuál es la política que se usará
para mezclar los respaldos. Es compleja de
escribir. Dos posibles son «<kbd class="kbd docutils literal notranslate">{~S}[Oo]Pp</kbd>»
y <kbd class="kbd docutils literal notranslate">{!~I}[Rr]{~S}[Oo]Pp</kbd>. La primera
recuerda en el fichero resultante cuáles
fueron los ficheros borrados (aunque no se
restaurarán porque no se conserva su
contenido), mientras en la segunda, no.</td>
</tr>
</tbody>
</table>
<p>Por ejemplo, si quisiéramos hacer una <strong>copia completa</strong> del sistema raíz, excluyendo
sistemas de archivos externos y directorios sin interés:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">#</span> dar -c /media/HDexterno/cc0 -R / -D -M <span class="se">\</span>
      -P proc -P sys -P <span class="s1">&#39;var/log/*.gz&#39;</span> <span class="se">\</span>
      -X <span class="s2">&quot;*~&quot;</span> -X <span class="s2">&quot;.*~&quot;</span> -X <span class="s2">&quot;*.bak&quot;</span> <span class="se">\</span>
      -z -Z <span class="s2">&quot;*.gz&quot;</span> -Z <span class="s2">&quot;xz&quot;</span> -Z <span class="s2">&quot;*,bz2&quot;</span>
</pre></div>
</div>
<p>La <strong>copia incremental</strong> o <strong>diferencial</strong> se realiza exactamente igual, pero
añadiendo <kbd class="kbd docutils literal notranslate">-A</kbd> para indicar cuál es el respaldo de referencia. Dependiendo de si
tomamos siempre como referencia la copia completa o la última copia, planearemos una estrategia
<em>diferencial</em> o <em>incremental</em>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">#</span> dar -c /media/HDexterno/cd1 -R / -D -M <span class="se">\</span>
      -P proc -P sys -P <span class="s1">&#39;var/log/*.gz&#39;</span> <span class="se">\</span>
      -X <span class="s2">&quot;*~&quot;</span> -X <span class="s2">&quot;.*~&quot;</span> -X <span class="s2">&quot;*.bak&quot;</span> <span class="se">\</span>
      -z -Z <span class="s2">&quot;*.gz&quot;</span> -Z <span class="s2">&quot;xz&quot;</span> -Z <span class="s2">&quot;*,bz2&quot;</span>
<span class="go">      -A /media/HDexterno/cc0</span>
</pre></div>
</div>
<p>La restauración es sencilla: basta con llevar a cabo ordenadamente la
recuperación de los respaldos. Como cada respaldo almacena un catálogo en que
se expresa si algún archivo ha desaparecido, los archivos que existieron alguna
vez y desaparecieron en algún momento, se eliminarán al restaurar el respaldo
del que desaparecieron.</p>
<p>También es bastante sencillo fusionar ficheros de respaldo:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">#</span> <span class="nb">cd</span> /media/HDexterno <span class="p">;</span> dar -+ cc1 -A cc0 -@ cd1 -w -/<span class="s1">&#39;{~S}[Oo]Pp&#39;</span>
</pre></div>
</div>
<div class="admonition-todo admonition" id="index-0">
<p class="first admonition-title">Por hacer</p>
<p class="last"><a class="reference external" href="http://sarab.sourceforge.net/index.php">sarab</a> puede usarse
para automatizar la política de copias con <strong class="command">dar</strong>.</p>
</div>
<p class="rubric">Notas al pie</p>
<table class="docutils footnote" frame="void" id="id3" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[1]</a></td><td>El soporte para <a class="reference internal" href="../../../02.conbas/11.backup/01.compresion.html#xz"><span class="std std-ref">xz</span></a> sólo <cite>está disponible desde la versión 2.5
&lt;https://sourceforge.net/p/dar/feature-requests/146/#4455&gt;</cite>.</td></tr>
</tbody>
</table>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Tema anterior</h4>
  <p class="topless"><a href="01.tar.html"
                        title="capítulo anterior">5.4.1.2.1. tar</a></p>
  <h4>Próximo tema</h4>
  <p class="topless"><a href="03.rsync.html"
                        title="próximo capítulo">5.4.1.2.3. rsync</a></p>
  <div role="note" aria-label="source link">
    <h3>Esta página</h3>
    <ul class="this-page-menu">
      <li><a href="../../../_sources/05.discos/04.copias/01.backups/02.dar.rst.txt"
            rel="nofollow">Mostrar el código</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Búsqueda rápida</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Ir a" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navegación</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="Índice General"
             >índice</a></li>
        <li class="right" >
          <a href="03.rsync.html" title="5.4.1.2.3. rsync"
             >siguiente</a> |</li>
        <li class="right" >
          <a href="01.tar.html" title="5.4.1.2.1. tar"
             >anterior</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">documentación de Linuxnomicón - rolling</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" >5. Dispositivos de almacenamiento</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../index.html" >5.4. Copias</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../01.backups.html" >5.4.1. Copias de seguridad</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Derechos de autor CC BY 4.0, 2016-2020, José Miguel Sánchez Alés.
      Creado con <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.5.
    </div>
  </body>
</html>