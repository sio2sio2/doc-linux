


<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="es">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>5.4.1.2.3. rsync &#8212; documentación de ServidorLinux - 0.1.0</title>
    <link rel="stylesheet" href="../../../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/custom.css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../_static/language_data.js"></script>
    <script type="text/javascript" src="../../../_static/translations.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <link rel="index" title="Índice" href="../../../genindex.html" />
    <link rel="search" title="Búsqueda" href="../../../search.html" />
    <link rel="next" title="5.4.1.3.1. BackupPC" href="10.backuppc.html" />
    <link rel="prev" title="5.4.1.2.2. dar" href="02.dar.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navegación</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="Índice General"
             accesskey="I">índice</a></li>
        <li class="right" >
          <a href="10.backuppc.html" title="5.4.1.3.1. BackupPC"
             accesskey="N">siguiente</a> |</li>
        <li class="right" >
          <a href="02.dar.html" title="5.4.1.2.2. dar"
             accesskey="P">anterior</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">documentación de ServidorLinux - 0.1.0</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" >5. Dispositivos de almacenamiento</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../index.html" >5.4. Copias</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../01.backups.html" accesskey="U">5.4.1. Copias de seguridad</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <span class="target" id="rsync"></span><div class="section" id="index-0">
<span id="id1"></span><h1>5.4.1.2.3. rsync<a class="headerlink" href="#index-0" title="Enlazar permanentemente con este título">¶</a></h1>
<p><strong class="command">rsync</strong> es una orden que permite sincronizar los contenidos de dos
archivos o directorios, sean locales o remotos. La sincronización
entre origen y destino, sin embargo, no es constante, sino que se lleva a cabo
cada vez que se ejecuta la orden.</p>
<p>Tiene algunas ventajas respecto a herramientas similares:</p>
<ul class="simple">
<li>Es capaz de calcular diferencias entre archivos de origen y destino y sólo
copiar esas diferencias. Esta posibilidad es muy útil cuando los archivos que
se sincronizan son grandes.</li>
<li>Puede sincronizar tanto localmente (archivos en el mismo equipo) como
remotamente.</li>
</ul>
<div class="section" id="uso-basico">
<h2>5.4.1.2.3.1. Uso básico<a class="headerlink" href="#uso-basico" title="Enlazar permanentemente con este título">¶</a></h2>
<p>El modo más sencillo de utilizar la orden es:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">#</span> rsync -r ~/ /media/HDexterno/Personal/
</pre></div>
</div>
<p>que copiará recursivamente (<kbd class="kbd docutils literal notranslate">-r</kbd>) todos los contenidos del directorio
personal en un directorio diferente. Ahora bien, lo que no se copiará es la
metainformación de los ficheros (permisos, propietarios, etc.)</p>
<div class="admonition warning">
<p class="first admonition-title">Advertencia</p>
<p class="last"><strong class="command">rsync</strong> utiliza para el origen la misma notación que <abbr title="Berkeley Software Distribution">BSD</abbr>
para <a class="reference internal" href="../../../02.conbas/02.informacion/03.ficheros.html#mv"><span class="std std-ref">mv</span></a> y <a class="reference internal" href="../../../02.conbas/02.informacion/03.ficheros.html#cp"><span class="std std-ref">cp</span></a>. Por tanto, en el ejemplo, los cotenidos
del directorio personal se incluirán directamente dentro de <code class="file docutils literal notranslate"><span class="pre">Personal</span></code>.</p>
</div>
<p>Más habitual es hacer la sincronización de este modo:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">#</span> rsync -av ~/ /media/HDexterno/Personal/
</pre></div>
</div>
<p>que sí preservará la metainformación en la medida de los posible<a class="footnote-reference" href="#id5" id="id2">[1]</a> y, además,
mostrará (<kbd class="kbd docutils literal notranslate">-v</kbd>) cuáles son los ficheros que se van copiando. Si los
ficheros que se copian son muy grandes entonces interesará conocer cuál es el
progreso en la copia de cada fichero individual, lo cual puede lograrse
añadiendo <kbd class="kbd docutils literal notranslate">-P</kbd> o <kbd class="kbd docutils literal notranslate">--progress</kbd><a class="footnote-reference" href="#id6" id="id3">[2]</a>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">#</span> rsync -aP ~/ /media/HDexterno/Personal/
</pre></div>
</div>
<p>Pueden durante el proceso excluirse ficheros con <kbd class="kbd docutils literal notranslate">--exclude</kbd>, el cual
admite como argumento un expresión expansible de la <em>shell</em>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">#</span> rsync -av --exclude <span class="s2">&quot;*.swp&quot;</span> --exclude <span class="s2">&quot;*.bak&quot;</span> ~/ /media/HDexterno/Personal/
</pre></div>
</div>
<p>La sincronización, sin embargo, no es perfecta: si habiéndose hecho ya alguna
sincronización previa, un fichero deja de existir en el origen, al llevar se a
cabo una nueva sincronización, <strong class="command">rsync</strong> no lo eliminará. Para que lo
elimine es necesario incluir <kbd class="kbd docutils literal notranslate">--delete</kbd>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">#</span> rsync -av --delete ~/ /media/HDexterno/Personal/
</pre></div>
</div>
</div>
<div class="section" id="copias-remotas">
<h2>5.4.1.2.3.2. Copias remotas<a class="headerlink" href="#copias-remotas" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Las versiones modernas de <strong class="command">rsync</strong> usan por defecto para sus
comunicaciones remotas <abbr title="Security SHell">SSH</abbr>, de modo que para expresar el origen o destino
remotos se usa la misma sintaxis que en <a class="reference internal" href="../../../04.servidor/10.ssh/04.adicional.html#scp"><span class="std std-ref">scp</span></a>. En estas copias
remotas es útil la opción <kbd class="kbd docutils literal notranslate">-z</kbd> que comprime los datos. Para sincronizar un
directorio local con uno remoto en un servidor <abbr title="Security SHell">SSH</abbr><a class="footnote-reference" href="#id7" id="id4">[3]</a>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">#</span> rsync -aPz --delete ~/ usuario@servidor_remoto.com:Personal
</pre></div>
</div>
<p>o, si es al revés:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">#</span> rsync -aPz --delete usuario@servidor_remoto.com:Personal/ ~
</pre></div>
</div>
<p class="rubric">Notas al pie</p>
<table class="docutils footnote" frame="void" id="id5" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id2">[1]</a></td><td><kbd class="kbd docutils literal notranslate">-a</kbd> preserva permisos y propietarios siempre que sea posible, pero
no las <abbr title="Access Control List">ACL</abbr>s, que requiere <kbd class="kbd docutils literal notranslate">-A</kbd>, ni los <a class="reference internal" href="../../../02.conbas/05.seguridad/05b.permisos.html#user-xattr"><span class="std std-ref">atributos extendidos</span></a>, que requiere <kbd class="kbd docutils literal notranslate">-X</kbd>. Mantiene, además, enlaces simbólicos
como enlaces simbólicos, pero no enlaces duros para lo cual es necesario
<kbd class="kbd docutils literal notranslate">-H</kbd>.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id6" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id3">[2]</a></td><td>En realidad, <kbd class="kbd docutils literal notranslate">-P</kbd> equivale a <kbd class="kbd docutils literal notranslate">--progress --partial</kbd>, donde
<kbd class="kbd docutils literal notranslate">--partial</kbd> determina que no se borre el archivo en el destino en caso
de que se interrumpiera la copia y la copia del archivo quedra a medias.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id7" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id4">[3]</a></td><td>Usamos <kbd class="kbd docutils literal notranslate">-P</kbd> para aprovechar las posibilidades de <kbd class="kbd docutils literal notranslate">--partial</kbd>.</td></tr>
</tbody>
</table>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">5.4.1.2.3. rsync</a><ul>
<li><a class="reference internal" href="#uso-basico">5.4.1.2.3.1. Uso básico</a></li>
<li><a class="reference internal" href="#copias-remotas">5.4.1.2.3.2. Copias remotas</a></li>
</ul>
</li>
</ul>

  <h4>Tema anterior</h4>
  <p class="topless"><a href="02.dar.html"
                        title="capítulo anterior">5.4.1.2.2. dar</a></p>
  <h4>Próximo tema</h4>
  <p class="topless"><a href="10.backuppc.html"
                        title="próximo capítulo">5.4.1.3.1. BackupPC</a></p>
  <div role="note" aria-label="source link">
    <h3>Esta página</h3>
    <ul class="this-page-menu">
      <li><a href="../../../_sources/05.discos/04.copias/01.backups/03.rsync.rst.txt"
            rel="nofollow">Mostrar el código</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Búsqueda rápida</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Ir a" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navegación</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="Índice General"
             >índice</a></li>
        <li class="right" >
          <a href="10.backuppc.html" title="5.4.1.3.1. BackupPC"
             >siguiente</a> |</li>
        <li class="right" >
          <a href="02.dar.html" title="5.4.1.2.2. dar"
             >anterior</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">documentación de ServidorLinux - 0.1.0</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" >5. Dispositivos de almacenamiento</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../index.html" >5.4. Copias</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="../01.backups.html" >5.4.1. Copias de seguridad</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Derechos de autor 2016, José Miguel Sánchez Alés.
      Creado con <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.5.
    </div>
  </body>
</html>